/*! For license information please see main.92675246c7210ea03e6a.js.LICENSE.txt */
(()=>{var n={56:(n,e,t)=>{"use strict";n.exports=function(n){var e=t.nc;e&&n.setAttribute("nonce",e)}},72:n=>{"use strict";var e=[];function t(n){for(var t=-1,r=0;r<e.length;r++)if(e[r].identifier===n){t=r;break}return t}function r(n,r){for(var a={},i=[],c=0;c<n.length;c++){var s=n[c],u=r.base?s[0]+r.base:s[0],l=a[u]||0,d="".concat(u," ").concat(l);a[u]=l+1;var f=t(d),h={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==f)e[f].references++,e[f].updater(h);else{var p=o(h,r);r.byIndex=c,e.splice(c,0,{identifier:d,updater:p,references:1})}i.push(d)}return i}function o(n,e){var t=e.domAPI(e);return t.update(n),function(e){if(e){if(e.css===n.css&&e.media===n.media&&e.sourceMap===n.sourceMap&&e.supports===n.supports&&e.layer===n.layer)return;t.update(n=e)}else t.remove()}}n.exports=function(n,o){var a=r(n=n||[],o=o||{});return function(n){n=n||[];for(var i=0;i<a.length;i++){var c=t(a[i]);e[c].references--}for(var s=r(n,o),u=0;u<a.length;u++){var l=t(a[u]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}a=s}}},113:n=>{"use strict";n.exports=function(n,e){if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}},208:(n,e,t)=>{"use strict";t.d(e,{A:()=>c});var r=t(601),o=t.n(r),a=t(314),i=t.n(a)()(o());i.push([n.id,'/*\n * style.css - Таблица стилей для твоего личного ада.\n * Здесь мы делаем вид, что можем упорядочить хаос.\n */\n\n/* 1. Глобальные переменные и сброс говно-стилей браузера */\n:root {\n  --bg-color: #1a1a1a;\n  --primary-color: #2b2b2b;\n  --secondary-color: #404040;\n  --font-color: #cccccc;\n  --accent-color: #007bff; /* Единственное яркое пятно в этом царстве уныния */\n  --border-color: #555;\n  --danger-color: #dc3545;\n}\n\n* {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\nhtml,\nbody {\n  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,\n    Arial, sans-serif;\n  background-color: var(--bg-color);\n  color: var(--font-color);\n  line-height: 1.6;\n  height: 100%;\n}\n\nbody {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 1rem;\n}\n\n/* 2. Основные контейнеры и лэйаут */\n#app-container {\n  width: 100%;\n  max-width: 1200px; /* Чтобы на мониторе 4K не разъезжалось на всю степь */\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\nheader {\n  width: 100%;\n  border-bottom: 1px solid var(--border-color);\n  margin-bottom: 1.5rem;\n}\n\nmain {\n  flex-grow: 1; /* Занимает всё оставшееся место */\n  overflow-y: auto; /* Если контента будет дохуя, появится скролл */\n}\n\n/* Скрываем все "виды", кроме активного. JS будет рулить этим. */\n[data-view-content][hidden] {\n  display: none;\n}\n\n/* 3. Навигация. Flexbox, как ты и просил. */\n#main-nav {\n  display: flex;\n  flex-wrap: wrap; /* На телефонах кнопки перенесутся, а не вылезут за экран */\n  justify-content: center;\n  gap: 0.5rem;\n  padding: 1rem 0;\n}\n.nav-button {\n  background-color: var(--primary-color);\n  color: var(--font-color);\n  border: 1px solid var(--border-color);\n  padding: 0.5rem 1rem;\n  cursor: pointer;\n  border-radius: 5px;\n  transition: background-color 0.2s ease;\n}\n\n.nav-button:hover {\n  background-color: var(--secondary-color);\n}\n\n.nav-button.active {\n  background-color: var(--accent-color);\n  border-color: var(--accent-color);\n  color: #fff;\n  font-weight: bold;\n}\n\n/* 4. Вид "Сегодня". Вот тут Grid для десктопа и Flex для мобилки. */\n#today-view {\n  display: grid;\n  gap: 1.5rem;\n  /* По умолчанию одна колонка - для мобилок заебись */\n  grid-template-columns: 1fr;\n}\n\n/* А вот и магия адаптивности. Если экран шире 768px - делаем две колонки. */\n@media (min-width: 768px) {\n  #today-view {\n    grid-template-columns: 1fr 1fr; /* Две равные колонки */\n  }\n}\n\n.note-editor,\n.recent-notes,\n.view-header {\n  background-color: var(--primary-color);\n  padding: 1.5rem;\n  border-radius: 8px;\n  border: 1px solid var(--border-color);\n}\n\n/* 5. Форма для страданий (добавления записей) */\n#new-note-form {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n#new-note-form h3 {\n  text-align: center;\n  margin-bottom: 0.5rem;\n}\n\ntextarea,\ninput[type="text"],\ninput[type="search"] {\n  width: 100%;\n  padding: 0.75rem;\n  background-color: var(--secondary-color);\n  border: 1px solid var(--border-color);\n  color: var(--font-color);\n  border-radius: 5px;\n  resize: vertical; /* Разрешаем менять высоту только textarea */\n}\n\ntextarea:focus,\ninput:focus {\n  outline: none;\n  border-color: var(--accent-color);\n}\n\n#save-note-btn {\n  padding: 0.75rem;\n  background-color: var(--accent-color);\n  color: #fff;\n  border: none;\n  border-radius: 5px;\n  cursor: pointer;\n  font-weight: bold;\n}\n\n.download-button:hover,\n#save-note-btn:hover {\n  opacity: 0.9;\n}\n\n/* 6. Стили для остальных "видов" (неделя, месяц, год) */\n.view-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1.5rem;\n}\n\n.nav-arrow {\n  background: none;\n  border: none;\n  color: var(--font-color);\n  font-size: 2rem;\n  cursor: pointer;\n}\n.export-buttons-group {\n  display: flex;\n  gap: 0.5rem;\n  flex-wrap: wrap;\n}\n\n/* Календари. Тут Grid - сам бог велел. */\n#month-calendar-grid,\n#year-calendar-grid {\n  display: grid;\n  gap: 5px;\n}\n\n#month-calendar-grid {\n  /* 7 колонок для дней недели */\n  grid-template-columns: repeat(7, 1fr);\n}\n\n#year-calendar-grid {\n  /* 12 колонок для месяцев */\n  grid-template-columns: repeat(12, 1fr);\n}\n\n/* Сюда будешь добавлять стили для ячеек календаря, когда допишешь JS */\n#month-calendar-grid > div,\n#year-calendar-grid > div {\n  background-color: var(--secondary-color);\n  aspect-ratio: 1 / 1; /* Делаем ячейки квадратными */\n  border-radius: 3px;\n}\n\n/* === СТИЛИ ДЛЯ ВИДА "СЕГОДНЯ" === */\n\n.empty-state {\n  text-align: center;\n  padding: 3rem 1rem;\n  color: #888;\n}\n\n.empty-state p:first-child {\n  font-size: 2rem;\n  margin-bottom: 0.5rem;\n}\n\n.notes-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1rem;\n  padding-bottom: 0.5rem;\n  border-bottom: 1px solid var(--border-color);\n}\n\n.notes-header h4 {\n  color: var(--font-color);\n  margin: 0;\n}\n\n.notes-list {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n\n.note-item {\n  background-color: var(--secondary-color);\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  padding: 1rem;\n  transition: all 0.2s ease;\n  cursor: pointer;\n}\n\n.note-item:hover {\n  border-color: var(--accent-color);\n  background-color: var(--primary-color);\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(0, 123, 255, 0.1);\n}\n\n.note-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.75rem;\n  font-size: 0.85rem;\n  color: #888;\n}\n\n.note-time {\n  font-weight: bold;\n}\n\n.note-id {\n  color: var(--accent-color);\n  font-family: monospace;\n}\n\n.note-content {\n  line-height: 1.5;\n  margin-bottom: 0.5rem;\n  word-wrap: break-word;\n}\n\n.note-tags {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.25rem;\n  font-size: 0.8rem;\n  color: var(--accent-color);\n}\n\n.yesterday-notes {\n  margin-top: 2rem;\n  padding-top: 1.5rem;\n  border-top: 2px solid var(--border-color);\n}\n\n.yesterday-notes h4 {\n  color: #888;\n  margin-bottom: 1rem;\n}\n\n.yesterday-notes .note-item {\n  opacity: 0.7;\n}\n\n.error-message {\n  text-align: center;\n  padding: 2rem;\n  background-color: var(--danger-color);\n  border-radius: 8px;\n  color: #fff;\n}\n\n.error-message button {\n  margin-top: 1rem;\n  padding: 0.5rem 1rem;\n  background-color: #fff;\n  color: var(--danger-color);\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-weight: bold;\n}\n\n/* Анимация появления записей */\n.note-item {\n  animation: slideInUp 0.3s ease-out;\n}\n\n@keyframes slideInUp {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n/* Активные состояния навигации */\n.nav-button.active {\n  position: relative;\n}\n\n.nav-button.active::after {\n  content: "";\n  position: absolute;\n  bottom: -2px;\n  left: 0;\n  right: 0;\n  height: 2px;\n  background-color: var(--accent-color);\n}\n#save-note-btn:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.download-button:disabled,\n.export-button:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n/* === СТИЛИ ДЛЯ НЕДЕЛЬНОГО ВИДА === */\n\n.week-grid {\n  display: grid;\n  grid-template-columns: repeat(7, 1fr);\n  gap: 1rem;\n  margin-bottom: 2rem;\n}\n\n.week-day {\n  background-color: var(--primary-color);\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  padding: 1rem;\n  min-height: 200px;\n}\n\n.week-day.has-notes {\n  border-color: var(--accent-color);\n  background-color: rgba(0, 123, 255, 0.05);\n}\n\n.day-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1rem;\n  padding-bottom: 0.5rem;\n  border-bottom: 1px solid var(--border-color);\n}\n\n.day-header h4 {\n  font-size: 0.9rem;\n  margin: 0;\n  color: var(--font-color);\n}\n\n.day-date {\n  font-size: 0.8rem;\n  color: #888;\n}\n\n.notes-count {\n  background-color: var(--accent-color);\n  color: #fff;\n  padding: 0.2rem 0.5rem;\n  border-radius: 12px;\n  font-size: 0.7rem;\n  font-weight: bold;\n}\n\n.compact-note {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n  padding: 0.5rem;\n  background-color: var(--secondary-color);\n  border-radius: 4px;\n  margin-bottom: 0.5rem;\n  font-size: 0.8rem;\n}\n\n.compact-time {\n  font-weight: bold;\n  color: var(--accent-color);\n}\n\n.compact-content {\n  line-height: 1.3;\n}\n\n.compact-tags {\n  color: #888;\n  font-size: 0.7rem;\n}\n\n.no-notes {\n  color: #888;\n  font-style: italic;\n  text-align: center;\n}\n\n.week-summary {\n  text-align: center;\n  padding: 1rem;\n  background-color: var(--primary-color);\n  border-radius: 8px;\n}\n\n/* === СТИЛИ ДЛЯ МЕСЯЧНОГО КАЛЕНДАРЯ === */\n\n.month-calendar-grid {\n  display: grid;\n  grid-template-columns: repeat(7, 1fr);\n  gap: 2px;\n  margin-bottom: 2rem;\n  background-color: var(--border-color);\n  border-radius: 8px;\n  padding: 2px;\n}\n\n.calendar-day-header {\n  background-color: var(--primary-color);\n  padding: 0.75rem 0.5rem;\n  text-align: center;\n  font-weight: bold;\n  font-size: 0.8rem;\n  color: #888;\n}\n\n.calendar-day {\n  background-color: var(--secondary-color);\n  min-height: 80px;\n  padding: 0.5rem;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  transition: all 0.2s ease;\n  position: relative;\n}\n\n.calendar-day.empty {\n  background-color: var(--bg-color);\n}\n\n.calendar-day.today {\n  background-color: rgba(0, 123, 255, 0.2);\n  border: 2px solid var(--accent-color);\n}\n\n.calendar-day.has-notes:hover {\n  background-color: var(--accent-color);\n  color: #fff;\n  cursor: pointer;\n  transform: scale(1.05);\n}\n\n.calendar-day.low-activity {\n  background-color: rgba(0, 123, 255, 0.1);\n}\n\n.calendar-day.medium-activity {\n  background-color: rgba(0, 123, 255, 0.3);\n}\n\n.calendar-day.high-activity {\n  background-color: rgba(0, 123, 255, 0.5);\n  color: #fff;\n}\n\n.day-number {\n  font-weight: bold;\n  font-size: 1rem;\n}\n\n.notes-indicator {\n  background-color: var(--accent-color);\n  color: #fff;\n  border-radius: 50%;\n  width: 24px;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 0.7rem;\n  font-weight: bold;\n  align-self: flex-end;\n  margin-top: auto;\n}\n\n.month-stats {\n  background-color: var(--primary-color);\n  border-radius: 8px;\n  padding: 1.5rem;\n  margin-top: 1rem;\n}\n\n.month-stats h4 {\n  margin-bottom: 1rem;\n  text-align: center;\n}\n\n.stats-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));\n  gap: 1rem;\n}\n\n.stat-item {\n  text-align: center;\n  padding: 1rem;\n  background-color: var(--secondary-color);\n  border-radius: 6px;\n}\n\n.stat-number {\n  display: block;\n  font-size: 2rem;\n  font-weight: bold;\n  color: var(--accent-color);\n}\n\n.stat-label {\n  display: block;\n  font-size: 0.8rem;\n  color: #888;\n  margin-top: 0.25rem;\n}\n\n/* === СТИЛИ ДЛЯ ГОДОВОГО ВИДА === */\n\n.year-calendar-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 1.5rem;\n  margin-bottom: 2rem;\n}\n\n.year-month {\n  background-color: var(--primary-color);\n  border: 1px solid var(--border-color);\n  border-radius: 12px;\n  padding: 1.5rem;\n  text-align: center;\n  transition: all 0.3s ease;\n  cursor: pointer;\n}\n\n.year-month:hover {\n  transform: translateY(-4px);\n  box-shadow: 0 8px 25px rgba(0, 123, 255, 0.15);\n  border-color: var(--accent-color);\n}\n\n.month-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1rem;\n}\n\n.month-name {\n  font-weight: bold;\n  font-size: 1.1rem;\n}\n\n.month-number {\n  background-color: var(--accent-color);\n  color: #fff;\n  padding: 0.25rem 0.5rem;\n  border-radius: 12px;\n  font-size: 0.8rem;\n}\n\n.month-count {\n  font-size: 2.5rem;\n  font-weight: bold;\n  color: var(--accent-color);\n  margin-bottom: 1rem;\n}\n\n.month-bar {\n  background-color: var(--secondary-color);\n  height: 8px;\n  border-radius: 4px;\n  overflow: hidden;\n}\n\n.month-bar-fill {\n  background: linear-gradient(90deg, var(--accent-color), #00d4ff);\n  height: 100%;\n  transition: width 0.3s ease;\n}\n\n.year-month.low-activity .month-count {\n  color: #28a745;\n}\n\n.year-month.medium-activity .month-count {\n  color: #ffc107;\n}\n\n.year-month.high-activity .month-count {\n  color: #fd7e14;\n}\n\n.year-month.very-high-activity .month-count {\n  color: #dc3545;\n}\n\n.year-summary {\n  background-color: var(--primary-color);\n  border-radius: 12px;\n  padding: 2rem;\n  margin-top: 2rem;\n}\n\n.year-summary h3 {\n  text-align: center;\n  margin-bottom: 2rem;\n  color: var(--font-color);\n}\n\n.year-stats-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n  gap: 1.5rem;\n  margin-bottom: 2rem;\n}\n\n.year-stat {\n  text-align: center;\n  padding: 1.5rem;\n  background-color: var(--secondary-color);\n  border-radius: 8px;\n}\n\n.stat-value {\n  display: block;\n  font-size: 2.5rem;\n  font-weight: bold;\n  color: var(--accent-color);\n}\n\n.stat-label {\n  display: block;\n  font-size: 0.9rem;\n  color: #888;\n  margin-top: 0.5rem;\n}\n\n.activity-chart {\n  margin-top: 2rem;\n}\n\n.activity-chart h4 {\n  text-align: center;\n  margin-bottom: 1rem;\n}\n\n.chart-bars {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-end;\n  height: 150px;\n  padding: 1rem;\n  background-color: var(--secondary-color);\n  border-radius: 8px;\n  gap: 0.5rem;\n}\n\n.chart-bar {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  height: 100%;\n}\n\n.bar-fill {\n  background: linear-gradient(to top, var(--accent-color), #00d4ff);\n  width: 100%;\n  min-height: 2px;\n  border-radius: 2px 2px 0 0;\n  transition: height 0.3s ease;\n}\n\n.bar-label {\n  font-size: 0.7rem;\n  color: #888;\n  margin-top: 0.5rem;\n  writing-mode: vertical-lr;\n  text-orientation: mixed;\n}\n\n/* === МОДАЛЬНОЕ ОКНО === */\n\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.7);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background-color: var(--primary-color);\n  border-radius: 12px;\n  width: 90%;\n  max-width: 600px;\n  max-height: 80vh;\n  overflow-y: auto;\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1.5rem;\n  border-bottom: 1px solid var(--border-color);\n}\n\n.modal-header h3 {\n  margin: 0;\n  color: var(--font-color);\n}\n\n.modal-close {\n  background: none;\n  border: none;\n  font-size: 1.5rem;\n  color: #888;\n  cursor: pointer;\n  padding: 0;\n  width: 30px;\n  height: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.modal-close:hover {\n  color: var(--font-color);\n}\n\n.modal-body {\n  padding: 1.5rem;\n}\n\n.day-notes-list {\n  margin-top: 1rem;\n}\n\n/* === АДАПТИВНОСТЬ === */\n\n@media (max-width: 768px) {\n  .week-grid {\n    grid-template-columns: 1fr;\n  }\n\n  .month-calendar-grid {\n    gap: 1px;\n    padding: 1px;\n  }\n\n  .calendar-day {\n    min-height: 60px;\n    padding: 0.25rem;\n  }\n\n  .year-calendar-grid {\n    grid-template-columns: repeat(2, 1fr);\n  }\n\n  .year-stats-grid {\n    grid-template-columns: repeat(2, 1fr);\n  }\n\n  .chart-bars {\n    height: 100px;\n  }\n\n  .bar-label {\n    font-size: 0.6rem;\n  }\n}\n\n@media (max-width: 480px) {\n  .year-calendar-grid {\n    grid-template-columns: 1fr;\n  }\n\n  .year-stats-grid {\n    grid-template-columns: 1fr;\n  }\n}\n\n/* === СТИЛИ ДЛЯ ПОИСКА === */\n.search-container {\n  max-width: 800px;\n  margin: 0 auto;\n  padding: 1rem;\n}\n\n.search-header {\n  text-align: center;\n  margin-bottom: 2rem;\n}\n\n.search-header h3 {\n  color: var(--font-color);\n  margin-bottom: 0.5rem;\n}\n\n.search-header p {\n  color: #888;\n  font-size: 0.9rem;\n}\n\n.search-input-container {\n  margin-bottom: 2rem;\n}\n\n#search-input {\n  width: 100%;\n  font-size: 1.2rem;\n  padding: 1rem;\n  background-color: var(--secondary-color);\n  border: 2px solid var(--border-color);\n  color: var(--font-color);\n  border-radius: 12px;\n  transition: all 0.3s ease;\n}\n\n#search-input:focus {\n  outline: none;\n  border-color: var(--accent-color);\n  box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);\n  transform: translateY(-2px);\n}\n\n.search-hints {\n  margin-top: 0.5rem;\n  text-align: center;\n}\n\n.search-hints small {\n  color: #888;\n  font-size: 0.8rem;\n}\n\n/* Подсказки поиска */\n.search-suggestions {\n  background-color: var(--primary-color);\n  border-radius: 8px;\n  padding: 1.5rem;\n  margin-bottom: 2rem;\n  border: 1px solid var(--border-color);\n}\n\n.suggestions h5 {\n  color: var(--font-color);\n  margin-bottom: 1rem;\n  font-size: 0.9rem;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.tag-suggestions {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n  margin-bottom: 1.5rem;\n}\n\n.tag-suggestion {\n  background-color: var(--secondary-color);\n  color: var(--font-color);\n  border: 1px solid var(--border-color);\n  padding: 0.5rem 0.75rem;\n  border-radius: 20px;\n  cursor: pointer;\n  font-size: 0.85rem;\n  transition: background-color 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 0.25rem;\n}\n\n.tag-suggestion:hover {\n  background-color: var(--accent-color);\n  color: #fff;\n  border-color: var(--accent-color);\n  transform: translateY(-1px);\n}\n\n.tag-count {\n  font-size: 0.7rem;\n  opacity: 0.8;\n}\n\n.search-examples {\n  border-top: 1px solid var(--border-color);\n  padding-top: 1rem;\n}\n\n.example-queries {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n}\n\n.example-query {\n  background: linear-gradient(135deg, var(--accent-color), #0056b3);\n  color: #fff;\n  border: none;\n  padding: 0.4rem 0.8rem;\n  border-radius: 15px;\n  cursor: pointer;\n  font-size: 0.8rem;\n  font-weight: 500;\n  transition: all 0.2s ease;\n}\n\n.example-query:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);\n}\n\n/* Состояния поиска */\n.search-placeholder,\n.search-loading,\n.search-error {\n  text-align: center;\n  padding: 3rem 1rem;\n  color: #888;\n  background-color: var(--primary-color);\n  border-radius: 8px;\n  margin-bottom: 1rem;\n}\n\n.search-loading {\n  color: var(--accent-color);\n}\n\n.search-error {\n  color: var(--danger-color);\n  background-color: rgba(220, 53, 69, 0.1);\n}\n\n.retry-button {\n  background-color: var(--danger-color);\n  color: #fff;\n  border: none;\n  padding: 0.5rem 1rem;\n  border-radius: 4px;\n  cursor: pointer;\n  margin-top: 1rem;\n}\n\n/* Результаты поиска */\n.search-results-header {\n  background-color: var(--primary-color);\n  padding: 1.5rem;\n  border-radius: 8px;\n  margin-bottom: 1.5rem;\n  text-align: center;\n  border: 1px solid var(--border-color);\n}\n\n.search-results-header h4 {\n  color: var(--accent-color);\n  margin-bottom: 0.5rem;\n}\n\n.search-results-header p {\n  color: #888;\n  margin: 0;\n}\n\n.search-day-group {\n  margin-bottom: 2rem;\n}\n\n.search-day-header {\n  background-color: var(--secondary-color);\n  color: var(--font-color);\n  padding: 0.75rem 1rem;\n  border-radius: 6px;\n  margin-bottom: 1rem;\n  font-size: 0.9rem;\n  font-weight: 600;\n  border-left: 4px solid var(--accent-color);\n}\n\n.search-day-results {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n.search-result-item {\n  background-color: var(--primary-color);\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  padding: 1.25rem;\n  transition: all 0.2s ease;\n  cursor: pointer;\n}\n\n.search-result-item:hover {\n  border-color: var(--accent-color);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 15px rgba(0, 123, 255, 0.1);\n}\n\n.search-result-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.75rem;\n  font-size: 0.85rem;\n}\n\n.search-result-time {\n  color: var(--accent-color);\n  font-weight: 600;\n}\n\n.search-result-id {\n  color: #888;\n  font-family: monospace;\n  background-color: var(--secondary-color);\n  padding: 0.2rem 0.4rem;\n  border-radius: 4px;\n  font-size: 0.75rem;\n}\n\n.search-result-content {\n  line-height: 1.6;\n  margin-bottom: 0.75rem;\n  word-wrap: break-word;\n  color: var(--font-color);\n}\n\n.search-result-tags {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.25rem;\n}\n\n.search-result-tags span {\n  background-color: var(--secondary-color);\n  color: var(--accent-color);\n  padding: 0.2rem 0.5rem;\n  border-radius: 12px;\n  font-size: 0.75rem;\n  font-weight: 500;\n}\n\n/* Подсветка найденного текста */\nmark {\n  background: linear-gradient(120deg, #ffff00, #ffd700);\n  color: #000;\n  padding: 0.1rem 0.2rem;\n  border-radius: 3px;\n  font-weight: 600;\n}\n\n/* Отсутствие результатов */\n.no-results {\n  text-align: center;\n  padding: 3rem 1.5rem;\n  background-color: var(--primary-color);\n  border-radius: 12px;\n  border: 1px solid var(--border-color);\n}\n\n.no-results h4 {\n  color: var(--font-color);\n  margin-bottom: 1rem;\n  font-size: 1.2rem;\n}\n\n.search-tips {\n  background-color: var(--secondary-color);\n  padding: 1.5rem;\n  border-radius: 8px;\n  margin-top: 1.5rem;\n  text-align: left;\n  max-width: 500px;\n  margin-left: auto;\n  margin-right: auto;\n}\n\n.search-tips h5 {\n  color: var(--accent-color);\n  margin-bottom: 1rem;\n}\n\n.search-tips ul {\n  color: #888;\n  line-height: 1.6;\n}\n\n.search-tips li {\n  margin-bottom: 0.5rem;\n}\n\n.search-tips code {\n  background-color: var(--accent-color);\n  color: #fff;\n  padding: 0.2rem 0.4rem;\n  border-radius: 3px;\n  font-size: 0.8rem;\n}\n\n/* Анимации */\n.search-result-item {\n  animation: searchResultSlideIn 0.3s ease-out;\n}\n\n@keyframes searchResultSlideIn {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n/* ... в конец файла src/style.css ... */\n\n.button-group {\n  display: flex;\n  gap: 0.5rem;\n  flex-wrap: wrap;\n}\n\n.filename {\n  font-size: 0.8rem;\n  color: #888;\n  margin-top: 0.25rem;\n  word-break: break-all;\n}\n\n/* Адаптивность */\n@media (max-width: 768px) {\n  .search-container {\n    padding: 0.5rem;\n  }\n\n  #search-input {\n    font-size: 1rem;\n    padding: 0.75rem;\n  }\n\n  .tag-suggestions,\n  .example-queries {\n    justify-content: center;\n  }\n\n  .search-result-header {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 0.25rem;\n  }\n}\n\n@media (max-width: 480px) {\n  .search-day-results {\n    gap: 0.75rem;\n  }\n\n  .search-result-item {\n    padding: 1rem;\n  }\n}\n\n/* === СТИЛИ ДЛЯ КНОПОК СКАЧИВАНИЯ === */\n\n/* === СТИЛИ ДЛЯ ЭКСПОРТА === */\n\n.export-button {\n  background: linear-gradient(135deg, #28a745, #20c997);\n  color: #fff;\n  border: none;\n  padding: 0.75rem 1.25rem;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 0.9rem;\n  font-weight: 600;\n  transition: all 0.3s ease;\n  display: inline-flex;\n  align-items: center;\n  gap: 0.5rem;\n  box-shadow: 0 2px 8px rgba(40, 167, 69, 0.2);\n}\n\n.export-button:hover {\n  background: linear-gradient(135deg, #218838, #1ea085);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);\n}\n\n.export-button:disabled {\n  background: #6c757d;\n  cursor: not-allowed;\n  transform: none;\n  box-shadow: none;\n  animation: exportPulse 1.5s infinite;\n}\n\n.export-button.compact {\n  padding: 0.5rem 0.75rem;\n  font-size: 0.8rem;\n  border-radius: 6px;\n}\n\n@keyframes exportPulse {\n  0%,\n  100% {\n    opacity: 0.7;\n  }\n  50% {\n    opacity: 1;\n  }\n}\n.download-button {\n  background: linear-gradient(135deg, #007bff, #0056b3);\n  color: #fff;\n  border: none;\n  padding: 0.75rem 1.25rem;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 0.9rem;\n  font-weight: 600;\n  transition: all 0.3s ease;\n  display: inline-flex;\n  align-items: center;\n  gap: 0.5rem;\n  box-shadow: 0 2px 8px rgba(0, 123, 255, 0.2);\n}\n\n.download-button:hover {\n  background: linear-gradient(135deg, #0056b3, #004085);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);\n}\n\n.download-button:disabled {\n  background: #6c757d;\n  cursor: not-allowed;\n  transform: none;\n  box-shadow: none;\n  animation: downloadPulse 1.5s infinite;\n}\n\n.download-button.compact {\n  padding: 0.5rem 0.75rem;\n  font-size: 0.8rem;\n  border-radius: 6px;\n}\n\n/* Группы кнопок экспорта/скачивания */\n.export-buttons-group {\n  display: flex;\n  gap: 0.75rem;\n  align-items: center;\n  flex-wrap: wrap;\n}\n\n/* Обновляем контейнеры для групп кнопок */\n.week-controls,\n.month-controls,\n.year-controls {\n  background-color: var(--primary-color);\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  padding: 1rem;\n  margin-bottom: 1.5rem;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.notes-header {\n  gap: 1rem;\n}\n\n.notes-header h4 {\n  flex: 1;\n}\n\n/* Уведомления об экспорте */\n.export-notification {\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  background-color: var(--primary-color);\n  border: 2px solid var(--border-color);\n  border-radius: 12px;\n  padding: 1rem;\n  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);\n  z-index: 1000;\n  max-width: 350px;\n  transform: translateX(400px);\n  opacity: 0;\n  transition: all 0.3s ease;\n  cursor: pointer;\n}\n\n.export-notification.show {\n  transform: translateX(0);\n  opacity: 1;\n}\n\n.export-notification.success {\n  border-color: #28a745;\n  background: linear-gradient(135deg, #d4edda, #c3e6cb);\n  color: #155724;\n}\n\n.export-notification.error {\n  border-color: #dc3545;\n  background: linear-gradient(135deg, #f8d7da, #f5c6cb);\n  color: #721c24;\n}\n\n.notification-content {\n  display: flex;\n  align-items: flex-start;\n  gap: 0.75rem;\n}\n\n.notification-icon {\n  font-size: 1.5rem;\n  line-height: 1;\n  flex-shrink: 0;\n}\n\n.notification-text strong {\n  display: block;\n  margin-bottom: 0.25rem;\n  font-size: 0.95rem;\n}\n\n.notification-text p {\n  margin: 0;\n  font-size: 0.85rem;\n  line-height: 1.3;\n}\n/* Дополнительные стили для уведомлений */\n.notification-text .filename {\n  margin-top: 0.5rem;\n  font-size: 0.8rem;\n  color: #666;\n  font-family: monospace;\n  background-color: rgba(255, 255, 255, 0.1);\n  padding: 0.25rem 0.5rem;\n  border-radius: 4px;\n  word-break: break-all;\n}\n\n/* Адаптивность для уведомлений */\n@media (max-width: 768px) {\n  .export-notification {\n    top: 10px;\n    right: 10px;\n    left: 10px;\n    max-width: none;\n    transform: translateY(-100px);\n  }\n\n  .export-notification.show {\n    transform: translateY(0);\n  }\n}\n\n/* Анимация для кнопок скачивания во время процесса */\n@keyframes downloadPulse {\n  0%,\n  100% {\n    opacity: 0.7;\n  }\n  50% {\n    opacity: 1;\n  }\n}\n\n/* Адаптивность для мобильных устройств */\n@media (max-width: 768px) {\n  .export-buttons-group {\n    flex-direction: column;\n    gap: 0.5rem;\n    width: 100%;\n  }\n\n  .export-button,\n  .download-button {\n    width: 100%;\n    justify-content: center;\n    padding: 0.6rem 1rem;\n    font-size: 0.85rem;\n  }\n\n  .notes-header {\n    flex-direction: column;\n    gap: 0.75rem;\n    align-items: stretch;\n  }\n\n  .notes-header h4 {\n    text-align: center;\n  }\n\n  .notes-header .export-buttons-group {\n    justify-content: center;\n  }\n\n  .week-controls,\n  .month-controls,\n  .year-controls {\n    padding: 0.75rem;\n  }\n}\n\n@media (max-width: 480px) {\n  .export-button.compact,\n  .download-button.compact {\n    padding: 0.4rem 0.6rem;\n    font-size: 0.75rem;\n  }\n\n  .export-buttons-group {\n    gap: 0.4rem;\n  }\n}\n\n/* Улучшенная типографика для кнопок */\n.export-button,\n.download-button {\n  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,\n    Arial, sans-serif;\n  text-decoration: none;\n  white-space: nowrap;\n  user-select: none;\n}\n\n/* Фокус для accessibility */\n.export-button:focus,\n.download-button:focus {\n  outline: 2px solid rgba(0, 123, 255, 0.5);\n  outline-offset: 2px;\n}\n\n.download-button:focus {\n  outline-color: rgba(0, 123, 255, 0.6);\n}\n\n/* === PWA СТИЛИ === */\n\n.install-pwa-button {\n  background: linear-gradient(135deg, #ff6b35, #f7931e);\n  color: #fff;\n  border: none;\n  padding: 0.5rem 1rem;\n  border-radius: 5px;\n  cursor: pointer;\n  font-weight: bold;\n  font-size: 0.9rem;\n  display: inline-flex;\n  align-items: center;\n  gap: 0.5rem;\n  transition: all 0.3s ease;\n  box-shadow: 0 2px 8px rgba(255, 107, 53, 0.2);\n}\n\n.install-pwa-button:hover {\n  background: linear-gradient(135deg, #e55a2b, #e8831a);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);\n}\n\n.update-notification {\n  background: linear-gradient(135deg, #17a2b8, #138496);\n  border-color: #17a2b8;\n  color: #fff;\n}\n\n.update-button {\n  background-color: rgba(255, 255, 255, 0.2);\n  color: #fff;\n  border: 1px solid rgba(255, 255, 255, 0.3);\n  padding: 0.5rem 1rem;\n  border-radius: 4px;\n  cursor: pointer;\n  margin-top: 0.5rem;\n  transition: all 0.2s ease;\n}\n\n.update-button:hover {\n  background-color: rgba(255, 255, 255, 0.3);\n  border-color: rgba(255, 255, 255, 0.5);\n}\n\n/* Адаптация для установленного PWA */\n@media all and (display-mode: standalone) {\n  body {\n    /* Добавляем отступ сверху для статус-бара на iOS */\n    padding-top: env(safe-area-inset-top);\n    padding-bottom: env(safe-area-inset-bottom);\n  }\n\n  #main-nav {\n    /* Скрываем кнопку установки в standalone режиме */\n  }\n\n  .install-pwa-button {\n    display: none !important;\n  }\n}\n\n/* Стили для iPad */\n@media screen and (max-width: 1024px) and (orientation: landscape) {\n  .install-pwa-button {\n    font-size: 0.8rem;\n    padding: 0.4rem 0.8rem;\n  }\n}\n\n/* iOS Safari специфичные стили */\n@supports (-webkit-appearance: none) {\n  .install-pwa-button {\n    -webkit-appearance: none;\n    -webkit-tap-highlight-color: transparent;\n  }\n}\n',""]);const c=i},314:n=>{"use strict";n.exports=function(n){var e=[];return e.toString=function(){return this.map(function(e){var t="",r=void 0!==e[5];return e[4]&&(t+="@supports (".concat(e[4],") {")),e[2]&&(t+="@media ".concat(e[2]," {")),r&&(t+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),t+=n(e),r&&(t+="}"),e[2]&&(t+="}"),e[4]&&(t+="}"),t}).join("")},e.i=function(n,t,r,o,a){"string"==typeof n&&(n=[[null,n,void 0]]);var i={};if(r)for(var c=0;c<this.length;c++){var s=this[c][0];null!=s&&(i[s]=!0)}for(var u=0;u<n.length;u++){var l=[].concat(n[u]);r&&i[l[0]]||(void 0!==a&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=a),t&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=t):l[2]=t),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),e.push(l))}},e}},540:n=>{"use strict";n.exports=function(n){var e=document.createElement("style");return n.setAttributes(e,n.attributes),n.insert(e,n.options),e}},601:n=>{"use strict";n.exports=function(n){return n[1]}},659:n=>{"use strict";var e={};n.exports=function(n,t){var r=function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(n){t=null}e[n]=t}return e[n]}(n);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}},744:function(n,e,t){n.exports=function(){"use strict";var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])})(e,t)},e=function(){return(e=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};function r(n,e,t){if(t||2===arguments.length)for(var r,o=0,a=e.length;o<a;o++)!r&&o in e||((r=r||Array.prototype.slice.call(e,0,o))[o]=e[o]);return n.concat(r||Array.prototype.slice.call(e))}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:t.g,a=Object.keys,i=Array.isArray;function c(n,e){return"object"!=typeof e||a(e).forEach(function(t){n[t]=e[t]}),n}"undefined"==typeof Promise||o.Promise||(o.Promise=Promise);var s=Object.getPrototypeOf,u={}.hasOwnProperty;function l(n,e){return u.call(n,e)}function d(n,e){"function"==typeof e&&(e=e(s(n))),("undefined"==typeof Reflect?a:Reflect.ownKeys)(e).forEach(function(t){h(n,t,e[t])})}var f=Object.defineProperty;function h(n,e,t,r){f(n,e,c(t&&l(t,"get")&&"function"==typeof t.get?{get:t.get,set:t.set,configurable:!0}:{value:t,configurable:!0,writable:!0},r))}function p(n){return{from:function(e){return n.prototype=Object.create(e.prototype),h(n.prototype,"constructor",n),{extend:d.bind(null,n.prototype)}}}}var m=Object.getOwnPropertyDescriptor,v=[].slice;function y(n,e,t){return v.call(n,e,t)}function g(n,e){return e(n)}function b(n){if(!n)throw new Error("Assertion Failed")}function w(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function x(n,e){if("string"==typeof e&&l(n,e))return n[e];if(!e)return n;if("string"!=typeof e){for(var t=[],r=0,o=e.length;r<o;++r){var a=x(n,e[r]);t.push(a)}return t}var i=e.indexOf(".");if(-1!==i){var c=n[e.substr(0,i)];return null==c?void 0:x(c,e.substr(i+1))}}function k(n,e,t){if(n&&void 0!==e&&(!("isFrozen"in Object)||!Object.isFrozen(n)))if("string"!=typeof e&&"length"in e){b("string"!=typeof t&&"length"in t);for(var r=0,o=e.length;r<o;++r)k(n,e[r],t[r])}else{var a,c,s=e.indexOf(".");-1!==s?(a=e.substr(0,s),""===(c=e.substr(s+1))?void 0===t?i(n)&&!isNaN(parseInt(a))?n.splice(a,1):delete n[a]:n[a]=t:k(s=(s=n[a])&&l(n,a)?s:n[a]={},c,t)):void 0===t?i(n)&&!isNaN(parseInt(e))?n.splice(e,1):delete n[e]:n[e]=t}}function _(n){var e,t={};for(e in n)l(n,e)&&(t[e]=n[e]);return t}var E=[].concat;function S(n){return E.apply([],n)}var D="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(S([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(e){return e+n+"Array"})}))).filter(function(n){return o[n]}),O=new Set(D.map(function(n){return o[n]})),T=null;function P(n){return T=new WeakMap,n=function n(e){if(!e||"object"!=typeof e)return e;var t=T.get(e);if(t)return t;if(i(e)){t=[],T.set(e,t);for(var r=0,o=e.length;r<o;++r)t.push(n(e[r]))}else if(O.has(e.constructor))t=e;else{var a,c=s(e);for(a in t=c===Object.prototype?{}:Object.create(c),T.set(e,t),e)l(e,a)&&(t[a]=n(e[a]))}return t}(n),T=null,n}var j={}.toString;function C(n){return j.call(n).slice(8,-1)}var N="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",A="symbol"==typeof N?function(n){var e;return null!=n&&(e=n[N])&&e.apply(n)}:function(){return null};function M(n,e){return 0<=(e=n.indexOf(e))&&n.splice(e,1),0<=e}var L={};function I(n){var e,t,r,o;if(1===arguments.length){if(i(n))return n.slice();if(this===L&&"string"==typeof n)return[n];if(o=A(n)){for(t=[];!(r=o.next()).done;)t.push(r.value);return t}if(null==n)return[n];if("number"!=typeof(e=n.length))return[n];for(t=new Array(e);e--;)t[e]=n[e];return t}for(e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return t}var B="undefined"!=typeof Symbol?function(n){return"AsyncFunction"===n[Symbol.toStringTag]}:function(){return!1},R=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(sn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"]),K={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function q(n,e){this.name=n,this.message=e}function F(n,e){return n+". Errors: "+Object.keys(e).map(function(n){return e[n].toString()}).filter(function(n,e,t){return t.indexOf(n)===e}).join("\n")}function W(n,e,t,r){this.failures=e,this.failedKeys=r,this.successCount=t,this.message=F(n,e)}function Y(n,e){this.name="BulkError",this.failures=Object.keys(e).map(function(n){return e[n]}),this.failuresByPos=e,this.message=F(n,this.failures)}p(q).from(Error).extend({toString:function(){return this.name+": "+this.message}}),p(W).from(q),p(Y).from(q);var z=R.reduce(function(n,e){return n[e]=e+"Error",n},{}),V=q,U=R.reduce(function(n,e){var t=e+"Error";function r(n,r){this.name=t,n?"string"==typeof n?(this.message="".concat(n).concat(r?"\n "+r:""),this.inner=r||null):"object"==typeof n&&(this.message="".concat(n.name," ").concat(n.message),this.inner=n):(this.message=K[e]||t,this.inner=null)}return p(r).from(V),n[e]=r,n},{});U.Syntax=SyntaxError,U.Type=TypeError,U.Range=RangeError;var H=sn.reduce(function(n,e){return n[e+"Error"]=U[e],n},{}),G=R.reduce(function(n,e){return-1===["Syntax","Type","Range"].indexOf(e)&&(n[e+"Error"]=U[e]),n},{});function $(){}function Q(n){return n}function X(n,e){return null==n||n===Q?e:function(t){return e(n(t))}}function J(n,e){return function(){n.apply(this,arguments),e.apply(this,arguments)}}function Z(n,e){return n===$?e:function(){var t=n.apply(this,arguments);void 0!==t&&(arguments[0]=t);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?J(r,this.onsuccess):r),o&&(this.onerror=this.onerror?J(o,this.onerror):o),void 0!==a?a:t}}function nn(n,e){return n===$?e:function(){n.apply(this,arguments);var t=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),t&&(this.onsuccess=this.onsuccess?J(t,this.onsuccess):t),r&&(this.onerror=this.onerror?J(r,this.onerror):r)}}function en(n,e){return n===$?e:function(t){var r=n.apply(this,arguments);c(t,r);var o=this.onsuccess,a=this.onerror;return this.onsuccess=null,this.onerror=null,t=e.apply(this,arguments),o&&(this.onsuccess=this.onsuccess?J(o,this.onsuccess):o),a&&(this.onerror=this.onerror?J(a,this.onerror):a),void 0===r?void 0===t?void 0:t:c(r,t)}}function tn(n,e){return n===$?e:function(){return!1!==e.apply(this,arguments)&&n.apply(this,arguments)}}function rn(n,e){return n===$?e:function(){var t=n.apply(this,arguments);if(t&&"function"==typeof t.then){for(var r=this,o=arguments.length,a=new Array(o);o--;)a[o]=arguments[o];return t.then(function(){return e.apply(r,a)})}return e.apply(this,arguments)}}G.ModifyError=W,G.DexieError=q,G.BulkError=Y;var on="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function an(n){on=n}var cn={},sn=(D="undefined"==typeof Promise?[]:function(){var n=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[n,s(n),n];var e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,s(e),n]}(),D[0]),un=(R=D[1],D=D[2],R=R&&R.then,sn&&sn.constructor),ln=!!D,dn=function(n,e){bn.push([n,e]),hn&&(queueMicrotask(Pn),hn=!1)},fn=!0,hn=!0,pn=[],mn=[],vn=Q,yn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:$,pgp:!1,env:{},finalize:$},gn=yn,bn=[],wn=0,xn=[];function kn(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var e=this._PSD=gn;if("function"!=typeof n){if(n!==cn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Sn(this,this._value))}this._state=null,this._value=null,++e.ref,function n(e,t){try{t(function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&jn();t&&"function"==typeof t.then?n(e,function(n,e){t instanceof kn?t._then(n,e):t.then(n,e)}):(e._state=!0,e._value=t,Dn(e)),r&&Cn()}},Sn.bind(null,e))}catch(t){Sn(e,t)}}(this,n)}var _n={get:function(){var n=gn,e=Kn;function t(t,r){var o=this,a=!n.global&&(n!==gn||e!==Kn),i=a&&!Yn(),c=new kn(function(e,c){On(o,new En($n(t,n,a,i),$n(r,n,a,i),e,c,n))});return this._consoleTask&&(c._consoleTask=this._consoleTask),c}return t.prototype=cn,t},set:function(n){h(this,"then",n&&n.prototype===cn?_n:{get:function(){return n},set:_n.set})}};function En(n,e,t,r,o){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.resolve=t,this.reject=r,this.psd=o}function Sn(n,e){var t,r;mn.push(e),null===n._state&&(t=n._lib&&jn(),e=vn(e),n._state=!1,n._value=e,r=n,pn.some(function(n){return n._value===r._value})||pn.push(r),Dn(n),t&&Cn())}function Dn(n){var e=n._listeners;n._listeners=[];for(var t=0,r=e.length;t<r;++t)On(n,e[t]);var o=n._PSD;--o.ref||o.finalize(),0===wn&&(++wn,dn(function(){0==--wn&&Nn()},[]))}function On(n,e){if(null!==n._state){var t=n._state?e.onFulfilled:e.onRejected;if(null===t)return(n._state?e.resolve:e.reject)(n._value);++e.psd.ref,++wn,dn(Tn,[t,n,e])}else n._listeners.push(e)}function Tn(n,e,t){try{var r,o=e._value;!e._state&&mn.length&&(mn=[]),r=on&&e._consoleTask?e._consoleTask.run(function(){return n(o)}):n(o),e._state||-1!==mn.indexOf(o)||function(n){for(var e=pn.length;e;)if(pn[--e]._value===n._value)return pn.splice(e,1)}(e),t.resolve(r)}catch(n){t.reject(n)}finally{0==--wn&&Nn(),--t.psd.ref||t.psd.finalize()}}function Pn(){Gn(yn,function(){jn()&&Cn()})}function jn(){var n=fn;return hn=fn=!1,n}function Cn(){var n,e,t;do{for(;0<bn.length;)for(n=bn,bn=[],t=n.length,e=0;e<t;++e){var r=n[e];r[0].apply(null,r[1])}}while(0<bn.length);hn=fn=!0}function Nn(){var n=pn;pn=[],n.forEach(function(n){n._PSD.onunhandled.call(null,n._value,n)});for(var e=xn.slice(0),t=e.length;t;)e[--t]()}function An(n){return new kn(cn,!1,n)}function Mn(n,e){var t=gn;return function(){var r=jn(),o=gn;try{return Un(t,!0),n.apply(this,arguments)}catch(r){e&&e(r)}finally{Un(o,!1),r&&Cn()}}}d(kn.prototype,{then:_n,_then:function(n,e){On(this,new En(null,null,n,e,gn))},catch:function(n){if(1===arguments.length)return this.then(null,n);var e=n,t=arguments[1];return"function"==typeof e?this.then(null,function(n){return(n instanceof e?t:An)(n)}):this.then(null,function(n){return(n&&n.name===e?t:An)(n)})},finally:function(n){return this.then(function(e){return kn.resolve(n()).then(function(){return e})},function(e){return kn.resolve(n()).then(function(){return An(e)})})},timeout:function(n,e){var t=this;return n<1/0?new kn(function(r,o){var a=setTimeout(function(){return o(new U.Timeout(e))},n);t.then(r,o).finally(clearTimeout.bind(null,a))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&h(kn.prototype,Symbol.toStringTag,"Dexie.Promise"),yn.env=Hn(),d(kn,{all:function(){var n=I.apply(null,arguments).map(zn);return new kn(function(e,t){0===n.length&&e([]);var r=n.length;n.forEach(function(o,a){return kn.resolve(o).then(function(t){n[a]=t,--r||e(n)},t)})})},resolve:function(n){return n instanceof kn?n:n&&"function"==typeof n.then?new kn(function(e,t){n.then(e,t)}):new kn(cn,!0,n)},reject:An,race:function(){var n=I.apply(null,arguments).map(zn);return new kn(function(e,t){n.map(function(n){return kn.resolve(n).then(e,t)})})},PSD:{get:function(){return gn},set:function(n){return gn=n}},totalEchoes:{get:function(){return Kn}},newPSD:Fn,usePSD:Gn,scheduler:{get:function(){return dn},set:function(n){dn=n}},rejectionMapper:{get:function(){return vn},set:function(n){vn=n}},follow:function(n,e){return new kn(function(t,r){return Fn(function(e,t){var r=gn;r.unhandleds=[],r.onunhandled=t,r.finalize=J(function(){var n,r=this;n=function(){0===r.unhandleds.length?e():t(r.unhandleds[0])},xn.push(function e(){n(),xn.splice(xn.indexOf(e),1)}),++wn,dn(function(){0==--wn&&Nn()},[])},r.finalize),n()},e,t,r)})}}),un&&(un.allSettled&&h(kn,"allSettled",function(){var n=I.apply(null,arguments).map(zn);return new kn(function(e){0===n.length&&e([]);var t=n.length,r=new Array(t);n.forEach(function(n,o){return kn.resolve(n).then(function(n){return r[o]={status:"fulfilled",value:n}},function(n){return r[o]={status:"rejected",reason:n}}).then(function(){return--t||e(r)})})})}),un.any&&"undefined"!=typeof AggregateError&&h(kn,"any",function(){var n=I.apply(null,arguments).map(zn);return new kn(function(e,t){0===n.length&&t(new AggregateError([]));var r=n.length,o=new Array(r);n.forEach(function(n,a){return kn.resolve(n).then(function(n){return e(n)},function(n){o[a]=n,--r||t(new AggregateError(o))})})})}),un.withResolvers&&(kn.withResolvers=un.withResolvers));var Ln={awaits:0,echoes:0,id:0},In=0,Bn=[],Rn=0,Kn=0,qn=0;function Fn(n,e,t,r){var o=gn,a=Object.create(o);return a.parent=o,a.ref=0,a.global=!1,a.id=++qn,yn.env,a.env=ln?{Promise:kn,PromiseProp:{value:kn,configurable:!0,writable:!0},all:kn.all,race:kn.race,allSettled:kn.allSettled,any:kn.any,resolve:kn.resolve,reject:kn.reject}:{},e&&c(a,e),++o.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()},r=Gn(a,n,t,r),0===a.ref&&a.finalize(),r}function Wn(){return Ln.id||(Ln.id=++In),++Ln.awaits,Ln.echoes+=100,Ln.id}function Yn(){return!!Ln.awaits&&(0==--Ln.awaits&&(Ln.id=0),Ln.echoes=100*Ln.awaits,!0)}function zn(n){return Ln.echoes&&n&&n.constructor===un?(Wn(),n.then(function(n){return Yn(),n},function(n){return Yn(),Xn(n)})):n}function Vn(){var n=Bn[Bn.length-1];Bn.pop(),Un(n,!1)}function Un(n,e){var t,r=gn;(e?!Ln.echoes||Rn++&&n===gn:!Rn||--Rn&&n===gn)||queueMicrotask(e?function(n){++Kn,Ln.echoes&&0!=--Ln.echoes||(Ln.echoes=Ln.awaits=Ln.id=0),Bn.push(gn),Un(n,!0)}.bind(null,n):Vn),n!==gn&&(gn=n,r===yn&&(yn.env=Hn()),ln&&(t=yn.env.Promise,e=n.env,(r.global||n.global)&&(Object.defineProperty(o,"Promise",e.PromiseProp),t.all=e.all,t.race=e.race,t.resolve=e.resolve,t.reject=e.reject,e.allSettled&&(t.allSettled=e.allSettled),e.any&&(t.any=e.any))))}function Hn(){var n=o.Promise;return ln?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Gn(n,e,t,r,o){var a=gn;try{return Un(n,!0),e(t,r,o)}finally{Un(a,!1)}}function $n(n,e,t,r){return"function"!=typeof n?n:function(){var o=gn;t&&Wn(),Un(e,!0);try{return n.apply(this,arguments)}finally{Un(o,!1),r&&queueMicrotask(Yn)}}}function Qn(n){Promise===un&&0===Ln.echoes?0===Rn?n():enqueueNativeMicroTask(n):setTimeout(n,0)}-1===(""+R).indexOf("[native code]")&&(Wn=Yn=$);var Xn=kn.reject,Jn=String.fromCharCode(65535),Zn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ne="String expected.",ee=[],te="__dbnames",re="readonly",oe="readwrite";function ae(n,e){return n?e?function(){return n.apply(this,arguments)&&e.apply(this,arguments)}:n:e}var ie={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ce(n){return"string"!=typeof n||/\./.test(n)?function(n){return n}:function(e){return void 0===e[n]&&n in e&&delete(e=P(e))[n],e}}function se(){throw U.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function ue(n,e){try{var t=le(n),r=le(e);if(t!==r)return"Array"===t?1:"Array"===r?-1:"binary"===t?1:"binary"===r?-1:"string"===t?1:"string"===r?-1:"Date"===t?1:"Date"!==r?NaN:-1;switch(t){case"number":case"Date":case"string":return e<n?1:n<e?-1:0;case"binary":return function(n,e){for(var t=n.length,r=e.length,o=t<r?t:r,a=0;a<o;++a)if(n[a]!==e[a])return n[a]<e[a]?-1:1;return t===r?0:t<r?-1:1}(de(n),de(e));case"Array":return function(n,e){for(var t=n.length,r=e.length,o=t<r?t:r,a=0;a<o;++a){var i=ue(n[a],e[a]);if(0!==i)return i}return t===r?0:t<r?-1:1}(n,e)}}catch(n){}return NaN}function le(n){var e=typeof n;return"object"!=e?e:ArrayBuffer.isView(n)||"ArrayBuffer"===(n=C(n))?"binary":n}function de(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function fe(n,e,t){var r=n.schema.yProps;return r?(e&&0<t.numFailures&&(e=e.filter(function(n,e){return!t.failures[e]})),Promise.all(r.map(function(t){return t=t.updatesTable,e?n.db.table(t).where("k").anyOf(e).delete():n.db.table(t).clear()})).then(function(){return t})):t}var he=(pe.prototype._trans=function(n,e,t){var r=this._tx||gn.trans,o=this.name,a=on&&"undefined"!=typeof console&&console.createTask&&console.createTask("Dexie: ".concat("readonly"===n?"read":"write"," ").concat(this.name));function i(n,t,r){if(!r.schema[o])throw new U.NotFound("Table "+o+" not part of transaction");return e(r.idbtrans,r)}var c=jn();try{var s=r&&r.db._novip===this.db._novip?r===gn.trans?r._promise(n,i,t):Fn(function(){return r._promise(n,i,t)},{trans:r,transless:gn.transless||gn}):function n(e,t,r,o){if(e.idbdb&&(e._state.openComplete||gn.letThrough||e._vip)){var a=e._createTransaction(t,r,e._dbSchema);try{a.create(),e._state.PR1398_maxLoop=3}catch(a){return a.name===z.InvalidState&&e.isOpen()&&0<--e._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return n(e,t,r,o)})):Xn(a)}return a._promise(t,function(n,e){return Fn(function(){return gn.trans=a,o(n,e,a)})}).then(function(n){if("readwrite"===t)try{a.idbtrans.commit()}catch(n){}return"readonly"===t?n:a._completion.then(function(){return n})})}if(e._state.openComplete)return Xn(new U.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return Xn(new U.DatabaseClosed);e.open().catch($)}return e._state.dbReadyPromise.then(function(){return n(e,t,r,o)})}(this.db,n,[this.name],i);return a&&(s._consoleTask=a,s=s.catch(function(n){return console.trace(n),Xn(n)})),s}finally{c&&Cn()}},pe.prototype.get=function(n,e){var t=this;return n&&n.constructor===Object?this.where(n).first(e):null==n?Xn(new U.Type("Invalid argument to Table.get()")):this._trans("readonly",function(e){return t.core.get({trans:e,key:n}).then(function(n){return t.hook.reading.fire(n)})}).then(e)},pe.prototype.where=function(n){if("string"==typeof n)return new this.db.WhereClause(this,n);if(i(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var e=a(n);if(1===e.length)return this.where(e[0]).equals(n[e[0]]);var t=this.schema.indexes.concat(this.schema.primKey).filter(function(n){if(n.compound&&e.every(function(e){return 0<=n.keyPath.indexOf(e)})){for(var t=0;t<e.length;++t)if(-1===e.indexOf(n.keyPath[t]))return!1;return!0}return!1}).sort(function(n,e){return n.keyPath.length-e.keyPath.length})[0];if(t&&this.db._maxKey!==Jn){var r=t.keyPath.slice(0,e.length);return this.where(r).equals(r.map(function(e){return n[e]}))}!t&&on&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(e.join("+"),"]"));var o=this.schema.idxByName;function c(n,e){return 0===ue(n,e)}var s=e.reduce(function(e,t){var r=e[0],a=e[1],s=(e=o[t],n[t]);return[r||e,r||!e?ae(a,e&&e.multi?function(n){return n=x(n,t),i(n)&&n.some(function(n){return c(s,n)})}:function(n){return c(s,x(n,t))}):a]},[null,null]);return r=s[0],s=s[1],r?this.where(r.name).equals(n[r.keyPath]).filter(s):t?this.filter(s):this.where(e).equals("")},pe.prototype.filter=function(n){return this.toCollection().and(n)},pe.prototype.count=function(n){return this.toCollection().count(n)},pe.prototype.offset=function(n){return this.toCollection().offset(n)},pe.prototype.limit=function(n){return this.toCollection().limit(n)},pe.prototype.each=function(n){return this.toCollection().each(n)},pe.prototype.toArray=function(n){return this.toCollection().toArray(n)},pe.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},pe.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,i(n)?"[".concat(n.join("+"),"]"):n))},pe.prototype.reverse=function(){return this.toCollection().reverse()},pe.prototype.mapToClass=function(e){var t,r=this.db,o=this.name;function a(){return null!==t&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof se&&(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(a,t=e),Object.defineProperty(a.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),a.prototype.table=function(){return o},e=a);for(var i=new Set,c=e.prototype;c;c=s(c))Object.getOwnPropertyNames(c).forEach(function(n){return i.add(n)});function u(n){if(!n)return n;var t,r=Object.create(e.prototype);for(t in n)if(!i.has(t))try{r[t]=n[t]}catch(n){}return r}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=u,this.hook("reading",u),e},pe.prototype.defineClass=function(){return this.mapToClass(function(n){c(this,n)})},pe.prototype.add=function(n,e){var t=this,r=this.schema.primKey,o=r.auto,a=r.keyPath,i=n;return a&&o&&(i=ce(a)(n)),this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"add",keys:null!=e?[e]:null,values:[i]})}).then(function(n){return n.numFailures?kn.reject(n.failures[0]):n.lastResult}).then(function(e){if(a)try{k(n,a,e)}catch(e){}return e})},pe.prototype.update=function(n,e){return"object"!=typeof n||i(n)?this.where(":id").equals(n).modify(e):void 0===(n=x(n,this.schema.primKey.keyPath))?Xn(new U.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(e)},pe.prototype.put=function(n,e){var t=this,r=this.schema.primKey,o=r.auto,a=r.keyPath,i=n;return a&&o&&(i=ce(a)(n)),this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"put",values:[i],keys:null!=e?[e]:null})}).then(function(n){return n.numFailures?kn.reject(n.failures[0]):n.lastResult}).then(function(e){if(a)try{k(n,a,e)}catch(e){}return e})},pe.prototype.delete=function(n){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"delete",keys:[n]}).then(function(t){return fe(e,[n],t)}).then(function(n){return n.numFailures?kn.reject(n.failures[0]):void 0})})},pe.prototype.clear=function(){var n=this;return this._trans("readwrite",function(e){return n.core.mutate({trans:e,type:"deleteRange",range:ie}).then(function(e){return fe(n,null,e)})}).then(function(n){return n.numFailures?kn.reject(n.failures[0]):void 0})},pe.prototype.bulkGet=function(n){var e=this;return this._trans("readonly",function(t){return e.core.getMany({keys:n,trans:t}).then(function(n){return n.map(function(n){return e.hook.reading.fire(n)})})})},pe.prototype.bulkAdd=function(n,e,t){var r=this,o=Array.isArray(e)?e:void 0,a=(t=t||(o?void 0:e))?t.allKeys:void 0;return this._trans("readwrite",function(e){var t=(c=r.schema.primKey).auto;if((c=c.keyPath)&&o)throw new U.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==n.length)throw new U.InvalidArgument("Arguments objects and keys must have the same length");var i=n.length,c=c&&t?n.map(ce(c)):n;return r.core.mutate({trans:e,type:"add",keys:o,values:c,wantResults:a}).then(function(n){var e=n.numFailures,t=n.results,o=n.lastResult;if(n=n.failures,0===e)return a?t:o;throw new Y("".concat(r.name,".bulkAdd(): ").concat(e," of ").concat(i," operations failed"),n)})})},pe.prototype.bulkPut=function(n,e,t){var r=this,o=Array.isArray(e)?e:void 0,a=(t=t||(o?void 0:e))?t.allKeys:void 0;return this._trans("readwrite",function(e){var t=(c=r.schema.primKey).auto;if((c=c.keyPath)&&o)throw new U.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==n.length)throw new U.InvalidArgument("Arguments objects and keys must have the same length");var i=n.length,c=c&&t?n.map(ce(c)):n;return r.core.mutate({trans:e,type:"put",keys:o,values:c,wantResults:a}).then(function(n){var e=n.numFailures,t=n.results,o=n.lastResult;if(n=n.failures,0===e)return a?t:o;throw new Y("".concat(r.name,".bulkPut(): ").concat(e," of ").concat(i," operations failed"),n)})})},pe.prototype.bulkUpdate=function(n){var e=this,t=this.core,r=n.map(function(n){return n.key}),o=n.map(function(n){return n.changes}),a=[];return this._trans("readwrite",function(i){return t.getMany({trans:i,keys:r,cache:"clone"}).then(function(c){var s=[],u=[];n.forEach(function(n,t){var r=n.key,o=n.changes,i=c[t];if(i){for(var l=0,d=Object.keys(o);l<d.length;l++){var f=d[l],h=o[f];if(f===e.schema.primKey.keyPath){if(0!==ue(h,r))throw new U.Constraint("Cannot update primary key in bulkUpdate()")}else k(i,f,h)}a.push(t),s.push(r),u.push(i)}});var l=s.length;return t.mutate({trans:i,type:"put",keys:s,values:u,updates:{keys:r,changeSpecs:o}}).then(function(n){var t=n.numFailures,r=n.failures;if(0===t)return l;for(var o=0,i=Object.keys(r);o<i.length;o++){var c,s=i[o],u=a[Number(s)];null!=u&&(c=r[s],delete r[s],r[u]=c)}throw new Y("".concat(e.name,".bulkUpdate(): ").concat(t," of ").concat(l," operations failed"),r)})})})},pe.prototype.bulkDelete=function(n){var e=this,t=n.length;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"delete",keys:n}).then(function(t){return fe(e,n,t)})}).then(function(n){var r=n.numFailures,o=n.lastResult;if(n=n.failures,0===r)return o;throw new Y("".concat(e.name,".bulkDelete(): ").concat(r," of ").concat(t," operations failed"),n)})},pe);function pe(){}function me(n){function e(e,r){if(r){for(var o=arguments.length,a=new Array(o-1);--o;)a[o-1]=arguments[o];return t[e].subscribe.apply(null,a),n}if("string"==typeof e)return t[e]}var t={};e.addEventType=c;for(var r=1,o=arguments.length;r<o;++r)c(arguments[r]);return e;function c(n,r,o){if("object"!=typeof n){var s;r=r||tn;var u={subscribers:[],fire:o=o||$,subscribe:function(n){-1===u.subscribers.indexOf(n)&&(u.subscribers.push(n),u.fire=r(u.fire,n))},unsubscribe:function(n){u.subscribers=u.subscribers.filter(function(e){return e!==n}),u.fire=u.subscribers.reduce(r,o)}};return t[n]=e[n]=u}a(s=n).forEach(function(n){var e=s[n];if(i(e))c(n,s[n][0],s[n][1]);else{if("asap"!==e)throw new U.InvalidArgument("Invalid event config");var t=c(n,Q,function(){for(var n=arguments.length,e=new Array(n);n--;)e[n]=arguments[n];t.subscribers.forEach(function(n){w(function(){n.apply(null,e)})})})}})}}function ve(n,e){return p(e).from({prototype:n}),e}function ye(n,e){return!(n.filter||n.algorithm||n.or)&&(e?n.justLimit:!n.replayFilter)}function ge(n,e){n.filter=ae(n.filter,e)}function be(n,e,t){var r=n.replayFilter;n.replayFilter=r?function(){return ae(r(),e())}:e,n.justLimit=t&&!r}function we(n,e){if(n.isPrimKey)return e.primaryKey;var t=e.getIndexByKeyPath(n.index);if(!t)throw new U.Schema("KeyPath "+n.index+" on object store "+e.name+" is not indexed");return t}function xe(n,e,t){var r=we(n,e.schema);return e.openCursor({trans:t,values:!n.keysOnly,reverse:"prev"===n.dir,unique:!!n.unique,query:{index:r,range:n.range}})}function ke(n,e,t,r){var o=n.replayFilter?ae(n.filter,n.replayFilter()):n.filter;if(n.or){var a={},i=function(n,t,r){var i,c;o&&!o(t,r,function(n){return t.stop(n)},function(n){return t.fail(n)})||("[object ArrayBuffer]"==(c=""+(i=t.primaryKey))&&(c=""+new Uint8Array(i)),l(a,c)||(a[c]=!0,e(n,t,r)))};return Promise.all([n.or._iterate(i,t),_e(xe(n,r,t),n.algorithm,i,!n.keysOnly&&n.valueMapper)])}return _e(xe(n,r,t),ae(n.algorithm,o),e,!n.keysOnly&&n.valueMapper)}function _e(n,e,t,r){var o=Mn(r?function(n,e,o){return t(r(n),e,o)}:t);return n.then(function(n){if(n)return n.start(function(){var t=function(){return n.continue()};e&&!e(n,function(n){return t=n},function(e){n.stop(e),t=$},function(e){n.fail(e),t=$})||o(n.value,n,function(n){return t=n}),t()})})}var Ee=(Se.prototype.execute=function(n){var e=this["@@propmod"];if(void 0!==e.add){var t=e.add;if(i(t))return r(r([],i(n)?n:[],!0),t,!0).sort();if("number"==typeof t)return(Number(n)||0)+t;if("bigint"==typeof t)try{return BigInt(n)+t}catch(n){return BigInt(0)+t}throw new TypeError("Invalid term ".concat(t))}if(void 0!==e.remove){var o=e.remove;if(i(o))return i(n)?n.filter(function(n){return!o.includes(n)}).sort():[];if("number"==typeof o)return Number(n)-o;if("bigint"==typeof o)try{return BigInt(n)-o}catch(n){return BigInt(0)-o}throw new TypeError("Invalid subtrahend ".concat(o))}return(t=null===(t=e.replacePrefix)||void 0===t?void 0:t[0])&&"string"==typeof n&&n.startsWith(t)?e.replacePrefix[1]+n.substring(t.length):n},Se);function Se(n){this["@@propmod"]=n}var De=(Oe.prototype._read=function(n,e){var t=this._ctx;return t.error?t.table._trans(null,Xn.bind(null,t.error)):t.table._trans("readonly",n).then(e)},Oe.prototype._write=function(n){var e=this._ctx;return e.error?e.table._trans(null,Xn.bind(null,e.error)):e.table._trans("readwrite",n,"locked")},Oe.prototype._addAlgorithm=function(n){var e=this._ctx;e.algorithm=ae(e.algorithm,n)},Oe.prototype._iterate=function(n,e){return ke(this._ctx,n,e,this._ctx.table.core)},Oe.prototype.clone=function(n){var e=Object.create(this.constructor.prototype),t=Object.create(this._ctx);return n&&c(t,n),e._ctx=t,e},Oe.prototype.raw=function(){return this._ctx.valueMapper=null,this},Oe.prototype.each=function(n){var e=this._ctx;return this._read(function(t){return ke(e,n,t,e.table.core)})},Oe.prototype.count=function(n){var e=this;return this._read(function(n){var t=e._ctx,r=t.table.core;if(ye(t,!0))return r.count({trans:n,query:{index:we(t,r.schema),range:t.range}}).then(function(n){return Math.min(n,t.limit)});var o=0;return ke(t,function(){return++o,!1},n,r).then(function(){return o})}).then(n)},Oe.prototype.sortBy=function(n,e){var t=n.split(".").reverse(),r=t[0],o=t.length-1;function a(n,e){return e?a(n[t[e]],e-1):n[r]}var i="next"===this._ctx.dir?1:-1;function c(n,e){return ue(a(n,o),a(e,o))*i}return this.toArray(function(n){return n.sort(c)}).then(e)},Oe.prototype.toArray=function(n){var e=this;return this._read(function(n){var t=e._ctx;if("next"===t.dir&&ye(t,!0)&&0<t.limit){var r=t.valueMapper,o=we(t,t.table.core.schema);return t.table.core.query({trans:n,limit:t.limit,values:!0,query:{index:o,range:t.range}}).then(function(n){return n=n.result,r?n.map(r):n})}var a=[];return ke(t,function(n){return a.push(n)},n,t.table.core).then(function(){return a})},n)},Oe.prototype.offset=function(n){var e=this._ctx;return n<=0||(e.offset+=n,ye(e)?be(e,function(){var e=n;return function(n,t){return 0===e||(1===e?--e:t(function(){n.advance(e),e=0}),!1)}}):be(e,function(){var e=n;return function(){return--e<0}})),this},Oe.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),be(this._ctx,function(){var e=n;return function(n,t,r){return--e<=0&&t(r),0<=e}},!0),this},Oe.prototype.until=function(n,e){return ge(this._ctx,function(t,r,o){return!n(t.value)||(r(o),e)}),this},Oe.prototype.first=function(n){return this.limit(1).toArray(function(n){return n[0]}).then(n)},Oe.prototype.last=function(n){return this.reverse().first(n)},Oe.prototype.filter=function(n){var e;return ge(this._ctx,function(e){return n(e.value)}),(e=this._ctx).isMatch=ae(e.isMatch,n),this},Oe.prototype.and=function(n){return this.filter(n)},Oe.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},Oe.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Oe.prototype.desc=function(){return this.reverse()},Oe.prototype.eachKey=function(n){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(e,t){n(t.key,t)})},Oe.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},Oe.prototype.eachPrimaryKey=function(n){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(e,t){n(t.primaryKey,t)})},Oe.prototype.keys=function(n){var e=this._ctx;e.keysOnly=!e.isMatch;var t=[];return this.each(function(n,e){t.push(e.key)}).then(function(){return t}).then(n)},Oe.prototype.primaryKeys=function(n){var e=this._ctx;if("next"===e.dir&&ye(e,!0)&&0<e.limit)return this._read(function(n){var t=we(e,e.table.core.schema);return e.table.core.query({trans:n,values:!1,limit:e.limit,query:{index:t,range:e.range}})}).then(function(n){return n.result}).then(n);e.keysOnly=!e.isMatch;var t=[];return this.each(function(n,e){t.push(e.primaryKey)}).then(function(){return t}).then(n)},Oe.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},Oe.prototype.firstKey=function(n){return this.limit(1).keys(function(n){return n[0]}).then(n)},Oe.prototype.lastKey=function(n){return this.reverse().firstKey(n)},Oe.prototype.distinct=function(){var n;if(!(n=(n=this._ctx).index&&n.table.schema.idxByName[n.index])||!n.multi)return this;var e={};return ge(this._ctx,function(n){var t=n.primaryKey.toString();return n=l(e,t),e[t]=!0,!n}),this},Oe.prototype.modify=function(n){var e=this,t=this._ctx;return this._write(function(r){var o,i,c;c="function"==typeof n?n:(o=a(n),i=o.length,function(e){for(var t=!1,r=0;r<i;++r){var a=o[r],c=n[a],s=x(e,a);c instanceof Ee?(k(e,a,c.execute(s)),t=!0):s!==c&&(k(e,a,c),t=!0)}return t});var s,u=t.table.core,l=(s=u.schema.primaryKey).outbound,d=s.extractKey,f=200;function h(n,e){var t=e.failures;e=e.numFailures,m+=n-e;for(var r=0,o=a(t);r<o.length;r++){var i=o[r];p.push(t[i])}}(s=e.db._options.modifyChunkSize)&&(f="object"==typeof s?s[u.name]||s["*"]||200:s);var p=[],m=0,v=[],y=n===Te;return e.clone().primaryKeys().then(function(e){var o=ye(t)&&t.limit===1/0&&("function"!=typeof n||y)&&{index:t.index,range:t.range};return function a(i){var s=Math.min(f,e.length-i),p=e.slice(i,i+s);return(y?Promise.resolve([]):u.getMany({trans:r,keys:p,cache:"immutable"})).then(function(m){var v=[],g=[],b=l?[]:null,w=y?p:[];if(!y)for(var x=0;x<s;++x){var k=m[x],_={value:P(k),primKey:e[i+x]};!1!==c.call(_,_.value,_)&&(null==_.value?w.push(e[i+x]):l||0===ue(d(k),d(_.value))?(g.push(_.value),l&&b.push(e[i+x])):(w.push(e[i+x]),v.push(_.value)))}return Promise.resolve(0<v.length&&u.mutate({trans:r,type:"add",values:v}).then(function(n){for(var e in n.failures)w.splice(parseInt(e),1);h(v.length,n)})).then(function(){return(0<g.length||o&&"object"==typeof n)&&u.mutate({trans:r,type:"put",keys:b,values:g,criteria:o,changeSpec:"function"!=typeof n&&n,isAdditionalChunk:0<i}).then(function(n){return h(g.length,n)})}).then(function(){return(0<w.length||o&&y)&&u.mutate({trans:r,type:"delete",keys:w,criteria:o,isAdditionalChunk:0<i}).then(function(n){return fe(t.table,w,n)}).then(function(n){return h(w.length,n)})}).then(function(){return e.length>i+s&&a(i+f)})})}(0).then(function(){if(0<p.length)throw new W("Error modifying one or more objects",p,m,v);return e.length})})})},Oe.prototype.delete=function(){var n=this._ctx,e=n.range;return!ye(n)||n.table.schema.yProps||!n.isPrimKey&&3!==e.type?this.modify(Te):this._write(function(t){var r=n.table.core.schema.primaryKey,o=e;return n.table.core.count({trans:t,query:{index:r,range:o}}).then(function(e){return n.table.core.mutate({trans:t,type:"deleteRange",range:o}).then(function(n){var t=n.failures;if(n=n.numFailures)throw new W("Could not delete some values",Object.keys(t).map(function(n){return t[n]}),e-n);return e-n})})})},Oe);function Oe(){}var Te=function(n,e){return e.value=null};function Pe(n,e){return n<e?-1:n===e?0:1}function je(n,e){return e<n?-1:n===e?0:1}function Ce(n,e,t){return(n=n instanceof Ie?new n.Collection(n):n)._ctx.error=new(t||TypeError)(e),n}function Ne(n){return new n.Collection(n,function(){return Le("")}).limit(0)}function Ae(n,e,t,r){var o,a,i,c,s,u,l,d=t.length;if(!t.every(function(n){return"string"==typeof n}))return Ce(n,ne);function f(n){o="next"===n?function(n){return n.toUpperCase()}:function(n){return n.toLowerCase()},a="next"===n?function(n){return n.toLowerCase()}:function(n){return n.toUpperCase()},i="next"===n?Pe:je;var e=t.map(function(n){return{lower:a(n),upper:o(n)}}).sort(function(n,e){return i(n.lower,e.lower)});c=e.map(function(n){return n.upper}),s=e.map(function(n){return n.lower}),l="next"===(u=n)?"":r}f("next"),(n=new n.Collection(n,function(){return Me(c[0],s[d-1]+r)}))._ondirectionchange=function(n){f(n)};var h=0;return n._addAlgorithm(function(n,t,r){var o=n.key;if("string"!=typeof o)return!1;var f=a(o);if(e(f,s,h))return!0;for(var p=null,m=h;m<d;++m){var v=function(n,e,t,r,o,a){for(var i=Math.min(n.length,r.length),c=-1,s=0;s<i;++s){var u=e[s];if(u!==r[s])return o(n[s],t[s])<0?n.substr(0,s)+t[s]+t.substr(s+1):o(n[s],r[s])<0?n.substr(0,s)+r[s]+t.substr(s+1):0<=c?n.substr(0,c)+e[c]+t.substr(c+1):null;o(n[s],u)<0&&(c=s)}return i<r.length&&"next"===a?n+t.substr(n.length):i<n.length&&"prev"===a?n.substr(0,t.length):c<0?null:n.substr(0,c)+r[c]+t.substr(c+1)}(o,f,c[m],s[m],i,u);null===v&&null===p?h=m+1:(null===p||0<i(p,v))&&(p=v)}return t(null!==p?function(){n.continue(p+l)}:r),!1}),n}function Me(n,e,t,r){return{type:2,lower:n,upper:e,lowerOpen:t,upperOpen:r}}function Le(n){return{type:1,lower:n,upper:n}}var Ie=(Object.defineProperty(Be.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Be.prototype.between=function(n,e,t,r){t=!1!==t,r=!0===r;try{return 0<this._cmp(n,e)||0===this._cmp(n,e)&&(t||r)&&(!t||!r)?Ne(this):new this.Collection(this,function(){return Me(n,e,!t,!r)})}catch(n){return Ce(this,Zn)}},Be.prototype.equals=function(n){return null==n?Ce(this,Zn):new this.Collection(this,function(){return Le(n)})},Be.prototype.above=function(n){return null==n?Ce(this,Zn):new this.Collection(this,function(){return Me(n,void 0,!0)})},Be.prototype.aboveOrEqual=function(n){return null==n?Ce(this,Zn):new this.Collection(this,function(){return Me(n,void 0,!1)})},Be.prototype.below=function(n){return null==n?Ce(this,Zn):new this.Collection(this,function(){return Me(void 0,n,!1,!0)})},Be.prototype.belowOrEqual=function(n){return null==n?Ce(this,Zn):new this.Collection(this,function(){return Me(void 0,n)})},Be.prototype.startsWith=function(n){return"string"!=typeof n?Ce(this,ne):this.between(n,n+Jn,!0,!0)},Be.prototype.startsWithIgnoreCase=function(n){return""===n?this.startsWith(n):Ae(this,function(n,e){return 0===n.indexOf(e[0])},[n],Jn)},Be.prototype.equalsIgnoreCase=function(n){return Ae(this,function(n,e){return n===e[0]},[n],"")},Be.prototype.anyOfIgnoreCase=function(){var n=I.apply(L,arguments);return 0===n.length?Ne(this):Ae(this,function(n,e){return-1!==e.indexOf(n)},n,"")},Be.prototype.startsWithAnyOfIgnoreCase=function(){var n=I.apply(L,arguments);return 0===n.length?Ne(this):Ae(this,function(n,e){return e.some(function(e){return 0===n.indexOf(e)})},n,Jn)},Be.prototype.anyOf=function(){var n=this,e=I.apply(L,arguments),t=this._cmp;try{e.sort(t)}catch(r){return Ce(this,Zn)}if(0===e.length)return Ne(this);var r=new this.Collection(this,function(){return Me(e[0],e[e.length-1])});r._ondirectionchange=function(r){t="next"===r?n._ascending:n._descending,e.sort(t)};var o=0;return r._addAlgorithm(function(n,r,a){for(var i=n.key;0<t(i,e[o]);)if(++o===e.length)return r(a),!1;return 0===t(i,e[o])||(r(function(){n.continue(e[o])}),!1)}),r},Be.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Be.prototype.noneOf=function(){var n=I.apply(L,arguments);if(0===n.length)return new this.Collection(this);try{n.sort(this._ascending)}catch(n){return Ce(this,Zn)}var e=n.reduce(function(n,e){return n?n.concat([[n[n.length-1][1],e]]):[[-1/0,e]]},null);return e.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(e,{includeLowers:!1,includeUppers:!1})},Be.prototype.inAnyRange=function(n,e){var t=this,r=this._cmp,o=this._ascending,a=this._descending,i=this._min,c=this._max;if(0===n.length)return Ne(this);if(!n.every(function(n){return void 0!==n[0]&&void 0!==n[1]&&o(n[0],n[1])<=0}))return Ce(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",U.InvalidArgument);var s,u=!e||!1!==e.includeLowers,l=e&&!0===e.includeUppers,d=o;function f(n,e){return d(n[0],e[0])}try{(s=n.reduce(function(n,e){for(var t=0,o=n.length;t<o;++t){var a=n[t];if(r(e[0],a[1])<0&&0<r(e[1],a[0])){a[0]=i(a[0],e[0]),a[1]=c(a[1],e[1]);break}}return t===o&&n.push(e),n},[])).sort(f)}catch(n){return Ce(this,Zn)}var h=0,p=l?function(n){return 0<o(n,s[h][1])}:function(n){return 0<=o(n,s[h][1])},m=u?function(n){return 0<a(n,s[h][0])}:function(n){return 0<=a(n,s[h][0])},v=p;return(n=new this.Collection(this,function(){return Me(s[0][0],s[s.length-1][1],!u,!l)}))._ondirectionchange=function(n){d="next"===n?(v=p,o):(v=m,a),s.sort(f)},n._addAlgorithm(function(n,e,r){for(var a,i=n.key;v(i);)if(++h===s.length)return e(r),!1;return!p(a=i)&&!m(a)||(0===t._cmp(i,s[h][1])||0===t._cmp(i,s[h][0])||e(function(){d===o?n.continue(s[h][0]):n.continue(s[h][1])}),!1)}),n},Be.prototype.startsWithAnyOf=function(){var n=I.apply(L,arguments);return n.every(function(n){return"string"==typeof n})?0===n.length?Ne(this):this.inAnyRange(n.map(function(n){return[n,n+Jn]})):Ce(this,"startsWithAnyOf() only works with strings")},Be);function Be(){}function Re(n){return Mn(function(e){return Ke(e),n(e.target.error),!1})}function Ke(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var qe="storagemutated",Fe="x-storagemutated-1",We=me(null,qe),Ye=(ze.prototype._lock=function(){return b(!gn.global),++this._reculock,1!==this._reculock||gn.global||(gn.lockOwnerFor=this),this},ze.prototype._unlock=function(){if(b(!gn.global),0==--this._reculock)for(gn.global||(gn.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Gn(n[1],n[0])}catch(n){}}return this},ze.prototype._locked=function(){return this._reculock&&gn.lockOwnerFor!==this},ze.prototype.create=function(n){var e=this;if(!this.mode)return this;var t=this.db.idbdb,r=this.db._state.dbOpenError;if(b(!this.idbtrans),!n&&!t)switch(r&&r.name){case"DatabaseClosedError":throw new U.DatabaseClosed(r);case"MissingAPIError":throw new U.MissingAPI(r.message,r);default:throw new U.OpenFailed(r)}if(!this.active)throw new U.TransactionInactive;return b(null===this._completion._state),(n=this.idbtrans=n||(this.db.core||t).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Mn(function(t){Ke(t),e._reject(n.error)}),n.onabort=Mn(function(t){Ke(t),e.active&&e._reject(new U.Abort(n.error)),e.active=!1,e.on("abort").fire(t)}),n.oncomplete=Mn(function(){e.active=!1,e._resolve(),"mutatedParts"in n&&We.storagemutated.fire(n.mutatedParts)}),this},ze.prototype._promise=function(n,e,t){var r=this;if("readwrite"===n&&"readwrite"!==this.mode)return Xn(new U.ReadOnly("Transaction is readonly"));if(!this.active)return Xn(new U.TransactionInactive);if(this._locked())return new kn(function(o,a){r._blockedFuncs.push([function(){r._promise(n,e,t).then(o,a)},gn])});if(t)return Fn(function(){var n=new kn(function(n,t){r._lock();var o=e(n,t,r);o&&o.then&&o.then(n,t)});return n.finally(function(){return r._unlock()}),n._lib=!0,n});var o=new kn(function(n,t){var o=e(n,t,r);o&&o.then&&o.then(n,t)});return o._lib=!0,o},ze.prototype._root=function(){return this.parent?this.parent._root():this},ze.prototype.waitFor=function(n){var e,t=this._root(),r=kn.resolve(n);t._waitingFor?t._waitingFor=t._waitingFor.then(function(){return r}):(t._waitingFor=r,t._waitingQueue=[],e=t.idbtrans.objectStore(t.storeNames[0]),function n(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(e.get(-1/0).onsuccess=n)}());var o=t._waitingFor;return new kn(function(n,e){r.then(function(e){return t._waitingQueue.push(Mn(n.bind(null,e)))},function(n){return t._waitingQueue.push(Mn(e.bind(null,n)))}).finally(function(){t._waitingFor===o&&(t._waitingFor=null)})})},ze.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new U.Abort))},ze.prototype.table=function(n){var e=this._memoizedTables||(this._memoizedTables={});if(l(e,n))return e[n];var t=this.schema[n];if(!t)throw new U.NotFound("Table "+n+" not part of transaction");return(t=new this.db.Table(n,t,this)).core=this.db.core.table(n),e[n]=t},ze);function ze(){}function Ve(n,e,t,r,o,a,i,c){return{name:n,keyPath:e,unique:t,multi:r,auto:o,compound:a,src:(t&&!i?"&":"")+(r?"*":"")+(o?"++":"")+Ue(e),type:c}}function Ue(n){return"string"==typeof n?n:n?"["+[].join.call(n,"+")+"]":""}function He(n,e,t){return{name:n,primKey:e,indexes:t,mappedClass:null,idxByName:(r=function(n){return[n.name,n]},t.reduce(function(n,e,t){return(t=r(e))&&(n[t[0]]=t[1]),n},{}))};var r}var Ge=function(n){try{return n.only([[]]),Ge=function(){return[[]]},[[]]}catch(n){return Ge=function(){return Jn},Jn}};function $e(n){return null==n?function(){}:"string"==typeof n?1===(e=n).split(".").length?function(n){return n[e]}:function(n){return x(n,e)}:function(e){return x(e,n)};var e}function Qe(n){return[].slice.call(n)}var Xe=0;function Je(n){return null==n?":id":"string"==typeof n?n:"[".concat(n.join("+"),"]")}function Ze(n,e,t){function r(n){if(3===n.type)return null;if(4===n.type)throw new Error("Cannot convert never type to IDBKeyRange");var t=n.lower,r=n.upper,o=n.lowerOpen;return n=n.upperOpen,void 0===t?void 0===r?null:e.upperBound(r,!!n):void 0===r?e.lowerBound(t,!!o):e.bound(t,r,!!o,!!n)}var o,a,c,s=(a=t,c=Qe((o=n).objectStoreNames),{schema:{name:o.name,tables:c.map(function(n){return a.objectStore(n)}).map(function(n){var e=n.keyPath,t=n.autoIncrement,r=i(e),o={};return t={name:n.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:null==e,compound:r,keyPath:e,autoIncrement:t,unique:!0,extractKey:$e(e)},indexes:Qe(n.indexNames).map(function(e){return n.index(e)}).map(function(n){var e=n.name,t=n.unique,r=n.multiEntry;return n=n.keyPath,r={name:e,compound:i(n),keyPath:n,unique:t,multiEntry:r,extractKey:$e(n)},o[Je(n)]=r}),getIndexByKeyPath:function(n){return o[Je(n)]}},o[":id"]=t.primaryKey,null!=e&&(o[Je(e)]=t.primaryKey),t})},hasGetAll:0<c.length&&"getAll"in a.objectStore(c[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),u=(t=s.schema,s.hasGetAll),l=(s=t.tables.map(function(n){var e,t=n.name;return{name:t,schema:n,mutate:function(n){var e=n.trans,o=n.type,a=n.keys,i=n.values,c=n.range;return new Promise(function(n,s){n=Mn(n);var u=e.objectStore(t),l=null==u.keyPath,d="put"===o||"add"===o;if(!d&&"delete"!==o&&"deleteRange"!==o)throw new Error("Invalid operation type: "+o);var f,h=(a||i||{length:1}).length;if(a&&i&&a.length!==i.length)throw new Error("Given keys array must have same length as given values array.");if(0===h)return n({numFailures:0,failures:{},results:[],lastResult:void 0});function p(n){++y,Ke(n)}var m=[],v=[],y=0;if("deleteRange"===o){if(4===c.type)return n({numFailures:y,failures:v,results:[],lastResult:void 0});3===c.type?m.push(f=u.clear()):m.push(f=u.delete(r(c)))}else{var g=(l=d?l?[i,a]:[i,null]:[a,null])[0],b=l[1];if(d)for(var w=0;w<h;++w)m.push(f=b&&void 0!==b[w]?u[o](g[w],b[w]):u[o](g[w])),f.onerror=p;else for(w=0;w<h;++w)m.push(f=u[o](g[w])),f.onerror=p}function x(e){e=e.target.result,m.forEach(function(n,e){return null!=n.error&&(v[e]=n.error)}),n({numFailures:y,failures:v,results:"delete"===o?a:m.map(function(n){return n.result}),lastResult:e})}f.onerror=function(n){p(n),x(n)},f.onsuccess=x})},getMany:function(n){var e=n.trans,r=n.keys;return new Promise(function(n,o){n=Mn(n);for(var a,i=e.objectStore(t),c=r.length,s=new Array(c),u=0,l=0,d=function(e){e=e.target,s[e._pos]=e.result,++l===u&&n(s)},f=Re(o),h=0;h<c;++h)null!=r[h]&&((a=i.get(r[h]))._pos=h,a.onsuccess=d,a.onerror=f,++u);0===u&&n(s)})},get:function(n){var e=n.trans,r=n.key;return new Promise(function(n,o){n=Mn(n);var a=e.objectStore(t).get(r);a.onsuccess=function(e){return n(e.target.result)},a.onerror=Re(o)})},query:(e=u,function(n){return new Promise(function(o,a){o=Mn(o);var i,c,s,u=n.trans,l=n.values,d=n.limit,f=n.query,h=d===1/0?void 0:d,p=f.index;if(f=f.range,u=u.objectStore(t),p=p.isPrimaryKey?u:u.index(p.name),f=r(f),0===d)return o({result:[]});e?((h=l?p.getAll(f,h):p.getAllKeys(f,h)).onsuccess=function(n){return o({result:n.target.result})},h.onerror=Re(a)):(i=0,c=!l&&"openKeyCursor"in p?p.openKeyCursor(f):p.openCursor(f),s=[],c.onsuccess=function(n){var e=c.result;return e?(s.push(l?e.value:e.primaryKey),++i===d?o({result:s}):void e.continue()):o({result:s})},c.onerror=Re(a))})}),openCursor:function(n){var e=n.trans,o=n.values,a=n.query,i=n.reverse,c=n.unique;return new Promise(function(n,s){n=Mn(n);var u=a.index,l=a.range,d=e.objectStore(t),f=(d=u.isPrimaryKey?d:d.index(u.name),u=i?c?"prevunique":"prev":c?"nextunique":"next",!o&&"openKeyCursor"in d?d.openKeyCursor(r(l),u):d.openCursor(r(l),u));f.onerror=Re(s),f.onsuccess=Mn(function(t){var r,o,a,i,c=f.result;c?(c.___id=++Xe,c.done=!1,r=c.continue.bind(c),o=(o=c.continuePrimaryKey)&&o.bind(c),a=c.advance.bind(c),i=function(){throw new Error("Cursor not stopped")},c.trans=e,c.stop=c.continue=c.continuePrimaryKey=c.advance=function(){throw new Error("Cursor not started")},c.fail=Mn(s),c.next=function(){var n=this,e=1;return this.start(function(){return e--?n.continue():n.stop()}).then(function(){return n})},c.start=function(n){function e(){if(f.result)try{n()}catch(n){c.fail(n)}else c.done=!0,c.start=function(){throw new Error("Cursor behind last entry")},c.stop()}var t=new Promise(function(n,e){n=Mn(n),f.onerror=Re(e),c.fail=e,c.stop=function(e){c.stop=c.continue=c.continuePrimaryKey=c.advance=i,n(e)}});return f.onsuccess=Mn(function(n){f.onsuccess=e,e()}),c.continue=r,c.continuePrimaryKey=o,c.advance=a,e(),t},n(c)):n(null)},s)})},count:function(n){var e=n.query,o=n.trans,a=e.index,i=e.range;return new Promise(function(n,e){var c=o.objectStore(t),s=a.isPrimaryKey?c:c.index(a.name);(s=(c=r(i))?s.count(c):s.count()).onsuccess=Mn(function(e){return n(e.target.result)}),s.onerror=Re(e)})}}}),{});return s.forEach(function(n){return l[n.name]=n}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(n){if(!l[n])throw new Error("Table '".concat(n,"' not found"));return l[n]},MIN_KEY:-1/0,MAX_KEY:Ge(e),schema:t}}function nt(n,t){var r=t.db;t=function(n,t,r,o){var a=r.IDBKeyRange;return r.indexedDB,{dbcore:(o=Ze(t,a,o),n.dbcore.reduce(function(n,t){return t=t.create,e(e({},n),t(n))},o))}}(n._middlewares,r,n._deps,t),n.core=t.dbcore,n.tables.forEach(function(e){var t=e.name;n.core.schema.tables.some(function(n){return n.name===t})&&(e.core=n.core.table(t),n[t]instanceof n.Table&&(n[t].core=e.core))})}function et(n,e,t,r){t.forEach(function(t){var o=r[t];e.forEach(function(e){var r=function n(e,t){return m(e,t)||(e=s(e))&&n(e,t)}(e,t);(!r||"value"in r&&void 0===r.value)&&(e===n.Transaction.prototype||e instanceof n.Transaction?h(e,t,{get:function(){return this.table(t)},set:function(n){f(this,t,{value:n,writable:!0,configurable:!0,enumerable:!0})}}):e[t]=new n.Table(t,o))})})}function tt(n,e){e.forEach(function(e){for(var t in e)e[t]instanceof n.Table&&delete e[t]})}function rt(n,e){return n._cfg.version-e._cfg.version}function ot(n,e){var t,r={del:[],add:[],change:[]};for(t in n)e[t]||r.del.push(t);for(t in e){var o=n[t],a=e[t];if(o){var i={name:t,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||o.primKey.auto!==a.primKey.auto)i.recreate=!0,r.change.push(i);else{var c=o.idxByName,s=a.idxByName,u=void 0;for(u in c)s[u]||i.del.push(u);for(u in s){var l=c[u],d=s[u];l?l.src!==d.src&&i.change.push(d):i.add.push(d)}(0<i.del.length||0<i.add.length||0<i.change.length)&&r.change.push(i)}}else r.add.push([t,a])}return r}function at(n,e,t,r){var o=n.db.createObjectStore(e,t.keyPath?{keyPath:t.keyPath,autoIncrement:t.auto}:{autoIncrement:t.auto});return r.forEach(function(n){return ct(o,n)}),o}function it(n,e){a(n).forEach(function(t){e.db.objectStoreNames.contains(t)||(on&&console.debug("Dexie: Creating missing table",t),at(e,t,n[t].primKey,n[t].indexes))})}function ct(n,e){n.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function st(n,e,t){var r={};return y(e.objectStoreNames,0).forEach(function(n){for(var e=t.objectStore(n),o=Ve(Ue(c=e.keyPath),c||"",!0,!1,!!e.autoIncrement,c&&"string"!=typeof c,!0),a=[],i=0;i<e.indexNames.length;++i){var c=(s=e.index(e.indexNames[i])).keyPath,s=Ve(s.name,c,!!s.unique,!!s.multiEntry,!1,c&&"string"!=typeof c,!1);a.push(s)}r[n]=He(n,o,a)}),r}function ut(n,e,t){for(var r=t.db.objectStoreNames,a=0;a<r.length;++a){var i=r[a],c=t.objectStore(i);n._hasGetAll="getAll"in c;for(var s=0;s<c.indexNames.length;++s){var u=c.indexNames[s],l=c.index(u).keyPath,d="string"==typeof l?l:"["+y(l).join("+")+"]";!e[i]||(l=e[i].idxByName[d])&&(l.name=u,delete e[i].idxByName[d],e[i].idxByName[u]=l)}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function lt(n){return n.split(",").map(function(n,e){var t=null===(r=(o=n.split(":"))[1])||void 0===r?void 0:r.trim(),r=(n=o[0].trim()).replace(/([&*]|\+\+)/g,""),o=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return Ve(r,o||null,/\&/.test(n),/\*/.test(n),/\+\+/.test(n),i(o),0===e,t)})}var dt=(ft.prototype._createTableSchema=He,ft.prototype._parseIndexSyntax=lt,ft.prototype._parseStoresSpec=function(n,e){var t=this;a(n).forEach(function(r){if(null!==n[r]){var o=t._parseIndexSyntax(n[r]),a=o.shift();if(!a)throw new U.Schema("Invalid schema for table "+r+": "+n[r]);if(a.unique=!0,a.multi)throw new U.Schema("Primary key cannot be multiEntry*");o.forEach(function(n){if(n.auto)throw new U.Schema("Only primary key can be marked as autoIncrement (++)");if(!n.keyPath)throw new U.Schema("Index must have a name and cannot be an empty string")}),o=t._createTableSchema(r,a,o),e[r]=o}})},ft.prototype.stores=function(n){var e=this.db;this._cfg.storesSource=this._cfg.storesSource?c(this._cfg.storesSource,n):n,n=e._versions;var t={},r={};return n.forEach(function(n){c(t,n._cfg.storesSource),r=n._cfg.dbschema={},n._parseStoresSpec(t,r)}),e._dbSchema=r,tt(e,[e._allTables,e,e.Transaction.prototype]),et(e,[e._allTables,e,e.Transaction.prototype,this._cfg.tables],a(r),r),e._storeNames=a(r),this},ft.prototype.upgrade=function(n){return this._cfg.contentUpgrade=rn(this._cfg.contentUpgrade||$,n),this},ft);function ft(){}function ht(n,e){var t=n._dbNamesDB;return t||(t=n._dbNamesDB=new Qt(te,{addons:[],indexedDB:n,IDBKeyRange:e})).version(1).stores({dbnames:"name"}),t.table("dbnames")}function pt(n){return n&&"function"==typeof n.databases}function mt(n){return Fn(function(){return gn.letThrough=!0,n()})}function vt(n){return!("from"in n)}var yt=function(n,e){if(!this){var t=new yt;return n&&"d"in n&&c(t,n),t}c(this,arguments.length?{d:1,from:n,to:1<arguments.length?e:n}:{d:0})};function gt(n,e,t){var r=ue(e,t);if(!isNaN(r)){if(0<r)throw RangeError();if(vt(n))return c(n,{from:e,to:t,d:1});var o=n.l;if(r=n.r,ue(t,n.from)<0)return o?gt(o,e,t):n.l={from:e,to:t,d:1,l:null,r:null},kt(n);if(0<ue(e,n.to))return r?gt(r,e,t):n.r={from:e,to:t,d:1,l:null,r:null},kt(n);ue(e,n.from)<0&&(n.from=e,n.l=null,n.d=r?r.d+1:1),0<ue(t,n.to)&&(n.to=t,n.r=null,n.d=n.l?n.l.d+1:1),t=!n.r,o&&!n.l&&bt(n,o),r&&t&&bt(n,r)}}function bt(n,e){vt(e)||function n(e,t){var r=t.from,o=t.to,a=t.l;t=t.r,gt(e,r,o),a&&n(e,a),t&&n(e,t)}(n,e)}function wt(n,e){var t=xt(e),r=t.next();if(r.done)return!1;for(var o=r.value,a=xt(n),i=a.next(o.from),c=i.value;!r.done&&!i.done;){if(ue(c.from,o.to)<=0&&0<=ue(c.to,o.from))return!0;ue(o.from,c.from)<0?o=(r=t.next(c.from)).value:c=(i=a.next(o.from)).value}return!1}function xt(n){var e=vt(n)?null:{s:0,n};return{next:function(n){for(var t=0<arguments.length;e;)switch(e.s){case 0:if(e.s=1,t)for(;e.n.l&&ue(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!t||ue(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function kt(n){var t,r,o=((null===(t=n.r)||void 0===t?void 0:t.d)||0)-((null===(r=n.l)||void 0===r?void 0:r.d)||0),a=1<o?"r":o<-1?"l":"";a&&(t="r"==a?"l":"r",r=e({},n),o=n[a],n.from=o.from,n.to=o.to,n[a]=o[a],r[a]=o[t],(n[t]=r).d=_t(r)),n.d=_t(n)}function _t(n){var e=n.r;return n=n.l,(e?n?Math.max(e.d,n.d):e.d:n?n.d:0)+1}function Et(n,e){return a(e).forEach(function(t){n[t]?bt(n[t],e[t]):n[t]=function n(e){var t,r,o={};for(t in e)l(e,t)&&(r=e[t],o[t]=!r||"object"!=typeof r||O.has(r.constructor)?r:n(r));return o}(e[t])}),n}function St(n,e){return n.all||e.all||Object.keys(n).some(function(t){return e[t]&&wt(e[t],n[t])})}d(yt.prototype,((R={add:function(n){return bt(this,n),this},addKey:function(n){return gt(this,n,n),this},addKeys:function(n){var e=this;return n.forEach(function(n){return gt(e,n,n)}),this},hasKey:function(n){var e=xt(this).next(n).value;return e&&ue(e.from,n)<=0&&0<=ue(e.to,n)}})[N]=function(){return xt(this)},R));var Dt={},Ot={},Tt=!1;function Pt(n){Et(Ot,n),Tt||(Tt=!0,setTimeout(function(){Tt=!1,jt(Ot,!(Ot={}))},0))}function jt(n,e){void 0===e&&(e=!1);var t=new Set;if(n.all)for(var r=0,o=Object.values(Dt);r<o.length;r++)Ct(i=o[r],n,t,e);else for(var a in n){var i,c=/^idb\:\/\/(.*)\/(.*)\//.exec(a);c&&(a=c[1],c=c[2],(i=Dt["idb://".concat(a,"/").concat(c)])&&Ct(i,n,t,e))}t.forEach(function(n){return n()})}function Ct(n,e,t,r){for(var o=[],a=0,i=Object.entries(n.queries.query);a<i.length;a++){for(var c=i[a],s=c[0],u=[],l=0,d=c[1];l<d.length;l++){var f=d[l];St(e,f.obsSet)?f.subscribers.forEach(function(n){return t.add(n)}):r&&u.push(f)}r&&o.push([s,u])}if(r)for(var h=0,p=o;h<p.length;h++){var m=p[h];s=m[0],u=m[1],n.queries.query[s]=u}}function Nt(n){var e=n._state,t=n._deps.indexedDB;if(e.isBeingOpened||n.idbdb)return e.dbReadyPromise.then(function(){return e.dbOpenError?Xn(e.dbOpenError):n});e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var r=e.openCanceller,o=Math.round(10*n.verno),i=!1;function c(){if(e.openCanceller!==r)throw new U.DatabaseClosed("db.open() was cancelled")}var s,u=e.dbReadyResolve,l=null,d=!1;return kn.race([r,("undefined"==typeof navigator?kn.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(n){function e(){return indexedDB.databases().finally(n)}s=setInterval(e,100),e()}).finally(function(){return clearInterval(s)}):Promise.resolve()).then(function r(){return new kn(function(s,u){if(c(),!t)throw new U.MissingAPI;var f=n.name,h=e.autoSchema||!o?t.open(f):t.open(f,o);if(!h)throw new U.MissingAPI;h.onerror=Re(u),h.onblocked=Mn(n._fireOnBlocked),h.onupgradeneeded=Mn(function(r){var o;l=h.transaction,e.autoSchema&&!n._options.allowEmptyDB?(h.onerror=Ke,l.abort(),h.result.close(),(o=t.deleteDatabase(f)).onsuccess=o.onerror=Mn(function(){u(new U.NoSuchDatabase("Database ".concat(f," doesnt exist")))})):(l.onerror=Re(u),r=r.oldVersion>Math.pow(2,62)?0:r.oldVersion,d=r<1,n.idbdb=h.result,i&&function(n,e){it(n._dbSchema,e),e.db.version%10!=0||e.objectStoreNames.contains("$meta")||e.db.createObjectStore("$meta").add(Math.ceil(e.db.version/10-1),"version");var t=st(0,n.idbdb,e);ut(n,n._dbSchema,e);for(var r=0,o=ot(t,n._dbSchema).change;r<o.length;r++){var a=function(n){if(n.change.length||n.recreate)return console.warn("Unable to patch indexes of table ".concat(n.name," because it has changes on the type of index or primary key.")),{value:void 0};var t=e.objectStore(n.name);n.add.forEach(function(e){on&&console.debug("Dexie upgrade patch: Creating missing index ".concat(n.name,".").concat(e.src)),ct(t,e)})}(o[r]);if("object"==typeof a)return a.value}}(n,l),function(n,e,t,r){var o=n._dbSchema;t.objectStoreNames.contains("$meta")&&!o.$meta&&(o.$meta=He("$meta",lt("")[0],[]),n._storeNames.push("$meta"));var i=n._createTransaction("readwrite",n._storeNames,o);i.create(t),i._completion.catch(r);var c=i._reject.bind(i),s=gn.transless||gn;Fn(function(){return gn.trans=i,gn.transless=s,0!==e?(nt(n,t),u=e,((r=i).storeNames.includes("$meta")?r.table("$meta").get("version").then(function(n){return null!=n?n:u}):kn.resolve(u)).then(function(e){return o=e,c=i,s=t,u=[],e=(r=n)._versions,l=r._dbSchema=st(0,r.idbdb,s),0!==(e=e.filter(function(n){return n._cfg.version>=o})).length?(e.forEach(function(n){u.push(function(){var e=l,t=n._cfg.dbschema;ut(r,e,s),ut(r,t,s),l=r._dbSchema=t;var i=ot(e,t);i.add.forEach(function(n){at(s,n[0],n[1].primKey,n[1].indexes)}),i.change.forEach(function(n){if(n.recreate)throw new U.Upgrade("Not yet support for changing primary key");var e=s.objectStore(n.name);n.add.forEach(function(n){return ct(e,n)}),n.change.forEach(function(n){e.deleteIndex(n.name),ct(e,n)}),n.del.forEach(function(n){return e.deleteIndex(n)})});var u=n._cfg.contentUpgrade;if(u&&n._cfg.version>o){nt(r,s),c._memoizedTables={};var d=_(t);i.del.forEach(function(n){d[n]=e[n]}),tt(r,[r.Transaction.prototype]),et(r,[r.Transaction.prototype],a(d),d),c.schema=d;var f,h=B(u);return h&&Wn(),i=kn.follow(function(){var n;(f=u(c))&&h&&(n=Yn.bind(null,null),f.then(n,n))}),f&&"function"==typeof f.then?kn.resolve(f):i.then(function(){return f})}}),u.push(function(e){var t,o,a=n._cfg.dbschema;t=a,o=e,[].slice.call(o.db.objectStoreNames).forEach(function(n){return null==t[n]&&o.db.deleteObjectStore(n)}),tt(r,[r.Transaction.prototype]),et(r,[r.Transaction.prototype],r._storeNames,r._dbSchema),c.schema=r._dbSchema}),u.push(function(e){r.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(r.idbdb.version/10)===n._cfg.version?(r.idbdb.deleteObjectStore("$meta"),delete r._dbSchema.$meta,r._storeNames=r._storeNames.filter(function(n){return"$meta"!==n})):e.objectStore("$meta").put(n._cfg.version,"version"))})}),function n(){return u.length?kn.resolve(u.shift()(c.idbtrans)).then(n):kn.resolve()}().then(function(){it(l,s)})):kn.resolve();var r,o,c,s,u,l}).catch(c)):(a(o).forEach(function(n){at(t,n,o[n].primKey,o[n].indexes)}),nt(n,t),void kn.follow(function(){return n.on.populate.fire(i)}).catch(c));var r,u})}(n,r/10,l,u))},u),h.onsuccess=Mn(function(){l=null;var t,c,u,p,m,v=n.idbdb=h.result,g=y(v.objectStoreNames);if(0<g.length)try{var b=v.transaction(1===(p=g).length?p[0]:p,"readonly");if(e.autoSchema)c=v,u=b,(t=n).verno=c.version/10,u=t._dbSchema=st(0,c,u),t._storeNames=y(c.objectStoreNames,0),et(t,[t._allTables],a(u),u);else if(ut(n,n._dbSchema,b),((m=ot(st(0,(m=n).idbdb,b),m._dbSchema)).add.length||m.change.some(function(n){return n.add.length||n.change.length}))&&!i)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),v.close(),o=v.version+1,i=!0,s(r());nt(n,b)}catch(t){}ee.push(n),v.onversionchange=Mn(function(t){e.vcFired=!0,n.on("versionchange").fire(t)}),v.onclose=Mn(function(e){n.on("close").fire(e)}),d&&(m=n._deps,b=f,v=m.indexedDB,m=m.IDBKeyRange,pt(v)||b===te||ht(v,m).put({name:b}).catch($)),s()},u)}).catch(function(n){switch(null==n?void 0:n.name){case"UnknownError":if(0<e.PR1398_maxLoop)return e.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),r();break;case"VersionError":if(0<o)return o=0,r()}return kn.reject(n)})})]).then(function(){return c(),e.onReadyBeingFired=[],kn.resolve(mt(function(){return n.on.ready.fire(n.vip)})).then(function t(){if(0<e.onReadyBeingFired.length){var r=e.onReadyBeingFired.reduce(rn,$);return e.onReadyBeingFired=[],kn.resolve(mt(function(){return r(n.vip)})).then(t)}})}).finally(function(){e.openCanceller===r&&(e.onReadyBeingFired=null,e.isBeingOpened=!1)}).catch(function(t){e.dbOpenError=t;try{l&&l.abort()}catch(t){}return r===e.openCanceller&&n._close(),Xn(t)}).finally(function(){e.openComplete=!0,u()}).then(function(){var e;return d&&(e={},n.tables.forEach(function(t){t.schema.indexes.forEach(function(r){r.name&&(e["idb://".concat(n.name,"/").concat(t.name,"/").concat(r.name)]=new yt(-1/0,[[[]]]))}),e["idb://".concat(n.name,"/").concat(t.name,"/")]=e["idb://".concat(n.name,"/").concat(t.name,"/:dels")]=new yt(-1/0,[[[]]])}),We(qe).fire(e),jt(e,!0)),n})}function At(n){function e(e){return n.next(e)}var t=o(e),r=o(function(e){return n.throw(e)});function o(n){return function(e){var o=n(e);return e=o.value,o.done?e:e&&"function"==typeof e.then?e.then(t,r):i(e)?Promise.all(e).then(t,r):t(e)}}return o(e)()}function Mt(n,e,t){for(var r=i(n)?n.slice():[n],o=0;o<t;++o)r.push(e);return r}var Lt={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return e(e({},n),{table:function(t){var r=n.table(t),o=r.schema,a={},i=[];function c(n,t,r){var o=Je(n),s=a[o]=a[o]||[],u=null==n?0:"string"==typeof n?1:n.length,l=0<t;return l=e(e({},r),{name:l?"".concat(o,"(virtual-from:").concat(r.name,")"):r.name,lowLevelIndex:r,isVirtual:l,keyTail:t,keyLength:u,extractKey:$e(n),unique:!l&&r.unique}),s.push(l),l.isPrimaryKey||i.push(l),1<u&&c(2===u?n[0]:n.slice(0,u-1),t+1,r),s.sort(function(n,e){return n.keyTail-e.keyTail}),l}t=c(o.primaryKey.keyPath,0,o.primaryKey),a[":id"]=[t];for(var s=0,u=o.indexes;s<u.length;s++){var l=u[s];c(l.keyPath,0,l)}function d(t){var r,o=t.query.index;return o.isVirtual?e(e({},t),{query:{index:o.lowLevelIndex,range:(r=t.query.range,o=o.keyTail,{type:1===r.type?2:r.type,lower:Mt(r.lower,r.lowerOpen?n.MAX_KEY:n.MIN_KEY,o),lowerOpen:!0,upper:Mt(r.upper,r.upperOpen?n.MIN_KEY:n.MAX_KEY,o),upperOpen:!0})}}):t}return e(e({},r),{schema:e(e({},o),{primaryKey:t,indexes:i,getIndexByKeyPath:function(n){return(n=a[Je(n)])&&n[0]}}),count:function(n){return r.count(d(n))},query:function(n){return r.query(d(n))},openCursor:function(e){var t=e.query.index,o=t.keyTail,a=t.isVirtual,i=t.keyLength;return a?r.openCursor(d(e)).then(function(t){return t&&function(t){return Object.create(t,{continue:{value:function(r){null!=r?t.continue(Mt(r,e.reverse?n.MAX_KEY:n.MIN_KEY,o)):e.unique?t.continue(t.key.slice(0,i).concat(e.reverse?n.MIN_KEY:n.MAX_KEY,o)):t.continue()}},continuePrimaryKey:{value:function(e,r){t.continuePrimaryKey(Mt(e,n.MAX_KEY,o),r)}},primaryKey:{get:function(){return t.primaryKey}},key:{get:function(){var n=t.key;return 1===i?n[0]:n.slice(0,i)}},value:{get:function(){return t.value}}})}(t)}):r.openCursor(e)}})}})}};function It(n,e,t,r){return t=t||{},r=r||"",a(n).forEach(function(o){var a,i,c;l(e,o)?(a=n[o],i=e[o],"object"==typeof a&&"object"==typeof i&&a&&i?(c=C(a))!==C(i)?t[r+o]=e[o]:"Object"===c?It(a,i,t,r+o+"."):a!==i&&(t[r+o]=e[o]):a!==i&&(t[r+o]=e[o])):t[r+o]=void 0}),a(e).forEach(function(o){l(n,o)||(t[r+o]=e[o])}),t}function Bt(n,e){return"delete"===e.type?e.keys:e.keys||e.values.map(n.extractKey)}var Rt={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return e(e({},n),{table:function(t){var o=n.table(t),a=o.schema.primaryKey;return e(e({},o),{mutate:function(n){var i=gn.trans,c=i.table(t).hook,s=c.deleting,u=c.creating,d=c.updating;switch(n.type){case"add":if(u.fire===$)break;return i._promise("readwrite",function(){return f(n)},!0);case"put":if(u.fire===$&&d.fire===$)break;return i._promise("readwrite",function(){return f(n)},!0);case"delete":if(s.fire===$)break;return i._promise("readwrite",function(){return f(n)},!0);case"deleteRange":if(s.fire===$)break;return i._promise("readwrite",function(){return function n(t,r,i){return o.query({trans:t,values:!1,query:{index:a,range:r},limit:i}).then(function(o){var a=o.result;return f({type:"delete",keys:a,trans:t}).then(function(o){return 0<o.numFailures?Promise.reject(o.failures[0]):a.length<i?{failures:[],numFailures:0,lastResult:void 0}:n(t,e(e({},r),{lower:a[a.length-1],lowerOpen:!0}),i)})})}(n.trans,n.range,1e4)},!0)}return o.mutate(n);function f(n){var t,i,c,f=gn.trans,h=n.keys||Bt(a,n);if(!h)throw new Error("Keys missing");return"delete"!==(n="add"===n.type||"put"===n.type?e(e({},n),{keys:h}):e({},n)).type&&(n.values=r([],n.values,!0)),n.keys&&(n.keys=r([],n.keys,!0)),t=o,c=h,("add"===(i=n).type?Promise.resolve([]):t.getMany({trans:i.trans,keys:c,cache:"immutable"})).then(function(e){var t=h.map(function(t,r){var o,i,c,h=e[r],p={onerror:null,onsuccess:null};return"delete"===n.type?s.fire.call(p,t,h,f):"add"===n.type||void 0===h?(o=u.fire.call(p,t,n.values[r],f),null==t&&null!=o&&(n.keys[r]=t=o,a.outbound||k(n.values[r],a.keyPath,t))):(o=It(h,n.values[r]),(i=d.fire.call(p,o,t,h,f))&&(c=n.values[r],Object.keys(i).forEach(function(n){l(c,n)?c[n]=i[n]:k(c,n,i[n])}))),p});return o.mutate(n).then(function(r){for(var o=r.failures,a=r.results,i=r.numFailures,c=(r=r.lastResult,0);c<h.length;++c){var s=(a||h)[c],u=t[c];null==s?u.onerror&&u.onerror(o[c]):u.onsuccess&&u.onsuccess("put"===n.type&&e[c]?n.values[c]:s)}return{failures:o,results:a,numFailures:i,lastResult:r}}).catch(function(n){return t.forEach(function(e){return e.onerror&&e.onerror(n)}),Promise.reject(n)})})}}})}})}};function Kt(n,e,t){try{if(!e)return null;if(e.keys.length<n.length)return null;for(var r=[],o=0,a=0;o<e.keys.length&&a<n.length;++o)0===ue(e.keys[o],n[a])&&(r.push(t?P(e.values[o]):e.values[o]),++a);return r.length===n.length?r:null}catch(n){return null}}var qt={stack:"dbcore",level:-1,create:function(n){return{table:function(t){var r=n.table(t);return e(e({},r),{getMany:function(n){if(!n.cache)return r.getMany(n);var e=Kt(n.keys,n.trans._cache,"clone"===n.cache);return e?kn.resolve(e):r.getMany(n).then(function(e){return n.trans._cache={keys:n.keys,values:"clone"===n.cache?P(e):e},e})},mutate:function(n){return"add"!==n.type&&(n.trans._cache=null),r.mutate(n)}})}}}};function Ft(n,e){return"readonly"===n.trans.mode&&!!n.subscr&&!n.trans.explicit&&"disabled"!==n.trans.db._options.cache&&!e.schema.primaryKey.outbound}function Wt(n,e){switch(n){case"query":return e.values&&!e.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Yt={stack:"dbcore",level:0,name:"Observability",create:function(n){var t=n.schema.name,r=new yt(n.MIN_KEY,n.MAX_KEY);return e(e({},n),{transaction:function(e,t,r){if(gn.subscr&&"readonly"!==t)throw new U.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(gn.querier));return n.transaction(e,t,r)},table:function(o){var c=n.table(o),s=c.schema,u=s.primaryKey,l=s.indexes,d=u.extractKey,f=u.outbound,h=u.autoIncrement&&l.filter(function(n){return n.compound&&n.keyPath.includes(u.keyPath)}),p=e(e({},c),{mutate:function(e){function a(n){return n="idb://".concat(t,"/").concat(o,"/").concat(n),m[n]||(m[n]=new yt)}var l,d,f,p=e.trans,m=e.mutatedParts||(e.mutatedParts={}),v=a(""),y=a(":dels"),g=e.type,b="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[Bt(u,e).filter(function(n){return n}),e.values]:[],w=b[0],x=b[1];return b=e.trans._cache,i(w)?(v.addKeys(w),(b="delete"===g||w.length===x.length?Kt(w,b):null)||y.addKeys(w),(b||x)&&(l=a,d=b,f=x,s.indexes.forEach(function(n){var e=l(n.name||"");function t(e){return null!=e?n.extractKey(e):null}function r(t){return n.multiEntry&&i(t)?t.forEach(function(n){return e.addKey(n)}):e.addKey(t)}(d||f).forEach(function(n,e){var o=d&&t(d[e]);0!==ue(o,e=f&&t(f[e]))&&(null!=o&&r(o),null!=e&&r(e))})}))):w?(x={from:null!==(x=w.lower)&&void 0!==x?x:n.MIN_KEY,to:null!==(x=w.upper)&&void 0!==x?x:n.MAX_KEY},y.add(x),v.add(x)):(v.add(r),y.add(r),s.indexes.forEach(function(n){return a(n.name).add(r)})),c.mutate(e).then(function(n){return!w||"add"!==e.type&&"put"!==e.type||(v.addKeys(n.results),h&&h.forEach(function(t){for(var r=e.values.map(function(n){return t.extractKey(n)}),o=t.keyPath.findIndex(function(n){return n===u.keyPath}),i=0,c=n.results.length;i<c;++i)r[i][o]=n.results[i];a(t.name).addKeys(r)})),p.mutatedParts=Et(p.mutatedParts||{},m),n})}}),m=(l=function(e){e=(t=e.query).index;var t=t.range;return[e,new yt(null!==(e=t.lower)&&void 0!==e?e:n.MIN_KEY,null!==(t=t.upper)&&void 0!==t?t:n.MAX_KEY)]},{get:function(n){return[u,new yt(n.key)]},getMany:function(n){return[u,(new yt).addKeys(n.keys)]},count:l,query:l,openCursor:l});return a(m).forEach(function(n){p[n]=function(a){var i=!!(p=gn.subscr),s=Ft(gn,c)&&Wt(n,a)?a.obsSet={}:p;if(i){var u=function(n){return n="idb://".concat(t,"/").concat(o,"/").concat(n),s[n]||(s[n]=new yt)},l=u(""),h=u(":dels"),p=(i=(p=m[n](a))[0],p[1]);if(("query"===n&&i.isPrimaryKey&&!a.values?h:u(i.name||"")).add(p),!i.isPrimaryKey){if("count"!==n){var v="query"===n&&f&&a.values&&c.query(e(e({},a),{values:!1}));return c[n].apply(this,arguments).then(function(e){if("query"===n){if(f&&a.values)return v.then(function(n){return n=n.result,l.addKeys(n),e});var t=a.values?e.result.map(d):e.result;(a.values?l:h).addKeys(t)}else if("openCursor"===n){var r=e,o=a.values;return r&&Object.create(r,{key:{get:function(){return h.addKey(r.primaryKey),r.key}},primaryKey:{get:function(){var n=r.primaryKey;return h.addKey(n),n}},value:{get:function(){return o&&l.addKey(r.primaryKey),r.value}}})}return e})}h.add(r)}}return c[n].apply(this,arguments)}}),p}})}};function zt(n,t,r){if(0===r.numFailures)return t;if("deleteRange"===t.type)return null;var o=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return r.numFailures===o?null:(t=e({},t),i(t.keys)&&(t.keys=t.keys.filter(function(n,e){return!(e in r.failures)})),"values"in t&&i(t.values)&&(t.values=t.values.filter(function(n,e){return!(e in r.failures)})),t)}function Vt(n,e){return t=n,(void 0===(r=e).lower||(r.lowerOpen?0<ue(t,r.lower):0<=ue(t,r.lower)))&&(void 0===e.upper||(e.upperOpen?ue(n,e.upper)<0:ue(n,e.upper)<=0));var t,r}function Ut(n,e,t,r,o,a){if(!t||0===t.length)return n;var c=e.query.index,s=c.multiEntry,u=e.query.range,l=r.schema.primaryKey.extractKey,d=c.extractKey,f=(c.lowLevelIndex||c).extractKey;return t=t.reduce(function(n,t){var r=n,o=[];if("add"===t.type||"put"===t.type)for(var a=new yt,c=t.values.length-1;0<=c;--c){var f,h=t.values[c],p=l(h);a.hasKey(p)||(f=d(h),(s&&i(f)?f.some(function(n){return Vt(n,u)}):Vt(f,u))&&(a.addKey(p),o.push(h)))}switch(t.type){case"add":var m=(new yt).addKeys(e.values?n.map(function(n){return l(n)}):n);r=n.concat(e.values?o.filter(function(n){return n=l(n),!m.hasKey(n)&&(m.addKey(n),!0)}):o.map(function(n){return l(n)}).filter(function(n){return!m.hasKey(n)&&(m.addKey(n),!0)}));break;case"put":var v=(new yt).addKeys(t.values.map(function(n){return l(n)}));r=n.filter(function(n){return!v.hasKey(e.values?l(n):n)}).concat(e.values?o:o.map(function(n){return l(n)}));break;case"delete":var y=(new yt).addKeys(t.keys);r=n.filter(function(n){return!y.hasKey(e.values?l(n):n)});break;case"deleteRange":var g=t.range;r=n.filter(function(n){return!Vt(l(n),g)})}return r},n),t===n?n:(t.sort(function(n,e){return ue(f(n),f(e))||ue(l(n),l(e))}),e.limit&&e.limit<1/0&&(t.length>e.limit?t.length=e.limit:n.length===e.limit&&t.length<e.limit&&(o.dirty=!0)),a?Object.freeze(t):t)}function Ht(n,e){return 0===ue(n.lower,e.lower)&&0===ue(n.upper,e.upper)&&!!n.lowerOpen==!!e.lowerOpen&&!!n.upperOpen==!!e.upperOpen}var Gt={stack:"dbcore",level:0,name:"Cache",create:function(n){var t=n.schema.name;return e(e({},n),{transaction:function(e,r,o){var a,i,c=n.transaction(e,r,o);return"readwrite"===r&&(i=(a=new AbortController).signal,o=function(o){return function(){if(a.abort(),"readwrite"===r){for(var i=new Set,s=0,u=e;s<u.length;s++){var l=u[s],d=Dt["idb://".concat(t,"/").concat(l)];if(d){var f=n.table(l),h=d.optimisticOps.filter(function(n){return n.trans===c});if(c._explicit&&o&&c.mutatedParts)for(var p=0,m=Object.values(d.queries.query);p<m.length;p++)for(var v=0,y=(w=m[p]).slice();v<y.length;v++)St((x=y[v]).obsSet,c.mutatedParts)&&(M(w,x),x.subscribers.forEach(function(n){return i.add(n)}));else if(0<h.length){d.optimisticOps=d.optimisticOps.filter(function(n){return n.trans!==c});for(var g=0,b=Object.values(d.queries.query);g<b.length;g++)for(var w,x,k,_=0,E=(w=b[g]).slice();_<E.length;_++)null!=(x=E[_]).res&&c.mutatedParts&&(o&&!x.dirty?(k=Object.isFrozen(x.res),k=Ut(x.res,x.req,h,f,x,k),x.dirty?(M(w,x),x.subscribers.forEach(function(n){return i.add(n)})):k!==x.res&&(x.res=k,x.promise=kn.resolve({result:k}))):(x.dirty&&M(w,x),x.subscribers.forEach(function(n){return i.add(n)})))}}}i.forEach(function(n){return n()})}}},c.addEventListener("abort",o(!1),{signal:i}),c.addEventListener("error",o(!1),{signal:i}),c.addEventListener("complete",o(!0),{signal:i})),c},table:function(r){var o=n.table(r),a=o.schema.primaryKey;return e(e({},o),{mutate:function(n){var i=gn.trans;if(a.outbound||"disabled"===i.db._options.cache||i.explicit||"readwrite"!==i.idbtrans.mode)return o.mutate(n);var c=Dt["idb://".concat(t,"/").concat(r)];return c?(i=o.mutate(n),"add"!==n.type&&"put"!==n.type||!(50<=n.values.length||Bt(a,n).some(function(n){return null==n}))?(c.optimisticOps.push(n),n.mutatedParts&&Pt(n.mutatedParts),i.then(function(e){0<e.numFailures&&(M(c.optimisticOps,n),(e=zt(0,n,e))&&c.optimisticOps.push(e),n.mutatedParts&&Pt(n.mutatedParts))}),i.catch(function(){M(c.optimisticOps,n),n.mutatedParts&&Pt(n.mutatedParts)})):i.then(function(t){var r=zt(0,e(e({},n),{values:n.values.map(function(n,r){var o;return t.failures[r]||k(n=null!==(o=a.keyPath)&&void 0!==o&&o.includes(".")?P(n):e({},n),a.keyPath,t.results[r]),n})}),t);c.optimisticOps.push(r),queueMicrotask(function(){return n.mutatedParts&&Pt(n.mutatedParts)})}),i):o.mutate(n)},query:function(n){if(!Ft(gn,o)||!Wt("query",n))return o.query(n);var e="immutable"===(null===(c=gn.trans)||void 0===c?void 0:c.db._options.cache),a=(u=gn).requery,i=u.signal,c=function(n,e,t,r){var o=Dt["idb://".concat(n,"/").concat(e)];if(!o)return[];if(!(e=o.queries[t]))return[null,!1,o,null];var a=e[(r.query?r.query.index.name:null)||""];if(!a)return[null,!1,o,null];switch(t){case"query":var i=a.find(function(n){return n.req.limit===r.limit&&n.req.values===r.values&&Ht(n.req.query.range,r.query.range)});return i?[i,!0,o,a]:[a.find(function(n){return("limit"in n.req?n.req.limit:1/0)>=r.limit&&(!r.values||n.req.values)&&function(n,e){return function(n,e,t,r){if(void 0===n)return void 0!==e?-1:0;if(void 0===e)return 1;if(0===(e=ue(n,e))){if(t&&r)return 0;if(t)return 1;if(r)return-1}return e}(n.lower,e.lower,n.lowerOpen,e.lowerOpen)<=0&&0<=function(n,e,t,r){if(void 0===n)return void 0!==e?1:0;if(void 0===e)return-1;if(0===(e=ue(n,e))){if(t&&r)return 0;if(t)return-1;if(r)return 1}return e}(n.upper,e.upper,n.upperOpen,e.upperOpen)}(n.req.query.range,r.query.range)}),!1,o,a];case"count":return i=a.find(function(n){return Ht(n.req.query.range,r.query.range)}),[i,!!i,o,a]}}(t,r,"query",n),s=c[0],u=c[1],l=c[2],d=c[3];return s&&u?s.obsSet=n.obsSet:(u=o.query(n).then(function(n){var t=n.result;if(s&&(s.res=t),e){for(var r=0,o=t.length;r<o;++r)Object.freeze(t[r]);Object.freeze(t)}else n.result=P(t);return n}).catch(function(n){return d&&s&&M(d,s),Promise.reject(n)}),s={obsSet:n.obsSet,promise:u,subscribers:new Set,type:"query",req:n,dirty:!1},d?d.push(s):(d=[s],(l=l||(Dt["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[n.query.index.name||""]=d)),function(n,e,t,r){n.subscribers.add(t),r.addEventListener("abort",function(){var r,o;n.subscribers.delete(t),0===n.subscribers.size&&(r=n,o=e,setTimeout(function(){0===r.subscribers.size&&M(o,r)},3e3))})}(s,d,a,i),s.promise.then(function(t){return{result:Ut(t.result,n,null==l?void 0:l.optimisticOps,o,s,e)}})}})}})}};function $t(n,e){return new Proxy(n,{get:function(n,t,r){return"db"===t?e:Reflect.get(n,t,r)}})}var Qt=(Xt.prototype.version=function(n){if(isNaN(n)||n<.1)throw new U.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new U.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var e=this._versions,t=e.filter(function(e){return e._cfg.version===n})[0];return t||(t=new this.Version(n),e.push(t),e.sort(rt),t.stores({}),this._state.autoSchema=!1,t)},Xt.prototype._whenReady=function(n){var e=this;return this.idbdb&&(this._state.openComplete||gn.letThrough||this._vip)?n():new kn(function(n,t){if(e._state.openComplete)return t(new U.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return void t(new U.DatabaseClosed);e.open().catch($)}e._state.dbReadyPromise.then(n,t)}).then(n)},Xt.prototype.use=function(n){var e=n.stack,t=n.create,r=n.level,o=n.name;return o&&this.unuse({stack:e,name:o}),(n=this._middlewares[e]||(this._middlewares[e]=[])).push({stack:e,create:t,level:null==r?10:r,name:o}),n.sort(function(n,e){return n.level-e.level}),this},Xt.prototype.unuse=function(n){var e=n.stack,t=n.name,r=n.create;return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(function(n){return r?n.create!==r:!!t&&n.name!==t})),this},Xt.prototype.open=function(){var n=this;return Gn(yn,function(){return Nt(n)})},Xt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,e=ee.indexOf(this);if(0<=e&&ee.splice(e,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new kn(function(e){n.dbReadyResolve=e}),n.openCanceller=new kn(function(e,t){n.cancelOpen=t}))},Xt.prototype.close=function(n){var e=(void 0===n?{disableAutoOpen:!0}:n).disableAutoOpen;n=this._state,e?(n.isBeingOpened&&n.cancelOpen(new U.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new U.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},Xt.prototype.delete=function(n){var e=this;void 0===n&&(n={disableAutoOpen:!0});var t=0<arguments.length&&"object"!=typeof arguments[0],r=this._state;return new kn(function(o,a){function i(){e.close(n);var t=e._deps.indexedDB.deleteDatabase(e.name);t.onsuccess=Mn(function(){var n,t,r;n=e._deps,t=e.name,r=n.indexedDB,n=n.IDBKeyRange,pt(r)||t===te||ht(r,n).delete(t).catch($),o()}),t.onerror=Re(a),t.onblocked=e._fireOnBlocked}if(t)throw new U.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(i):i()})},Xt.prototype.backendDB=function(){return this.idbdb},Xt.prototype.isOpen=function(){return null!==this.idbdb},Xt.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&"DatabaseClosed"===n.name},Xt.prototype.hasFailed=function(){return null!==this._state.dbOpenError},Xt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Xt.prototype,"tables",{get:function(){var n=this;return a(this._allTables).map(function(e){return n._allTables[e]})},enumerable:!1,configurable:!0}),Xt.prototype.transaction=function(){var n=function(n,e,t){var r=arguments.length;if(r<2)throw new U.InvalidArgument("Too few arguments");for(var o=new Array(r-1);--r;)o[r-1]=arguments[r];return t=o.pop(),[n,S(o),t]}.apply(this,arguments);return this._transaction.apply(this,n)},Xt.prototype._transaction=function(n,e,t){var r=this,o=gn.trans;o&&o.db===this&&-1===n.indexOf("!")||(o=null);var a,i,c=-1!==n.indexOf("?");n=n.replace("!","").replace("?","");try{if(i=e.map(function(n){if("string"!=typeof(n=n instanceof r.Table?n.name:n))throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return n}),"r"==n||n===re)a=re;else{if("rw"!=n&&n!=oe)throw new U.InvalidArgument("Invalid transaction mode: "+n);a=oe}if(o){if(o.mode===re&&a===oe){if(!c)throw new U.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&i.forEach(function(n){if(o&&-1===o.storeNames.indexOf(n)){if(!c)throw new U.SubTransaction("Table "+n+" not included in parent transaction.");o=null}}),c&&o&&!o.active&&(o=null)}}catch(t){return o?o._promise(null,function(n,e){e(t)}):Xn(t)}var s=function n(e,t,r,o,a){return kn.resolve().then(function(){var i=gn.transless||gn,c=e._createTransaction(t,r,e._dbSchema,o);if(c.explicit=!0,i={trans:c,transless:i},o)c.idbtrans=o.idbtrans;else try{c.create(),c.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(i){return i.name===z.InvalidState&&e.isOpen()&&0<--e._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return n(e,t,r,null,a)})):Xn(i)}var s,u=B(a);return u&&Wn(),i=kn.follow(function(){var n;(s=a.call(c,c))&&(u?(n=Yn.bind(null,null),s.then(n,n)):"function"==typeof s.next&&"function"==typeof s.throw&&(s=At(s)))},i),(s&&"function"==typeof s.then?kn.resolve(s).then(function(n){return c.active?n:Xn(new U.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):i.then(function(){return s})).then(function(n){return o&&c._resolve(),c._completion.then(function(){return n})}).catch(function(n){return c._reject(n),Xn(n)})})}.bind(null,this,a,i,o,t);return o?o._promise(a,s,"lock"):gn.trans?Gn(gn.transless,function(){return r._whenReady(s)}):this._whenReady(s)},Xt.prototype.table=function(n){if(!l(this._allTables,n))throw new U.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},Xt);function Xt(n,t){var r=this;this._middlewares={},this.verno=0;var o=Xt.dependencies;this._options=t=e({addons:Xt.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},o=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,i,c,s,u,l={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:$,dbReadyPromise:null,cancelOpen:$,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};l.dbReadyPromise=new kn(function(n){l.dbReadyResolve=n}),l.openCanceller=new kn(function(n,e){l.cancelOpen=e}),this._state=l,this.name=n,this.on=me(this,"populate","blocked","versionchange","close",{ready:[rn,$]}),this.once=function(n,e){var t=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];r.on(n).unsubscribe(t),e.apply(r,o)};return r.on(n,t)},this.on.ready.subscribe=g(this.on.ready.subscribe,function(n){return function(e,t){Xt.vip(function(){var o,a=r._state;a.openComplete?(a.dbOpenError||kn.resolve().then(e),t&&n(e)):a.onReadyBeingFired?(a.onReadyBeingFired.push(e),t&&n(e)):(n(e),o=r,t||n(function n(){o.on.ready.unsubscribe(e),o.on.ready.unsubscribe(n)}))})}}),this.Collection=(a=this,ve(De.prototype,function(n,e){this.db=a;var t=ie,r=null;if(e)try{t=e()}catch(n){r=n}var o=n._ctx;n=(e=o.table).hook.reading.fire,this._ctx={table:e,index:o.index,isPrimKey:!o.index||e.schema.primKey.keyPath&&o.index===e.schema.primKey.name,range:t,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:o.or,valueMapper:n!==Q?n:null}})),this.Table=(i=this,ve(he.prototype,function(n,e,t){this.db=i,this._tx=t,this.name=n,this.schema=e,this.hook=i._allTables[n]?i._allTables[n].hook:me(null,{creating:[Z,$],reading:[X,Q],updating:[en,$],deleting:[nn,$]})})),this.Transaction=(c=this,ve(Ye.prototype,function(n,e,t,r,o){var a=this;"readonly"!==n&&e.forEach(function(n){(n=null===(n=t[n])||void 0===n?void 0:n.yProps)&&(e=e.concat(n.map(function(n){return n.updatesTable})))}),this.db=c,this.mode=n,this.storeNames=e,this.schema=t,this.chromeTransactionDurability=r,this.idbtrans=null,this.on=me(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new kn(function(n,e){a._resolve=n,a._reject=e}),this._completion.then(function(){a.active=!1,a.on.complete.fire()},function(n){var e=a.active;return a.active=!1,a.on.error.fire(n),a.parent?a.parent._reject(n):e&&a.idbtrans&&a.idbtrans.abort(),Xn(n)})})),this.Version=(s=this,ve(dt.prototype,function(n){this.db=s,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(u=this,ve(Ie.prototype,function(n,e,t){if(this.db=u,this._ctx={table:n,index:":id"===e?null:e,or:t},this._cmp=this._ascending=ue,this._descending=function(n,e){return ue(e,n)},this._max=function(n,e){return 0<ue(n,e)?n:e},this._min=function(n,e){return ue(n,e)<0?n:e},this._IDBKeyRange=u._deps.IDBKeyRange,!this._IDBKeyRange)throw new U.MissingAPI})),this.on("versionchange",function(n){0<n.newVersion?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})}),this.on("blocked",function(n){!n.newVersion||n.newVersion<n.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(n.oldVersion/10))}),this._maxKey=Ge(t.IDBKeyRange),this._createTransaction=function(n,e,t,o){return new r.Transaction(n,e,t,r._options.chromeTransactionDurability,o)},this._fireOnBlocked=function(n){r.on("blocked").fire(n),ee.filter(function(n){return n.name===r.name&&n!==r&&!n._state.vcFired}).map(function(e){return e.on("versionchange").fire(n)})},this.use(qt),this.use(Gt),this.use(Yt),this.use(Lt),this.use(Rt);var d=new Proxy(this,{get:function(n,e,t){if("_vip"===e)return!0;if("table"===e)return function(n){return $t(r.table(n),d)};var o=Reflect.get(n,e,t);return o instanceof he?$t(o,d):"tables"===e?o.map(function(n){return $t(n,d)}):"_createTransaction"===e?function(){return $t(o.apply(this,arguments),d)}:o}});this.vip=d,o.forEach(function(n){return n(r)})}R="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable";var Jt,Zt=(nr.prototype.subscribe=function(n,e,t){return this._subscribe(n&&"function"!=typeof n?n:{next:n,error:e,complete:t})},nr.prototype[R]=function(){return this},nr);function nr(n){this._subscribe=n}try{Jt={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch(D){Jt={indexedDB:null,IDBKeyRange:null}}function er(n){var e,t=!1,r=new Zt(function(r){var o,a=B(n),i=!1,c={},s={},u={get closed(){return i},unsubscribe:function(){i||(i=!0,o&&o.abort(),d&&We.storagemutated.unsubscribe(h))}};r.start&&r.start(u);var d=!1,f=function(){return Qn(p)},h=function(n){Et(c,n),St(s,c)&&f()},p=function(){var u,p,m;!i&&Jt.indexedDB&&(c={},u={},o&&o.abort(),o=new AbortController,m=function(e){var t=jn();try{a&&Wn();var r=Fn(n,e);return r=a?r.finally(Yn):r}finally{t&&Cn()}}(p={subscr:u,signal:o.signal,requery:f,querier:n,trans:null}),Promise.resolve(m).then(function(n){t=!0,e=n,i||p.signal.aborted||(c={},function(n){for(var e in n)if(l(n,e))return;return 1}(s=u)||d||(We(qe,h),d=!0),Qn(function(){return!i&&r.next&&r.next(n)}))},function(n){t=!1,["DatabaseClosedError","AbortError"].includes(null==n?void 0:n.name)||i||Qn(function(){i||r.error&&r.error(n)})}))};return setTimeout(f,0),u});return r.hasValue=function(){return t},r.getValue=function(){return e},r}var tr=Qt;function rr(n){var e=ar;try{ar=!0,We.storagemutated.fire(n),jt(n,!0)}finally{ar=e}}d(tr,e(e({},G),{delete:function(n){return new tr(n,{addons:[]}).delete()},exists:function(n){return new tr(n,{addons:[]}).open().then(function(n){return n.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return t=(e=tr.dependencies).indexedDB,e=e.IDBKeyRange,(pt(t)?Promise.resolve(t.databases()).then(function(n){return n.map(function(n){return n.name}).filter(function(n){return n!==te})}):ht(t,e).toCollection().primaryKeys()).then(n)}catch(n){return Xn(new U.MissingAPI)}var e,t},defineClass:function(){return function(n){c(this,n)}},ignoreTransaction:function(n){return gn.trans?Gn(gn.transless,n):n()},vip:mt,async:function(n){return function(){try{var e=At(n.apply(this,arguments));return e&&"function"==typeof e.then?e:kn.resolve(e)}catch(e){return Xn(e)}}},spawn:function(n,e,t){try{var r=At(n.apply(t,e||[]));return r&&"function"==typeof r.then?r:kn.resolve(r)}catch(n){return Xn(n)}},currentTransaction:{get:function(){return gn.trans||null}},waitFor:function(n,e){return e=kn.resolve("function"==typeof n?tr.ignoreTransaction(n):n).timeout(e||6e4),gn.trans?gn.trans.waitFor(e):e},Promise:kn,debug:{get:function(){return on},set:function(n){an(n)}},derive:p,extend:c,props:d,override:g,Events:me,on:We,liveQuery:er,extendObservabilitySet:Et,getByKeyPath:x,setByKeyPath:k,delByKeyPath:function(n,e){"string"==typeof e?k(n,e,void 0):"length"in e&&[].map.call(e,function(e){k(n,e,void 0)})},shallowClone:_,deepClone:P,getObjectDiff:It,cmp:ue,asap:w,minKey:-1/0,addons:[],connections:ee,errnames:z,dependencies:Jt,cache:Dt,semVer:"4.2.0",version:"4.2.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,e,t){return n+e/Math.pow(10,2*t)})})),tr.maxKey=Ge(tr.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(We(qe,function(n){ar||(n=new CustomEvent(Fe,{detail:n}),ar=!0,dispatchEvent(n),ar=!1)}),addEventListener(Fe,function(n){n=n.detail,ar||rr(n)}));var or,ar=!1,ir=function(){};return"undefined"!=typeof BroadcastChannel&&((ir=function(){(or=new BroadcastChannel(Fe)).onmessage=function(n){return n.data&&rr(n.data)}})(),"function"==typeof or.unref&&or.unref(),We(qe,function(n){ar||or.postMessage(n)})),"undefined"!=typeof addEventListener&&(addEventListener("pagehide",function(n){if(!Qt.disableBfCache&&n.persisted){on&&console.debug("Dexie: handling persisted pagehide"),null!=or&&or.close();for(var e=0,t=ee;e<t.length;e++)t[e].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Qt.disableBfCache&&n.persisted&&(on&&console.debug("Dexie: handling persisted pageshow"),ir(),rr({all:new yt(-1/0,[[]])}))})),kn.rejectionMapper=function(n,e){return!n||n instanceof q||n instanceof TypeError||n instanceof SyntaxError||!n.name||!H[n.name]?n:(e=new H[n.name](e||n.message,n),"stack"in n&&h(e,"stack",{get:function(){return this.inner.stack}}),e)},an(on),e(Qt,Object.freeze({__proto__:null,Dexie:Qt,liveQuery:er,Entity:se,cmp:ue,PropModification:Ee,replacePrefix:function(n,e){return new Ee({replacePrefix:[n,e]})},add:function(n){return new Ee({add:n})},remove:function(n){return new Ee({remove:n})},default:Qt,RangeSet:yt,mergeRanges:bt,rangesOverlap:wt}),{default:Qt}),Qt}()},825:n=>{"use strict";n.exports=function(n){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=n.insertStyleElement(n);return{update:function(t){!function(n,e,t){var r="";t.supports&&(r+="@supports (".concat(t.supports,") {")),t.media&&(r+="@media ".concat(t.media," {"));var o=void 0!==t.layer;o&&(r+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),r+=t.css,o&&(r+="}"),t.media&&(r+="}"),t.supports&&(r+="}");var a=t.sourceMap;a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleTagTransform(r,n,e.options)}(e,n,t)},remove:function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(e)}}}}},e={};function t(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={id:r,exports:{}};return n[r].call(a.exports,a,a.exports,t),a.exports}t.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return t.d(e,{a:e}),e},t.d=(n,e)=>{for(var r in e)t.o(e,r)&&!t.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:e[r]})},t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),t.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),t.nc=void 0,(()=>{"use strict";var n=t(72),e=t.n(n),r=t(825),o=t.n(r),a=t(659),i=t.n(a),c=t(56),s=t.n(c),u=t(540),l=t.n(u),d=t(113),f=t.n(d),h=t(208),p={};p.styleTagTransform=f(),p.setAttributes=s(),p.insert=i().bind(null,"head"),p.domAPI=o(),p.insertStyleElement=l(),e()(h.A,p),h.A&&h.A.locals&&h.A.locals;var m=t(744);const v=Symbol.for("Dexie"),y=globalThis[v]||(globalThis[v]=m);if(m.semVer!==y.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${m.semVer} and ${y.semVer}`);const{liveQuery:g,mergeRanges:b,rangesOverlap:w,RangeSet:x,cmp:k,Entity:_,PropModification:E,replacePrefix:S,add:D,remove:O,DexieYProvider:T}=y;function P(n){var e=new Date(n),t=e.getDay(),r=e.getDate()-t+(0===t?-6:1),o=new Date(e.setDate(r));return o.setHours(0,0,0,0),o}function j(n){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},j(n)}function C(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var r,o,a,i,c=[],s=!0,u=!1;try{if(a=(t=t.call(n)).next,0===e){if(Object(t)!==t)return;s=!1}else for(;!(s=(r=a.call(t)).done)&&(c.push(r.value),c.length!==e);s=!0);}catch(n){u=!0,o=n}finally{try{if(!s&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(n,e)||function(n,e){if(n){if("string"==typeof n)return N(n,e);var t={}.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?N(n,e):void 0}}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function A(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),t.push.apply(t,r)}return t}function M(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?A(Object(t),!0).forEach(function(e){L(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):A(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}function L(n,e,t){return(e=F(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function I(){var n,e,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function a(t,r,o,a){var s=r&&r.prototype instanceof c?r:c,u=Object.create(s.prototype);return B(u,"_invoke",function(t,r,o){var a,c,s,u=0,l=o||[],d=!1,f={p:0,n:0,v:n,a:h,f:h.bind(n,4),d:function(e,t){return a=e,c=0,s=n,f.n=t,i}};function h(t,r){for(c=t,s=r,e=0;!d&&u&&!o&&e<l.length;e++){var o,a=l[e],h=f.p,p=a[2];t>3?(o=p===r)&&(s=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=n):a[0]<=h&&((o=t<2&&h<a[1])?(c=0,f.v=r,f.n=a[1]):h<p&&(o=t<3||a[0]>r||r>p)&&(a[4]=t,a[5]=r,f.n=p,c=0))}if(o||t>1)return i;throw d=!0,r}return function(o,l,p){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&h(l,p),c=l,s=p;(e=c<2?n:s)||!d;){a||(c?c<3?(c>1&&(f.n=-1),h(c,s)):f.n=s:f.v=s);try{if(u=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=n}else if((e=(d=f.n<0)?s:t.call(r,f))!==i)break}catch(e){a=n,c=1,s=e}finally{u=1}}return{value:e,done:d}}}(t,o,a),!0),u}var i={};function c(){}function s(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(B(e={},r,function(){return this}),e),d=u.prototype=c.prototype=Object.create(l);function f(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,u):(n.__proto__=u,B(n,o,"GeneratorFunction")),n.prototype=Object.create(d),n}return s.prototype=u,B(d,"constructor",u),B(u,"constructor",s),s.displayName="GeneratorFunction",B(u,o,"GeneratorFunction"),B(d),B(d,o,"Generator"),B(d,r,function(){return this}),B(d,"toString",function(){return"[object Generator]"}),(I=function(){return{w:a,m:f}})()}function B(n,e,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}B=function(n,e,t,r){function a(e,t){B(n,e,function(n){return this._invoke(e,t,n)})}e?o?o(n,e,{value:t,enumerable:!r,configurable:!r,writable:!r}):n[e]=t:(a("next",0),a("throw",1),a("return",2))},B(n,e,t,r)}function R(n,e,t,r,o,a,i){try{var c=n[a](i),s=c.value}catch(n){return void t(n)}c.done?e(s):Promise.resolve(s).then(r,o)}function K(n){return function(){var e=this,t=arguments;return new Promise(function(r,o){var a=n.apply(e,t);function i(n){R(a,r,o,i,c,"next",n)}function c(n){R(a,r,o,i,c,"throw",n)}i(void 0)})}}function q(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,F(r.key),r)}}function F(n){var e=function(n){if("object"!=j(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var t=e.call(n,"string");if("object"!=j(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==j(e)?e:e+""}function W(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(W=function(){return!!n})()}function Y(n){return Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Y(n)}function z(n,e){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,e){return n.__proto__=e,n},z(n,e)}var V="today",U="yesterday",H="thisWeek",G="thisMonth",$="thisYear";function Q(n){var e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate());switch(n){case V:return{start:new Date(t),end:new Date(t.getTime()+864e5)};case U:var r=new Date(t);return r.setDate(t.getDate()-1),{start:r,end:new Date(t)};case H:var o=P(e),a=new Date(o);return a.setDate(o.getDate()+7),{start:o,end:a};case"lastWeek":var i=P(e);i.setDate(i.getDate()-7);var c=new Date(i);return c.setDate(i.getDate()+7),{start:i,end:c};case G:return{start:new Date(e.getFullYear(),e.getMonth(),1),end:new Date(e.getFullYear(),e.getMonth()+1,1)};case"lastMonth":return{start:new Date(e.getFullYear(),e.getMonth()-1,1),end:new Date(e.getFullYear(),e.getMonth(),1)};case $:return{start:new Date(e.getFullYear(),0,1),end:new Date(e.getFullYear()+1,0,1)};case"last7Days":var s=new Date(e);return s.setDate(e.getDate()-7),{start:s,end:e};case"last30Days":var u=new Date(e);return u.setDate(e.getDate()-30),{start:u,end:e};default:throw new Error("Неизвестный тип диапазона: ".concat(n))}}var X=function(n){function e(){var n;return function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(n,e,t){return e=Y(e),function(n,e){if(e&&("object"==j(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n)}(n,W()?Reflect.construct(e,t||[],Y(n).constructor):e.apply(n,t))}(this,e,["TimeArchive"])).version(1).stores({notes:"++id, date, content, tags"}),n.notes=n.table("notes"),n}return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&z(n,e)}(e,n),t=e,r=[{key:"addNote",value:(L=K(I().m(function n(e){var t,r,o,a,i=arguments;return I().w(function(n){for(;;)switch(n.p=n.n){case 0:return t=i.length>1&&void 0!==i[1]?i[1]:[],n.p=1,r={content:e.trim(),tags:Array.isArray(t)?t:[],date:new Date},n.n=2,this.notes.add(r);case 2:return o=n.v,console.log("Запись добавлена с ID: ".concat(o)),n.a(2,o);case 3:throw n.p=3,a=n.v,console.error("Ошибка при добавлении записи:",a),a;case 4:return n.a(2)}},n,this,[[1,3]])})),function(n){return L.apply(this,arguments)})},{key:"getNotesByDateRange",value:(A=K(I().m(function n(e,t){var r,o,a,i=arguments;return I().w(function(n){for(;;)switch(n.p=n.n){case 0:return r=!(i.length>2&&void 0!==i[2])||i[2],o=i.length>3&&void 0!==i[3]&&i[3],n.p=1,n.n=2,this.notes.where("date").between(e,t,r,o).reverse().toArray();case 2:return n.a(2,n.v);case 3:throw n.p=3,a=n.v,console.error("Ошибка получения записей по диапазону:",a),a;case 4:return n.a(2)}},n,this,[[1,3]])})),function(n,e){return A.apply(this,arguments)})},{key:"getTodayNotes",value:(N=K(I().m(function n(){var e,t,r;return I().w(function(n){for(;;)switch(n.n){case 0:return e=Q(V),t=e.start,r=e.end,n.n=1,this.getNotesByDateRange(t,r,!0,!1);case 1:return n.a(2,n.v)}},n,this)})),function(){return N.apply(this,arguments)})},{key:"getYesterdayNotes",value:(T=K(I().m(function n(){var e,t,r;return I().w(function(n){for(;;)switch(n.n){case 0:return e=Q(U),t=e.start,r=e.end,n.n=1,this.getNotesByDateRange(t,r,!0,!1);case 1:return n.a(2,n.v)}},n,this)})),function(){return T.apply(this,arguments)})},{key:"searchNotes",value:(O=K(I().m(function n(e){var t,r,o,a,i,c,s,u,l,d,f,h,p,m,v,y,g,b,w,x,k=arguments;return I().w(function(n){for(;;)switch(n.n){case 0:if(t=k.length>1&&void 0!==k[1]?k[1]:{},e&&0!==e.trim().length){n.n=1;break}return n.a(2,[]);case 1:return r=t.caseSensitive,o=void 0!==r&&r,a=t.searchInContent,i=void 0===a||a,c=t.searchInTags,s=void 0===c||c,u=t.exactMatch,l=void 0!==u&&u,d=t.limit,f=void 0===d?100:d,h=t.dateFrom,p=void 0===h?null:h,m=t.dateTo,v=void 0===m?null:m,y=o?e.trim():e.trim().toLowerCase(),g=this.notes.toCollection(),(p||v)&&(b=p||new Date("1970-01-01"),w=v||new Date("2099-12-31"),g=this.notes.where("date").between(b,w,!0,!0)),n.n=2,g.filter(function(n){var e=!1,t=!1;if(i){var r=o?n.content:n.content.toLowerCase();e=l?r===y:r.includes(y)}return s&&n.tags.length>0&&(t=n.tags.some(function(n){var e=o?n:n.toLowerCase();return l?e===y:e.includes(y)})),e||t}).reverse().limit(f).toArray();case 2:return x=n.v,n.a(2,x)}},n,this)})),function(n){return O.apply(this,arguments)})},{key:"searchByTags",value:(D=K(I().m(function n(e){var t,r,o=arguments;return I().w(function(n){for(;;)switch(n.n){case 0:if(t=o.length>1&&void 0!==o[1]&&o[1],Array.isArray(e)&&0!==e.length){n.n=1;break}return n.a(2,[]);case 1:return r=e.map(function(n){return n.startsWith("#")?n.toLowerCase():"#".concat(n.toLowerCase())}),n.n=2,this.notes.filter(function(n){if(!n.tags||0===n.tags.length)return!1;var e=n.tags.map(function(n){return n.toLowerCase()});return t?r.every(function(n){return e.includes(n)}):r.some(function(n){return e.includes(n)})}).reverse().toArray();case 2:return n.a(2,n.v)}},n,this)})),function(n){return D.apply(this,arguments)})},{key:"searchNotesStartsWith",value:(S=K(I().m(function n(e){var t,r,o=arguments;return I().w(function(n){for(;;)switch(n.n){case 0:if(t=o.length>1&&void 0!==o[1]?o[1]:"content",e&&0!==e.trim().length){n.n=1;break}return n.a(2,[]);case 1:return r=e.trim().toLowerCase(),n.n=2,this.notes.filter(function(n){return"content"===t?n.content.toLowerCase().startsWith(r):"tags"===t&&n.tags.some(function(n){return n.toLowerCase().startsWith(r)})}).reverse().toArray();case 2:return n.a(2,n.v)}},n,this)})),function(n){return S.apply(this,arguments)})},{key:"fullTextSearch",value:(E=K(I().m(function n(e){var t,r,o,a,i,c,s,u,l,d,f,h=this,p=arguments;return I().w(function(n){for(;;)switch(n.n){case 0:if(r=(t=p.length>1&&void 0!==p[1]?p[1]:{}).highlightMatches,o=void 0!==r&&r,a=t.minWordLength,i=void 0===a?2:a,c=t.stopWords,s=void 0===c?["и","в","на","с","по","для","от","к","до","из"]:c,u=t.limit,l=void 0===u?50:u,e&&!(e.trim().length<i)){n.n=1;break}return n.a(2,[]);case 1:if(0!==(d=e.trim().toLowerCase().split(/\s+/).filter(function(n){return n.length>=i&&!s.includes(n)})).length){n.n=2;break}return n.a(2,[]);case 2:return n.n=3,this.notes.filter(function(n){var e=n.content.toLowerCase(),t=n.tags.join(" ").toLowerCase(),r="".concat(e," ").concat(t);return d.every(function(n){return r.includes(n)})}).reverse().limit(l).toArray();case 3:if(f=n.v,!o){n.n=4;break}return n.a(2,f.map(function(n){return M(M({},n),{},{highlightedContent:h.highlightMatches(n.content,d),highlightedTags:n.tags.map(function(n){return h.highlightMatches(n,d)})})}));case 4:return n.a(2,f)}},n,this)})),function(n){return E.apply(this,arguments)})},{key:"highlightMatches",value:function(n,e){var t=n;return e.forEach(function(n){var e=new RegExp("(".concat(n,")"),"gi");t=t.replace(e,"<mark>$1</mark>")}),t}},{key:"advancedSearch",value:(_=K(I().m(function n(e){var t,r,o,a,i,c,s,u,l,d,f,h,p,m,v,y,g,b,w,x,k,_,E=this;return I().w(function(n){for(;;)switch(n.n){case 0:return t=e.text,r=void 0===t?"":t,o=e.tags,a=void 0===o?[]:o,i=e.dateFrom,c=void 0===i?null:i,s=e.dateTo,u=void 0===s?null:s,e.hasAttachments,l=e.minLength,d=void 0===l?null:l,f=e.maxLength,h=void 0===f?null:f,p=e.sortBy,m=void 0===p?"date":p,v=e.sortOrder,y=void 0===v?"desc":v,g=e.limit,b=void 0===g?100:g,w=this.notes.toCollection(),(c||u)&&(x=c||new Date("1970-01-01"),k=u||new Date("2099-12-31"),w=this.notes.where("date").between(x,k,!0,!0)),n.n=1,w.filter(function(n){return!(r&&!n.content.toLowerCase().includes(r.toLowerCase())||a.length>0&&!a.some(function(e){return n.tags.some(function(n){return n.toLowerCase().includes(e.toLowerCase())})})||null!==d&&n.content.length<d||null!==h&&n.content.length>h)}).toArray();case 1:return _=n.v,"date"===m?_.sort(function(n,e){var t=new Date(n.date),r=new Date(e.date);return"desc"===y?r-t:t-r}):"relevance"===m&&r&&_.sort(function(n,e){var t=E.calculateRelevance(n,r),o=E.calculateRelevance(e,r);return"desc"===y?o-t:t-o}),n.a(2,_.slice(0,b))}},n,this)})),function(n){return _.apply(this,arguments)})},{key:"calculateRelevance",value:function(n,e){var t=n.content.toLowerCase(),r=e.toLowerCase(),o=0;return t.includes(r)&&(o+=10),t.startsWith(r)&&(o+=5),n.tags.some(function(n){return n.toLowerCase().includes(r)})&&(o+=8),o}},{key:"getPopularTags",value:(k=K(I().m(function n(){var e,t,r,o=arguments;return I().w(function(n){for(;;)switch(n.n){case 0:return e=o.length>0&&void 0!==o[0]?o[0]:20,n.n=1,this.notes.toArray();case 1:return t=n.v,r={},t.forEach(function(n){n.tags.forEach(function(n){r[n]=(r[n]||0)+1})}),n.a(2,Object.entries(r).sort(function(n,e){var t=C(n,2)[1];return C(e,2)[1]-t}).slice(0,e).map(function(n){var e=C(n,2);return{tag:e[0],count:e[1]}}))}},n,this)})),function(){return k.apply(this,arguments)})},{key:"getTagSuggestions",value:(x=K(I().m(function n(e){var t,r,o,a=arguments;return I().w(function(n){for(;;)switch(n.n){case 0:if(t=a.length>1&&void 0!==a[1]?a[1]:10,e&&!(e.length<1)){n.n=2;break}return n.n=1,this.getPopularTags(t);case 1:return n.a(2,n.v);case 2:return n.n=3,this.notes.toArray();case 3:return r=n.v,o=new Set,r.forEach(function(n){n.tags.forEach(function(n){n.toLowerCase().startsWith(e.toLowerCase())&&o.add(n)})}),n.a(2,Array.from(o).slice(0,t))}},n,this)})),function(n){return x.apply(this,arguments)})},{key:"saveSearchHistory",value:(w=K(I().m(function n(e,t){var r;return I().w(function(n){for(;;)switch(n.n){case 0:r={query:e,resultsCount:t,timestamp:new Date},console.log("Поиск сохранён в историю:",r);case 1:return n.a(2)}},n)})),function(n,e){return w.apply(this,arguments)})},{key:"getAllNotes",value:(b=K(I().m(function n(){return I().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,this.notes.reverse().toArray();case 1:return n.a(2,n.v)}},n,this)})),function(){return b.apply(this,arguments)})},{key:"getThisWeekNotes",value:(g=K(I().m(function n(){var e,t,r;return I().w(function(n){for(;;)switch(n.n){case 0:return e=Q(H),t=e.start,r=e.end,n.n=1,this.getNotesByDateRange(t,r,!0,!1);case 1:return n.a(2,n.v)}},n,this)})),function(){return g.apply(this,arguments)})},{key:"getWeekNotes",value:(y=K(I().m(function n(e){var t,r;return I().w(function(n){for(;;)switch(n.n){case 0:return t=e||P(new Date),(r=new Date(t)).setDate(t.getDate()+7),n.n=1,this.getNotesByDateRange(t,r,!0,!1);case 1:return n.a(2,n.v)}},n,this)})),function(n){return y.apply(this,arguments)})},{key:"getThisMonthNotes",value:(v=K(I().m(function n(){var e,t,r;return I().w(function(n){for(;;)switch(n.n){case 0:return e=Q(G),t=e.start,r=e.end,n.n=1,this.getNotesByDateRange(t,r,!0,!1);case 1:return n.a(2,n.v)}},n,this)})),function(){return v.apply(this,arguments)})},{key:"getMonthNotes",value:(m=K(I().m(function n(e,t){var r,o;return I().w(function(n){for(;;)switch(n.n){case 0:return r=new Date(e,t,1),o=new Date(e,t+1,1),n.n=1,this.getNotesByDateRange(r,o,!0,!1);case 1:return n.a(2,n.v)}},n,this)})),function(n,e){return m.apply(this,arguments)})},{key:"getThisYearNotes",value:(p=K(I().m(function n(){var e,t,r;return I().w(function(n){for(;;)switch(n.n){case 0:return e=Q($),t=e.start,r=e.end,n.n=1,this.getNotesByDateRange(t,r,!0,!1);case 1:return n.a(2,n.v)}},n,this)})),function(){return p.apply(this,arguments)})},{key:"getYearNotes",value:(h=K(I().m(function n(){var e,t,r,o=arguments;return I().w(function(n){for(;;)switch(n.n){case 0:return e=(o.length>0&&void 0!==o[0]?o[0]:null)||(new Date).getFullYear(),t=new Date(e,0,1),r=new Date(e+1,0,1),n.n=1,this.getNotesByDateRange(t,r,!0,!1);case 1:return n.a(2,n.v)}},n,this)})),function(){return h.apply(this,arguments)})},{key:"getLastNDaysNotes",value:(f=K(I().m(function n(e){var t,r;return I().w(function(n){for(;;)switch(n.n){case 0:return t=new Date,(r=new Date).setDate(t.getDate()-e),n.n=1,this.getNotesByDateRange(r,t,!0,!0);case 1:return n.a(2,n.v)}},n,this)})),function(n){return f.apply(this,arguments)})},{key:"getLastNWeeksNotes",value:(d=K(I().m(function n(e){var t,r;return I().w(function(n){for(;;)switch(n.n){case 0:return t=new Date,(r=new Date).setDate(t.getDate()-7*e),n.n=1,this.getNotesByDateRange(r,t,!0,!0);case 1:return n.a(2,n.v)}},n,this)})),function(n){return d.apply(this,arguments)})},{key:"getLastNMonthsNotes",value:(l=K(I().m(function n(e){var t,r;return I().w(function(n){for(;;)switch(n.n){case 0:return t=new Date,(r=new Date).setMonth(t.getMonth()-e),n.n=1,this.getNotesByDateRange(r,t,!0,!0);case 1:return n.a(2,n.v)}},n,this)})),function(n){return l.apply(this,arguments)})},{key:"getNotesFromDate",value:(u=K(I().m(function n(e){return I().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,this.notes.where("date").aboveOrEqual(e).reverse().toArray();case 1:return n.a(2,n.v)}},n,this)})),function(n){return u.apply(this,arguments)})},{key:"getNotesBeforeDate",value:(s=K(I().m(function n(e){return I().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,this.notes.where("date").below(e).reverse().toArray();case 1:return n.a(2,n.v)}},n,this)})),function(n){return s.apply(this,arguments)})},{key:"getNotesStats",value:(c=K(I().m(function n(){var e,t,r,o,a=arguments;return I().w(function(n){for(;;)switch(n.n){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:null,n.n=1,this.getYearNotes(e);case 1:for(t=n.v,r={},o=0;o<12;o++)r[o]=0;return t.forEach(function(n){var e=n.date.getMonth();r[e]++}),n.a(2,{totalNotes:t.length,monthlyStats:r,allNotes:t})}},n,this)})),function(){return c.apply(this,arguments)})},{key:"getDailyStats",value:(i=K(I().m(function n(e,t){var r,o;return I().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,this.getNotesByDateRange(e,t,!0,!0);case 1:return r=n.v,o={},r.forEach(function(n){var e=n.date.toISOString().split("T")[0];o[e]||(o[e]={date:e,count:0,notes:[]}),o[e].count++,o[e].notes.push(n)}),n.a(2,Object.values(o).sort(function(n,e){return new Date(e.date)-new Date(n.date)}))}},n,this)})),function(n,e){return i.apply(this,arguments)})},{key:"getTagStatsForPeriod",value:(a=K(I().m(function n(e,t){var r,o;return I().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,this.getNotesByDateRange(e,t,!0,!0);case 1:return r=n.v,o={},r.forEach(function(n){n.tags.forEach(function(e){o[e]||(o[e]={tag:e,count:0,notes:[]}),o[e].count++,o[e].notes.push(n)})}),n.a(2,Object.values(o).sort(function(n,e){return e.count-n.count}))}},n,this)})),function(n,e){return a.apply(this,arguments)})},{key:"getNotesPaginated",value:(o=K(I().m(function n(){var e,t,r,o,a,i=arguments;return I().w(function(n){for(;;)switch(n.n){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:0,t=i.length>1&&void 0!==i[1]?i[1]:20,r=i.length>2&&void 0!==i[2]?i[2]:null,o=i.length>3&&void 0!==i[3]?i[3]:null,a=this.notes.orderBy("date").reverse(),r&&o&&(a=this.notes.where("date").between(r,o,!0,!1).reverse()),n.n=1,a.offset(e).limit(t).toArray();case 1:return n.a(2,n.v)}},n,this)})),function(){return o.apply(this,arguments)})},{key:"formatDateRange",value:function(n,e){var t=n.toLocaleDateString("ru-RU"),r=e.toLocaleDateString("ru-RU");return t===r?t:"".concat(t," - ").concat(r)}}],r&&q(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,o,a,i,c,s,u,l,d,f,h,p,m,v,y,g,b,w,x,k,_,E,S,D,O,T,N,A,L}(y),J=new X;function Z(n){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Z(n)}function nn(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var r,o,a,i,c=[],s=!0,u=!1;try{if(a=(t=t.call(n)).next,0===e){if(Object(t)!==t)return;s=!1}else for(;!(s=(r=a.call(t)).done)&&(c.push(r.value),c.length!==e);s=!0);}catch(n){u=!0,o=n}finally{try{if(!s&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(n,e)||en(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function en(n,e){if(n){if("string"==typeof n)return tn(n,e);var t={}.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?tn(n,e):void 0}}function tn(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function rn(){var n,e,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function a(t,r,o,a){var s=r&&r.prototype instanceof c?r:c,u=Object.create(s.prototype);return on(u,"_invoke",function(t,r,o){var a,c,s,u=0,l=o||[],d=!1,f={p:0,n:0,v:n,a:h,f:h.bind(n,4),d:function(e,t){return a=e,c=0,s=n,f.n=t,i}};function h(t,r){for(c=t,s=r,e=0;!d&&u&&!o&&e<l.length;e++){var o,a=l[e],h=f.p,p=a[2];t>3?(o=p===r)&&(s=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=n):a[0]<=h&&((o=t<2&&h<a[1])?(c=0,f.v=r,f.n=a[1]):h<p&&(o=t<3||a[0]>r||r>p)&&(a[4]=t,a[5]=r,f.n=p,c=0))}if(o||t>1)return i;throw d=!0,r}return function(o,l,p){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&h(l,p),c=l,s=p;(e=c<2?n:s)||!d;){a||(c?c<3?(c>1&&(f.n=-1),h(c,s)):f.n=s:f.v=s);try{if(u=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=n}else if((e=(d=f.n<0)?s:t.call(r,f))!==i)break}catch(e){a=n,c=1,s=e}finally{u=1}}return{value:e,done:d}}}(t,o,a),!0),u}var i={};function c(){}function s(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(on(e={},r,function(){return this}),e),d=u.prototype=c.prototype=Object.create(l);function f(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,u):(n.__proto__=u,on(n,o,"GeneratorFunction")),n.prototype=Object.create(d),n}return s.prototype=u,on(d,"constructor",u),on(u,"constructor",s),s.displayName="GeneratorFunction",on(u,o,"GeneratorFunction"),on(d),on(d,o,"Generator"),on(d,r,function(){return this}),on(d,"toString",function(){return"[object Generator]"}),(rn=function(){return{w:a,m:f}})()}function on(n,e,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}on=function(n,e,t,r){function a(e,t){on(n,e,function(n){return this._invoke(e,t,n)})}e?o?o(n,e,{value:t,enumerable:!r,configurable:!r,writable:!r}):n[e]=t:(a("next",0),a("throw",1),a("return",2))},on(n,e,t,r)}function an(n,e,t,r,o,a,i){try{var c=n[a](i),s=c.value}catch(n){return void t(n)}c.done?e(s):Promise.resolve(s).then(r,o)}function cn(n){return function(){var e=this,t=arguments;return new Promise(function(r,o){var a=n.apply(e,t);function i(n){an(a,r,o,i,c,"next",n)}function c(n){an(a,r,o,i,c,"throw",n)}i(void 0)})}}function sn(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,un(r.key),r)}}function un(n){var e=function(n){if("object"!=Z(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var t=e.call(n,"string");if("object"!=Z(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==Z(e)?e:e+""}var ln,dn,fn=function(){return n=function n(){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.currentView="today",this.currentWeekStart=null,this.currentMonth=(new Date).getMonth(),this.currentYear=(new Date).getFullYear(),this.init()},e=[{key:"init",value:function(){console.log("Инициализация ViewManager..."),this.initNavigation(),this.initNavigationArrows(),this.setupEventListeners()}},{key:"initNavigation",value:function(){var n=this,e=document.querySelectorAll(".nav-button");0!==e.length?(console.log("Найдено ".concat(e.length," кнопок навигации")),e.forEach(function(e,t){var r=e.dataset.view;r?(e.addEventListener("click",function(e){e.preventDefault(),console.log("Переключение на вид: ".concat(r)),n.switchView(r)}),e.addEventListener("keydown",function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),n.switchView(r))})):console.warn("Кнопка ".concat(t," не имеет data-view атрибута"))})):console.error("Кнопки навигации не найдены!")}},{key:"switchView",value:(b=cn(rn().m(function n(e){var t;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:if(console.log("Переключение на вид: ".concat(e)),n.p=1,this.hideAllViews(),this.deactivateAllNavButtons(),this.showView(e)){n.n=2;break}return console.error("Вид ".concat(e," не найден!")),n.a(2);case 2:return this.activateNavButton(e),this.currentView=e,n.n=3,this.loadViewData(e);case 3:console.log("Успешно переключились на вид: ".concat(e)),n.n=5;break;case 4:n.p=4,t=n.v,console.error("Ошибка при переключении на вид ".concat(e,":"),t);case 5:return n.a(2)}},n,this,[[1,4]])})),function(n){return b.apply(this,arguments)})},{key:"hideAllViews",value:function(){document.querySelectorAll("[data-view-content]").forEach(function(n){n.hidden=!0,n.style.display="none"})}},{key:"showView",value:function(n){var e=document.querySelector('[data-view-content="'.concat(n,'"]'));return!!e&&(e.hidden=!1,e.style.display="block",!0)}},{key:"deactivateAllNavButtons",value:function(){document.querySelectorAll(".nav-button").forEach(function(n){n.classList.remove("active"),n.setAttribute("aria-selected","false")})}},{key:"activateNavButton",value:function(n){var e=document.querySelector('[data-view="'.concat(n,'"]'));e&&(e.classList.add("active"),e.setAttribute("aria-selected","true"))}},{key:"loadViewData",value:(g=cn(rn().m(function n(e){var t,r;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:console.log("Загрузка данных для вида: ".concat(e)),n.p=1,t=e,n.n="today"===t?2:"week"===t?4:"month"===t?6:"year"===t?8:"search"===t?10:11;break;case 2:return n.n=3,this.loadTodayView();case 3:return n.a(3,12);case 4:return n.n=5,this.loadWeekView();case 5:return n.a(3,12);case 6:return n.n=7,this.loadMonthView();case 7:return n.a(3,12);case 8:return n.n=9,this.loadYearView();case 9:return n.a(3,12);case 10:return this.setupSearch(),n.a(3,12);case 11:console.warn("Неизвестный вид: ".concat(e));case 12:n.n=14;break;case 13:n.p=13,r=n.v,console.error("Ошибка загрузки вида ".concat(e,":"),r),this.showError('Ошибка загрузки данных для вида "'.concat(e,'"'));case 14:return n.a(2)}},n,this,[[1,13]])})),function(n){return g.apply(this,arguments)})},{key:"loadTodayView",value:(y=cn(rn().m(function n(){var e,t,r,o;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:return console.log('Загрузка вида "Сегодня"...'),n.p=1,n.n=2,J.getTodayNotes();case 2:if(e=n.v,console.log("Найдено записей за сегодня: ".concat(e.length)),t=e.slice(0,10),this.updateRecentNotesList(t),"function"!=typeof J.getYesterdayNotes){n.n=4;break}return n.n=3,J.getYesterdayNotes();case 3:(r=n.v).length>0&&this.showYesterdayNotes(r.slice(0,5));case 4:n.n=6;break;case 5:n.p=5,o=n.v,console.error('Ошибка загрузки вида "Сегодня":',o),this.showError("Не удалось загрузить записи за сегодня");case 6:return n.a(2)}},n,this,[[1,5]])})),function(){return y.apply(this,arguments)})},{key:"updateRecentNotesList",value:function(n){var e=this,t=document.getElementById("recent-notes-list");if(t)if(0!==n.length){var r=n.map(function(n){return e.createNoteHTML(n)}).join("");t.innerHTML='\n      <div class="notes-header">\n        <h4>Последние записи ('.concat(n.length,')</h4>\n        <div class="export-buttons-group">\n          <button class="export-button compact" id="export-today-btn" title="Скопировать записи за сегодня">\n            📋 Копировать\n          </button>\n          <button class="download-button compact" id="download-today-btn" title="Скачать записи за сегодня как .txt">\n            📥 Скачать\n          </button>\n        </div>\n      </div>\n      <div class="notes-list">\n        ').concat(r,"\n      </div>\n    "),console.log("Отображено ".concat(n.length," записей"));var o=document.getElementById("export-today-btn");o&&o.addEventListener("click",cn(rn().m(function n(){var t;return rn().w(function(n){for(;;)switch(n.n){case 0:return o.disabled=!0,o.textContent="⏳",n.n=1,e.exportTodayNotes();case 1:t=n.v,e.showExportNotification(t,!1),o.disabled=!1,o.textContent="📋 Копировать";case 2:return n.a(2)}},n)})));var a=document.getElementById("download-today-btn");a&&a.addEventListener("click",cn(rn().m(function n(){var t;return rn().w(function(n){for(;;)switch(n.n){case 0:return a.disabled=!0,a.textContent="⏳",n.n=1,e.downloadTodayNotes();case 1:t=n.v,e.showExportNotification(t,!0),a.disabled=!1,a.textContent="📥 Скачать";case 2:return n.a(2)}},n)})))}else t.innerHTML='\n        <div class="empty-state">\n          <p>📝 Пока записей нет</p>\n          <p>Начни документировать свои страдания!</p>\n        </div>\n      ';else console.error("Контейнер recent-notes-list не найден!")}},{key:"showYesterdayNotes",value:function(n){var e=this,t=document.getElementById("recent-notes-list");if(t&&0!==n.length){var r='\n      <div class="yesterday-notes">\n        <h4>Вчера ('.concat(n.length,')</h4>\n        <div class="notes-list">\n          ').concat(n.map(function(n){return e.createNoteHTML(n)}).join(""),"\n        </div>\n      </div>\n    ");t.insertAdjacentHTML("beforeend",r)}}},{key:"createNoteHTML",value:function(n){var e,t=new Date(n.date),r=new Date;e=this.isSameDay(t,r)?t.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}):t.toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"});var o=n.tags.length>0?'<div class="note-tags">'.concat(n.tags.join(" "),"</div>"):"",a=n.content.length>200?n.content.substring(0,200)+"...":n.content;return'\n      <div class="note-item" data-note-id="'.concat(n.id,'" title="Запись от ').concat(t.toLocaleString("ru-RU"),'">\n        <div class="note-header">\n          <span class="note-time">').concat(e,'</span>\n          <span class="note-id">#').concat(n.id,'</span>\n        </div>\n        <div class="note-content">').concat(this.escapeHtml(a),"</div>\n        ").concat(o,"\n      </div>\n    ")}},{key:"loadWeekView",value:(v=cn(rn().m(function n(){var e,t;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:return console.log("Загрузка недельного вида..."),n.p=1,this.currentWeekStart||(this.currentWeekStart=this.getWeekStart(new Date)),n.n=2,J.getWeekNotes(this.currentWeekStart);case 2:e=n.v,console.log("Найдено записей за неделю: ".concat(e.length)),this.updateWeekView(e),n.n=4;break;case 3:n.p=3,t=n.v,console.error("Ошибка загрузки недельного вида:",t),this.showError("Не удалось загрузить записи за неделю");case 4:return n.a(2)}},n,this,[[1,3]])})),function(){return v.apply(this,arguments)})},{key:"updateWeekView",value:function(n){var e=this,t=document.getElementById("week-notes-list"),r=document.getElementById("week-title");if(t&&r){var o=new Date(this.currentWeekStart);o.setDate(o.getDate()+6);var a=this.currentWeekStart.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"}),i=o.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"});if(r.textContent="Неделя ".concat(a," — ").concat(i),0!==n.length){var c=this.groupNotesByDay(n),s=this.getWeekDaysArray(this.currentWeekStart).map(function(n){var t=n.date.toDateString(),r=c[t]||[];return'\n          <div class="week-day '.concat(r.length>0?"has-notes":"",'">\n            <div class="day-header">\n              <h4>').concat(n.name,'</h4>\n              <span class="day-date">').concat(n.date.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"}),"</span>\n              ").concat(r.length>0?'<span class="notes-count">'.concat(r.length,"</span>"):"",'\n            </div>\n            <div class="day-notes">\n              ').concat(r.length>0?r.map(function(n){return e.createCompactNoteHTML(n)}).join(""):'<p class="no-notes">Записей нет</p>',"\n            </div>\n          </div>\n        ")}).join("");t.innerHTML='\n    <div class="week-controls">\n      <div class="export-buttons-group">\n        <button class="export-button" id="export-week-btn" title="Скопировать все записи за неделю в буфер обмена">\n          📋 Скопировать записи ('.concat(n.length,')\n        </button>\n        <button class="download-button" id="download-week-btn" title="Скачать все записи за неделю как .txt файл">\n          📥 Скачать .txt (').concat(n.length,')\n        </button>\n      </div>\n    </div>\n    <div class="week-grid">\n      ').concat(s,'\n    </div>\n    <div class="week-summary">\n      <p>Всего записей за неделю: <strong>').concat(n.length,"</strong></p>\n      <p>Активных дней: <strong>").concat(Object.keys(c).length,"</strong></p>\n    </div>\n  ");var u=document.getElementById("export-week-btn");u&&u.addEventListener("click",cn(rn().m(function t(){var r;return rn().w(function(t){for(;;)switch(t.n){case 0:return u.disabled=!0,u.textContent="⏳ Копирование...",t.n=1,e.exportWeekNotes();case 1:r=t.v,e.showExportNotification(r,!1),u.disabled=!1,u.textContent="📋 Скопировать записи (".concat(n.length,")");case 2:return t.a(2)}},t)})));var l=document.getElementById("download-week-btn");l&&l.addEventListener("click",cn(rn().m(function t(){var r;return rn().w(function(t){for(;;)switch(t.n){case 0:return l.disabled=!0,l.textContent="⏳ Скачивание...",t.n=1,e.downloadWeekNotes();case 1:r=t.v,e.showExportNotification(r,!0),l.disabled=!1,l.textContent="📥 Скачать .txt (".concat(n.length,")");case 2:return t.a(2)}},t)})))}else t.innerHTML='\n        <div class="empty-state">\n          <p>📅 За эту неделю записей нет</p>\n          <p>Время начать документировать!</p>\n        </div>\n      '}else console.error("Контейнеры для недельного вида не найдены!")}},{key:"loadMonthView",value:(m=cn(rn().m(function n(){var e,t;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:return console.log("Загрузка месячного вида..."),n.p=1,n.n=2,J.getMonthNotes(this.currentYear,this.currentMonth);case 2:e=n.v,console.log("Найдено записей за месяц: ".concat(e.length)),this.updateMonthView(e),n.n=4;break;case 3:n.p=3,t=n.v,console.error("Ошибка загрузки месячного вида:",t),this.showError("Не удалось загрузить записи за месяц");case 4:return n.a(2)}},n,this,[[1,3]])})),function(){return m.apply(this,arguments)})},{key:"updateMonthView",value:function(n){var e=this,t=document.getElementById("month-calendar-grid"),r=document.getElementById("month-title");if(t&&r){r.textContent="".concat(["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"][this.currentMonth]," ").concat(this.currentYear);var o=new Date(this.currentYear,this.currentMonth,1),a=new Date(this.currentYear,this.currentMonth+1,0).getDate(),i=0===o.getDay()?6:o.getDay()-1,c={};n.forEach(function(n){var e=n.date.getDate();c[e]||(c[e]=[]),c[e].push(n)});var s='\n    <div class="month-controls">\n      <div class="export-buttons-group">\n        <button class="export-button" id="export-month-btn" title="Скопировать все записи за месяц в буфер обмена">\n          📋 Экспорт месяца ('.concat(n.length,')\n        </button>\n        <button class="download-button" id="download-month-btn" title="Скачать все записи за месяц как .txt файл">\n          📥 Скачать .txt (').concat(n.length,")\n        </button>\n      </div>\n    </div>\n  ");t.parentElement.insertAdjacentHTML("afterbegin",s),t.innerHTML="",t.className="month-calendar-grid",["Пн","Вт","Ср","Чт","Пт","Сб","Вс"].forEach(function(n){var e=document.createElement("div");e.className="calendar-day-header",e.textContent=n,t.appendChild(e)});for(var u=0;u<i;u++){var l=document.createElement("div");l.className="calendar-day empty",t.appendChild(l)}for(var d=new Date,f=function(n){var r=document.createElement("div");r.className="calendar-day";var o=c[n]?c[n].length:0,a=e.currentYear===d.getFullYear()&&e.currentMonth===d.getMonth()&&n===d.getDate(),i="";o>0&&(r.classList.add("has-notes"),i=o>=5?"high-activity":o>=3?"medium-activity":"low-activity",r.classList.add(i)),a&&r.classList.add("today"),r.innerHTML='\n        <div class="day-number">'.concat(n,"</div>\n        ").concat(o>0?'<div class="notes-indicator">'.concat(o,"</div>"):"","\n      "),o>0&&(r.style.cursor="pointer",r.addEventListener("click",function(){e.showDayNotesModal(e.currentYear,e.currentMonth,n,c[n])})),t.appendChild(r)},h=1;h<=a;h++)f(h);var p=document.getElementById("export-month-btn"),m=document.getElementById("download-month-btn");p&&p.addEventListener("click",cn(rn().m(function t(){var r;return rn().w(function(t){for(;;)switch(t.n){case 0:return p.disabled=!0,p.textContent="⏳ Экспортируем...",t.n=1,e.exportMonthNotes();case 1:r=t.v,e.showExportNotification(r,!1),p.disabled=!1,p.textContent="📋 Экспорт месяца (".concat(n.length,")");case 2:return t.a(2)}},t)}))),m&&m.addEventListener("click",cn(rn().m(function t(){var r;return rn().w(function(t){for(;;)switch(t.n){case 0:return m.disabled=!0,m.textContent="⏳ Скачиваем...",t.n=1,e.downloadMonthNotes();case 1:r=t.v,e.showExportNotification(r,!0),m.disabled=!1,m.textContent="📥 Скачать .txt (".concat(n.length,")");case 2:return t.a(2)}},t)})))}else console.error("Контейнеры для месячного вида не найдены!")}},{key:"loadYearView",value:(p=cn(rn().m(function n(){var e,t;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:return console.log("Загрузка годового вида..."),n.p=1,n.n=2,J.getNotesStats(this.currentYear);case 2:e=n.v,console.log("Статистика за год: ".concat(e.totalNotes," записей")),this.updateYearView(e),n.n=4;break;case 3:n.p=3,t=n.v,console.error("Ошибка загрузки годового вида:",t),this.showError("Не удалось загрузить данные за год");case 4:return n.a(2)}},n,this,[[1,3]])})),function(){return p.apply(this,arguments)})},{key:"updateYearView",value:function(n){var e=this,t=document.getElementById("year-calendar-grid"),r=document.querySelector("#year-view h2");if(t&&r){r.textContent="Годовой архив страданий — ".concat(this.currentYear);var o='\n    <div class="year-controls">\n      <div class="export-buttons-group">\n        <button class="export-button" id="export-year-btn" title="Скопировать все записи за год в буфер обмена">\n          📋 Экспорт года ('.concat(n.totalNotes,')\n        </button>\n        <button class="download-button" id="download-year-btn" title="Скачать все записи за год как .txt файл">\n          📥 Скачать .txt (').concat(n.totalNotes,")\n        </button>\n      </div>\n    </div>\n  ");t.parentElement.insertAdjacentHTML("afterbegin",o),t.innerHTML="",t.className="year-calendar-grid";var a=Math.max.apply(Math,function(n){return function(n){if(Array.isArray(n))return tn(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||en(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object.values(n.monthlyStats)).concat([1]));["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"].forEach(function(r,o){var i=n.monthlyStats[o]||0,c=i/a,s=document.createElement("div");s.className="year-month",i>0&&(s.classList.add("has-notes"),c>=.8?s.classList.add("very-high-activity"):c>=.6?s.classList.add("high-activity"):c>=.4?s.classList.add("medium-activity"):s.classList.add("low-activity")),s.innerHTML='\n        <div class="month-header">\n          <span class="month-name">'.concat(r,'</span>\n          <span class="month-number">').concat(o+1,'</span>\n        </div>\n        <div class="month-count">').concat(i,'</div>\n        <div class="month-bar">\n          <div class="month-bar-fill" style="width: ').concat(100*c,'%"></div>\n        </div>\n      '),s.style.cursor="pointer",s.addEventListener("click",function(){e.currentMonth=o,e.switchView("month")}),s.title="".concat(r," ").concat(e.currentYear,": ").concat(i," записей"),t.appendChild(s)});var i=document.getElementById("export-year-btn"),c=document.getElementById("download-year-btn");i&&i.addEventListener("click",cn(rn().m(function t(){var r;return rn().w(function(t){for(;;)switch(t.n){case 0:return i.disabled=!0,i.textContent="⏳ Собираем архив...",t.n=1,e.exportYearNotes();case 1:r=t.v,e.showExportNotification(r,!1),i.disabled=!1,i.textContent="📋 Экспорт года (".concat(n.totalNotes,")");case 2:return t.a(2)}},t)}))),c&&c.addEventListener("click",cn(rn().m(function t(){var r;return rn().w(function(t){for(;;)switch(t.n){case 0:return c.disabled=!0,c.textContent="⏳ Создаём архив...",t.n=1,e.downloadYearNotes();case 1:r=t.v,e.showExportNotification(r,!0),c.disabled=!1,c.textContent="📥 Скачать .txt (".concat(n.totalNotes,")");case 2:return t.a(2)}},t)})))}else console.error("Контейнеры для годового вида не найдены!")}},{key:"setupSearch",value:function(){var n=this;console.log("Настройка поиска...");var e=document.getElementById("search-input"),t=document.getElementById("search-results-list"),r=document.getElementById("search-suggestions");if(e&&t){var o,a="";this.showSearchSuggestions(),e.addEventListener("input",function(e){clearTimeout(o);var i=e.target.value.trim();if(a=i,i.length>0&&r&&(r.innerHTML=""),0===i.length)return n.showSearchSuggestions(),void(t.innerHTML='\n        <div class="search-placeholder">\n          <p>👆 Начните вводить текст для поиска</p>\n          <p>Поиск происходит автоматически по мере ввода</p>\n        </div>\n      ');1!==i.length?(i.length>=2&&(t.innerHTML='\n        <div class="search-loading">\n          <p>🔍 Поиск "'.concat(n.escapeHtml(i),'"...</p>\n        </div>\n      ')),o=setTimeout(cn(rn().m(function e(){return rn().w(function(e){for(;;)switch(e.n){case 0:if(!(i===a&&i.length>=2)){e.n=1;break}return e.n=1,n.performSearch(i);case 1:return e.a(2)}},e)})),300)):t.innerHTML='\n        <div class="search-placeholder">\n          <p>Введите ещё '.concat(2-i.length," символ...</p>\n        </div>\n      ")}),e.addEventListener("keypress",function(){var e=cn(rn().m(function e(t){var r;return rn().w(function(e){for(;;)switch(e.n){case 0:if("Enter"!==t.key){e.n=1;break}if(clearTimeout(o),!((r=t.target.value.trim()).length>=2)){e.n=1;break}return e.n=1,n.performSearch(r);case 1:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}()),e.addEventListener("focus",function(){0===e.value.length&&n.showSearchSuggestions()}),e.addEventListener("blur",function(){setTimeout(function(){0===e.value.length&&r&&(r.innerHTML="")},200)}),e.focus()}else console.error("Элементы поиска не найдены!")}},{key:"performSearch",value:(h=cn(rn().m(function n(e){var t,r,o,a;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:if(t=document.getElementById("search-results-list"),n.p=1,console.log('Выполняется поиск: "'.concat(e,'"')),r=[],!e.startsWith("#")){n.n=3;break}return o=e.substring(1),n.n=2,J.searchByTags([o],!1);case 2:r=n.v,console.log('Поиск по тегу "'.concat(o,'": найдено ').concat(r.length," записей")),n.n=5;break;case 3:return n.n=4,J.searchNotes(e,{searchInContent:!0,searchInTags:!0,caseSensitive:!1,limit:50});case 4:r=n.v,console.log('Текстовый поиск "'.concat(e,'": найдено ').concat(r.length," записей"));case 5:this.displaySearchResults(r,e),n.n=7;break;case 6:n.p=6,a=n.v,console.error("Ошибка поиска:",a),t.innerHTML='\n      <div class="search-error">\n        <p>❌ Ошибка при выполнении поиска</p>\n        <p>Попробуйте ещё раз или перезагрузите страницу</p>\n        <button onclick="location.reload()" class="retry-button">Перезагрузить</button>\n      </div>\n    ';case 7:return n.a(2)}},n,this,[[1,6]])})),function(n){return h.apply(this,arguments)})},{key:"displaySearchResults",value:function(n,e){var t=this,r=document.getElementById("search-results-list");if(0!==n.length){var o=this.groupSearchResultsByDate(n),a=n.length,i='\n    <div class="search-results-header">\n      <h4>✅ Найдено: '.concat(a,' записей</h4>\n      <p>по запросу <strong>"').concat(this.escapeHtml(e),'"</strong></p>\n      ').concat(a>10?"<p><small>Показаны самые релевантные результаты</small></p>":"","\n    </div>\n  "),c=Object.entries(o).sort(function(n,e){var t=nn(n,1)[0],r=nn(e,1)[0];return new Date(r)-new Date(t)}).map(function(n){var r=nn(n,2),o=r[0],a=r[1],i=new Date(o),c=t.formatSearchDate(i);return'\n        <div class="search-day-group">\n          <h5 class="search-day-header">'.concat(c," (").concat(a.length,')</h5>\n          <div class="search-day-results">\n            ').concat(a.map(function(n){return t.createSearchResultHTML(n,e)}).join(""),"\n          </div>\n        </div>\n      ")}).join("");r.innerHTML=i+c,r.scrollIntoView({behavior:"smooth",block:"start"})}else r.innerHTML='\n      <div class="no-results">\n        <h4>😔 Ничего не найдено</h4>\n        <p>По запросу <strong>"'.concat(this.escapeHtml(e),'"</strong> ничего не найдено</p>\n        <div class="search-tips">\n          <h5>💡 Попробуйте:</h5>\n          <ul>\n            <li>Упростить поисковый запрос</li>\n            <li>Проверить правильность написания</li>\n            <li>Использовать другие ключевые слова</li>\n            <li>Поискать по тегам: <code>#работа</code>, <code>#проект</code></li>\n          </ul>\n        </div>\n      </div>\n    ')}},{key:"groupSearchResultsByDate",value:function(n){var e={};return n.forEach(function(n){var t=n.date.toDateString();e[t]||(e[t]=[]),e[t].push(n)}),e}},{key:"createSearchResultHTML",value:function(n){var e=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=new Date(n.date).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}),o=this.escapeHtml(n.content);if(t&&!t.startsWith("#")){var a=new RegExp("(".concat(this.escapeRegex(t),")"),"gi");o=o.replace(a,"<mark>$1</mark>")}var i=n.tags.map(function(n){if(t.startsWith("#")&&n.toLowerCase().includes(t.substring(1).toLowerCase())){var r=new RegExp("(".concat(e.escapeRegex(t.substring(1)),")"),"gi");return n.replace(r,"<mark>$1</mark>")}return n}),c=i.length>0?'<div class="search-result-tags">'.concat(i.join(" "),"</div>"):"";return'\n    <div class="search-result-item" data-note-id="'.concat(n.id,'">\n      <div class="search-result-header">\n        <span class="search-result-time">').concat(r,'</span>\n        <span class="search-result-id">#').concat(n.id,'</span>\n      </div>\n      <div class="search-result-content">').concat(o,"</div>\n      ").concat(c,"\n    </div>\n  ")}},{key:"showSearchSuggestions",value:(f=cn(rn().m(function n(){var e,t,r,o,a,i=this;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:if(e=document.getElementById("search-suggestions")){n.n=1;break}return n.a(2);case 1:return n.p=1,n.n=2,J.getPopularTags;case 2:if(!n.v){n.n=4;break}return n.n=3,J.getPopularTags(8);case 3:o=n.v,n.n=5;break;case 4:o=[];case 5:(t=o).length>0?(r='\n        <div class="suggestions">\n          <h5>🏷️ Популярные теги:</h5>\n          <div class="tag-suggestions">\n            '.concat(t.map(function(n){var e=n.tag,t=n.count;return'<button class="tag-suggestion" data-tag="'.concat(e,'" title="').concat(t,' записей">\n                ').concat(e,' <span class="tag-count">(').concat(t,")</span>\n              </button>")}).join(""),'\n          </div>\n          <div class="search-examples">\n            <h5>💡 Примеры поиска:</h5>\n            <div class="example-queries">\n              <button class="example-query" data-query="встреча">встреча</button>\n              <button class="example-query" data-query="#баг">#баг</button>\n              <button class="example-query" data-query="проект">проект</button>\n              <button class="example-query" data-query="#важно">#важно</button>\n            </div>\n          </div>\n        </div>\n      '),e.innerHTML=r,e.querySelectorAll(".tag-suggestion").forEach(function(n){n.addEventListener("click",function(n){var e=n.target.dataset.tag||n.target.closest("[data-tag]").dataset.tag,t=document.getElementById("search-input");t.value=e,t.focus(),i.performSearch(e)})}),e.querySelectorAll(".example-query").forEach(function(n){n.addEventListener("click",function(n){var e=n.target.dataset.query,t=document.getElementById("search-input");t.value=e,t.focus(),i.performSearch(e)})})):e.innerHTML='\n        <div class="suggestions">\n          <div class="search-examples">\n            <h5>💡 Как искать:</h5>\n            <ul>\n              <li><strong>По тексту:</strong> просто введите слово или фразу</li>\n              <li><strong>По тегам:</strong> начните с # (например: #работа)</li>\n              <li><strong>Поиск живой:</strong> результаты появляются по мере ввода</li>\n            </ul>\n          </div>\n        </div>\n      ',n.n=7;break;case 6:n.p=6,a=n.v,console.error("Ошибка загрузки подсказок:",a);case 7:return n.a(2)}},n,null,[[1,6]])})),function(){return f.apply(this,arguments)})},{key:"formatSearchDate",value:function(n){var e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),r=new Date(t.getTime()-864e5);if(n>=t)return"🕒 Сегодня";if(n>=r)return"📅 Вчера";var o=Math.floor((t-n)/864e5);return o<=7?"📆 ".concat(o," дней назад"):n.toLocaleDateString("ru-RU",{weekday:"long",day:"numeric",month:"long",year:n.getFullYear()!==e.getFullYear()?"numeric":void 0})}},{key:"escapeRegex",value:function(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}},{key:"copyToClipboard",value:(d=cn(rn().m(function n(e){var t,r,o;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:if(n.p=0,!navigator.clipboard||!navigator.clipboard.writeText){n.n=2;break}return n.n=1,navigator.clipboard.writeText(e);case 1:return n.a(2,{success:!0,method:"modern"});case 2:if(!document.queryCommandSupported||!document.queryCommandSupported("copy")){n.n=3;break}if((t=document.createElement("textarea")).value=e,t.style.position="fixed",t.style.left="-9999px",t.style.top="-9999px",document.body.appendChild(t),t.focus(),t.select(),r=document.execCommand("copy"),document.body.removeChild(t),!r){n.n=3;break}return n.a(2,{success:!0,method:"fallback"});case 3:throw new Error("Clipboard API не поддерживается в этом браузере");case 4:return n.p=4,o=n.v,console.error("Ошибка копирования:",o),n.a(2,{success:!1,error:o.message});case 5:return n.a(2)}},n,null,[[0,4]])})),function(n){return d.apply(this,arguments)})},{key:"formatNotesForExport",value:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!n||0===n.length)return"📋 Архив Потраченного Времени ".concat(e,"\n\nЗаписей не найдено.");var t="📋 Архив Потраченного Времени ".concat(e,"\n")+"Экспортировано: ".concat((new Date).toLocaleString("ru-RU"),"\n")+"Всего записей: ".concat(n.length,"\n")+"".concat("=".repeat(50),"\n\n"),r=this.groupNotesByDay(n),o=t,a=Object.keys(r).sort(function(n,e){return new Date(e)-new Date(n)});a.forEach(function(n,e){var t=r[n],a=new Date(n),i="📅 ".concat(a.toLocaleDateString("ru-RU",{weekday:"long",day:"numeric",month:"long",year:"numeric"})," (").concat(t.length," записей)");o+="".concat(i,"\n").concat("-".repeat(40),"\n"),t.sort(function(n,e){return new Date(n.date)-new Date(e.date)}).forEach(function(n,e){var t=n.date.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}),r=n.tags.length>0?" ".concat(n.tags.join(" ")):"";o+="".concat(e+1,". [").concat(t,"] ").concat(n.content).concat(r,"\n")}),o+="\n"});var i="".concat("=".repeat(50),"\n")+"Создано в Архиве Потраченного Времени\n"+"Всего дней с записями: ".concat(a.length,"\n")+"Общее количество записей: ".concat(n.length);return o+=i}},{key:"exportTodayNotes",value:(l=cn(rn().m(function n(){var e,t,r,o,a;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,J.getTodayNotes();case 1:return e=n.v,t=(new Date).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"}),r=this.formatNotesForExport(e,"- ".concat(t)),n.n=2,this.copyToClipboard(r);case 2:return o=n.v,n.a(2,{success:o.success,count:e.length,period:"сегодня",error:o.error});case 3:return n.p=3,a=n.v,console.error("Ошибка экспорта записей за сегодня:",a),n.a(2,{success:!1,error:a.message})}},n,this,[[0,3]])})),function(){return l.apply(this,arguments)})},{key:"exportWeekNotes",value:(u=cn(rn().m(function n(){var e,t,r,o,a,i;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,this.currentWeekStart||(this.currentWeekStart=this.getWeekStart(new Date)),n.n=1,J.getWeekNotes(this.currentWeekStart);case 1:return e=n.v,(t=new Date(this.currentWeekStart)).setDate(t.getDate()+6),r="- Неделя с ".concat(this.currentWeekStart.toLocaleDateString("ru-RU")," по ").concat(t.toLocaleDateString("ru-RU")),o=this.formatNotesForExport(e,r),n.n=2,this.copyToClipboard(o);case 2:return a=n.v,n.a(2,{success:a.success,count:e.length,period:"неделю",error:a.error});case 3:return n.p=3,i=n.v,console.error("Ошибка экспорта записей за неделю:",i),n.a(2,{success:!1,error:i.message})}},n,this,[[0,3]])})),function(){return u.apply(this,arguments)})},{key:"exportMonthNotes",value:(s=cn(rn().m(function n(){var e,t,r,o,a;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,J.getMonthNotes(this.currentYear,this.currentMonth);case 1:return e=n.v,t="- ".concat(["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"][this.currentMonth]," ").concat(this.currentYear),r=this.formatNotesForExport(e,t),n.n=2,this.copyToClipboard(r);case 2:return o=n.v,n.a(2,{success:o.success,count:e.length,period:"месяц",error:o.error});case 3:return n.p=3,a=n.v,console.error("Ошибка экспорта записей за месяц:",a),n.a(2,{success:!1,error:a.message})}},n,this,[[0,3]])})),function(){return s.apply(this,arguments)})},{key:"exportYearNotes",value:(c=cn(rn().m(function n(){var e,t,r,o,a;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,J.getNotesStats(this.currentYear);case 1:return e=n.v,t="- ".concat(this.currentYear," год"),r=this.formatNotesForExport(e.allNotes,t),n.n=2,this.copyToClipboard(r);case 2:return o=n.v,n.a(2,{success:o.success,count:e.totalNotes,period:"год",error:o.error});case 3:return n.p=3,a=n.v,console.error("Ошибка экспорта записей за год:",a),n.a(2,{success:!1,error:a.message})}},n,this,[[0,3]])})),function(){return c.apply(this,arguments)})},{key:"downloadBlob",value:function(n,e){try{var t=URL.createObjectURL(n),r=document.createElement("a");return r.href=t,r.download=e,r.style.display="none",document.body.appendChild(r),r.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),document.body.removeChild(r),setTimeout(function(){URL.revokeObjectURL(t)},100),{success:!0}}catch(n){return console.error("Ошибка скачивания файла:",n),{success:!1,error:n.message}}}},{key:"generateReportFilename",value:function(n,e){var t=new Date,r=t.toISOString().split("T")[0],o=t.toTimeString().split(" ")[0].replace(/:/g,"-"),a=n.replace(/\s+/g,"_").replace(/[^\w\-_]/g,"");return a&&(a="_".concat(a)),"archive_report".concat(a,"_").concat(r,"_").concat(o,".txt")}},{key:"downloadTodayNotes",value:(i=cn(rn().m(function n(){var e,t,r,o,a,i,c;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,J.getTodayNotes();case 1:return e=n.v,t=(new Date).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"}),r=this.formatNotesForExport(e,"- ".concat(t)),o=new Blob([r],{type:"text/plain;charset=utf-8"}),a=this.generateReportFilename("сегодня",e),i=this.downloadBlob(o,a),n.a(2,{success:i.success,count:e.length,period:"сегодня",filename:a,error:i.error});case 2:return n.p=2,c=n.v,console.error("Ошибка скачивания записей за сегодня:",c),n.a(2,{success:!1,error:c.message})}},n,this,[[0,2]])})),function(){return i.apply(this,arguments)})},{key:"downloadWeekNotes",value:(a=cn(rn().m(function n(){var e,t,r,o,a,i,c,s;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,this.currentWeekStart||(this.currentWeekStart=this.getWeekStart(new Date)),n.n=1,J.getWeekNotes(this.currentWeekStart);case 1:return e=n.v,(t=new Date(this.currentWeekStart)).setDate(t.getDate()+6),r="- Неделя с ".concat(this.currentWeekStart.toLocaleDateString("ru-RU")," по ").concat(t.toLocaleDateString("ru-RU")),o=this.formatNotesForExport(e,r),a=new Blob([o],{type:"text/plain;charset=utf-8"}),i=this.generateReportFilename("неделя",e),c=this.downloadBlob(a,i),n.a(2,{success:c.success,count:e.length,period:"неделю",filename:i,error:c.error});case 2:return n.p=2,s=n.v,console.error("Ошибка скачивания записей за неделю:",s),n.a(2,{success:!1,error:s.message})}},n,this,[[0,2]])})),function(){return a.apply(this,arguments)})},{key:"downloadMonthNotes",value:(o=cn(rn().m(function n(){var e,t,r,o,a,i,c,s;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,J.getMonthNotes(this.currentYear,this.currentMonth);case 1:return e=n.v,r="- ".concat((t=["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"])[this.currentMonth]," ").concat(this.currentYear),o=this.formatNotesForExport(e,r),a=new Blob([o],{type:"text/plain;charset=utf-8"}),i=this.generateReportFilename("".concat(t[this.currentMonth],"_").concat(this.currentYear),e),c=this.downloadBlob(a,i),n.a(2,{success:c.success,count:e.length,period:"месяц",filename:i,error:c.error});case 2:return n.p=2,s=n.v,console.error("Ошибка скачивания записей за месяц:",s),n.a(2,{success:!1,error:s.message})}},n,this,[[0,2]])})),function(){return o.apply(this,arguments)})},{key:"downloadYearNotes",value:(r=cn(rn().m(function n(){var e,t,r,o,a,i,c;return rn().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,J.getNotesStats(this.currentYear);case 1:return e=n.v,t="- ".concat(this.currentYear," год"),r=this.formatNotesForExport(e.allNotes,t),o=new Blob([r],{type:"text/plain;charset=utf-8"}),a=this.generateReportFilename("".concat(this.currentYear,"_год"),e.allNotes),i=this.downloadBlob(o,a),n.a(2,{success:i.success,count:e.totalNotes,period:"год",filename:a,error:i.error});case 2:return n.p=2,c=n.v,console.error("Ошибка скачивания записей за год:",c),n.a(2,{success:!1,error:c.message})}},n,this,[[0,2]])})),function(){return r.apply(this,arguments)})},{key:"showExportNotification",value:function(n){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=n.success,r=n.count,o=n.period,a=n.filename,i=n.error,c=document.createElement("div");c.className="export-notification ".concat(t?"success":"error"),c.innerHTML=t?'\n      <div class="notification-content">\n        <span class="notification-icon">'.concat(e?"📥":"✅",'</span>\n        <div class="notification-text">\n          <strong>').concat(e?"Файл скачан!":"Экспорт завершён!","</strong>\n          <p>").concat(e?"Сохранён файл с ".concat(r," записями за ").concat(o):"Скопировано ".concat(r," записей за ").concat(o," в буфер обмена"),"</p>\n          ").concat(a?'<p class="filename">📄 '.concat(a,"</p>"):"","\n        </div>\n      </div>\n    "):'\n      <div class="notification-content">\n        <span class="notification-icon">❌</span>\n        <div class="notification-text">\n          <strong>'.concat(e?"Ошибка скачивания":"Ошибка экспорта","</strong>\n          <p>").concat(i||"Не удалось выполнить операцию","</p>\n        </div>\n      </div>\n    "),document.body.appendChild(c),setTimeout(function(){return c.classList.add("show")},10),setTimeout(function(){c.classList.remove("show"),setTimeout(function(){c.parentNode&&document.body.removeChild(c)},300)},5e3),c.addEventListener("click",function(){c.classList.remove("show"),setTimeout(function(){c.parentNode&&document.body.removeChild(c)},300)})}},{key:"showDayNotesModal",value:function(n,e,t,r){var o=new Date(n,e,t).toLocaleDateString("ru-RU"),a="Записи за ".concat(o,":\n\n");r.forEach(function(n,e){var t=n.date.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"});a+="".concat(e+1,". [").concat(t,"] ").concat(n.content,"\n"),n.tags.length>0&&(a+="   Теги: ".concat(n.tags.join(" "),"\n")),a+="\n"}),alert(a)}},{key:"groupNotesByDay",value:function(n){var e={};return n.forEach(function(n){var t=n.date.toDateString();e[t]||(e[t]=[]),e[t].push(n)}),e}},{key:"getWeekDaysArray",value:function(n){for(var e=[],t=["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],r=0;r<7;r++){var o=new Date(n);o.setDate(n.getDate()+r),e.push({name:t[r],date:o})}return e}},{key:"createCompactNoteHTML",value:function(n){var e=n.date.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}),t=n.content.length>100?n.content.substring(0,100)+"...":n.content;return'\n      <div class="compact-note" data-note-id="'.concat(n.id,'">\n        <span class="compact-time">').concat(e,'</span>\n        <span class="compact-content">').concat(this.escapeHtml(t),"</span>\n        ").concat(n.tags.length>0?'<span class="compact-tags">'.concat(n.tags.slice(0,2).join(" "),"</span>"):"","\n      </div>\n    ")}},{key:"getMostActiveMonth",value:function(n){var e=0,t=0;return Object.entries(n).forEach(function(n){var r=nn(n,2),o=r[0],a=r[1];a>t&&(t=a,e=parseInt(o))}),["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"][e]}},{key:"getWeekStart",value:function(n){var e=new Date(n),t=e.getDay(),r=e.getDate()-t+(0===t?-6:1),o=new Date(e.setDate(r));return o.setHours(0,0,0,0),o}},{key:"isSameDay",value:function(n,e){return n.getFullYear()===e.getFullYear()&&n.getMonth()===e.getMonth()&&n.getDate()===e.getDate()}},{key:"escapeHtml",value:function(n){var e=document.createElement("div");return e.textContent=n,e.innerHTML}},{key:"showError",value:function(n){console.error("ViewManager Error:",n);var e=document.querySelector("[data-view-content]:not([hidden])");if(e){var t='\n        <div class="error-message">\n          <p>⚠️ '.concat(n,'</p>\n          <button onclick="location.reload()">Перезагрузить</button>\n        </div>\n      ');e.innerHTML=t}}},{key:"updateCurrentView",value:(t=cn(rn().m(function n(){return rn().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,this.loadViewData(this.currentView);case 1:return n.a(2)}},n,this)})),function(){return t.apply(this,arguments)})},{key:"initNavigationArrows",value:function(){var n=this,e=document.querySelectorAll("#week-view .nav-arrow");e.length>=2&&(e[0].addEventListener("click",function(){return n.navigateWeek(-1)}),e[1].addEventListener("click",function(){return n.navigateWeek(1)}));var t=document.querySelectorAll("#month-view .nav-arrow");t.length>=2&&(t[0].addEventListener("click",function(){return n.navigateMonth(-1)}),t[1].addEventListener("click",function(){return n.navigateMonth(1)}))}},{key:"navigateWeek",value:function(n){this.currentWeekStart||(this.currentWeekStart=this.getWeekStart(new Date)),this.currentWeekStart.setDate(this.currentWeekStart.getDate()+7*n),this.loadWeekView()}},{key:"navigateMonth",value:function(n){this.currentMonth+=n,this.currentMonth<0?(this.currentMonth=11,this.currentYear--):this.currentMonth>11&&(this.currentMonth=0,this.currentYear++),this.loadMonthView()}},{key:"setupEventListeners",value:function(){var n=this;document.addEventListener("keydown",function(e){if(e.ctrlKey||e.metaKey)switch(e.key){case"1":e.preventDefault(),n.switchView("today");break;case"2":e.preventDefault(),n.switchView("week");break;case"3":e.preventDefault(),n.switchView("month");break;case"4":e.preventDefault(),n.switchView("year");break;case"f":e.preventDefault(),n.switchView("search")}}),console.log("Настроены клавиатурные сокращения: Ctrl+1-4 для переключения видов, Ctrl+F для поиска")}}],e&&sn(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,e,t,r,o,a,i,c,s,u,l,d,f,h,p,m,v,y,g,b}();function hn(){var n,e,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function a(t,r,o,a){var s=r&&r.prototype instanceof c?r:c,u=Object.create(s.prototype);return pn(u,"_invoke",function(t,r,o){var a,c,s,u=0,l=o||[],d=!1,f={p:0,n:0,v:n,a:h,f:h.bind(n,4),d:function(e,t){return a=e,c=0,s=n,f.n=t,i}};function h(t,r){for(c=t,s=r,e=0;!d&&u&&!o&&e<l.length;e++){var o,a=l[e],h=f.p,p=a[2];t>3?(o=p===r)&&(s=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=n):a[0]<=h&&((o=t<2&&h<a[1])?(c=0,f.v=r,f.n=a[1]):h<p&&(o=t<3||a[0]>r||r>p)&&(a[4]=t,a[5]=r,f.n=p,c=0))}if(o||t>1)return i;throw d=!0,r}return function(o,l,p){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&h(l,p),c=l,s=p;(e=c<2?n:s)||!d;){a||(c?c<3?(c>1&&(f.n=-1),h(c,s)):f.n=s:f.v=s);try{if(u=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=n}else if((e=(d=f.n<0)?s:t.call(r,f))!==i)break}catch(e){a=n,c=1,s=e}finally{u=1}}return{value:e,done:d}}}(t,o,a),!0),u}var i={};function c(){}function s(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(pn(e={},r,function(){return this}),e),d=u.prototype=c.prototype=Object.create(l);function f(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,u):(n.__proto__=u,pn(n,o,"GeneratorFunction")),n.prototype=Object.create(d),n}return s.prototype=u,pn(d,"constructor",u),pn(u,"constructor",s),s.displayName="GeneratorFunction",pn(u,o,"GeneratorFunction"),pn(d),pn(d,o,"Generator"),pn(d,r,function(){return this}),pn(d,"toString",function(){return"[object Generator]"}),(hn=function(){return{w:a,m:f}})()}function pn(n,e,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}pn=function(n,e,t,r){function a(e,t){pn(n,e,function(n){return this._invoke(e,t,n)})}e?o?o(n,e,{value:t,enumerable:!r,configurable:!r,writable:!r}):n[e]=t:(a("next",0),a("throw",1),a("return",2))},pn(n,e,t,r)}function mn(n,e,t,r,o,a,i){try{var c=n[a](i),s=c.value}catch(n){return void t(n)}c.done?e(s):Promise.resolve(s).then(r,o)}function vn(n){return function(){var e=this,t=arguments;return new Promise(function(r,o){var a=n.apply(e,t);function i(n){mn(a,r,o,i,c,"next",n)}function c(n){mn(a,r,o,i,c,"throw",n)}i(void 0)})}}function yn(){var n=document.getElementById("install-pwa-btn");n&&(n.style.display="none")}"serviceWorker"in navigator&&(window.addEventListener("load",vn(hn().m(function n(){var e,t;return hn().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,navigator.serviceWorker.register("/sw.js",{scope:"/",updateViaCache:"none"});case 1:e=n.v,console.log("✅ Workbox Service Worker зарегистрирован:",e.scope),setInterval(function(){e.update()},6e4),e.addEventListener("updatefound",function(){var n=e.installing;n&&n.addEventListener("statechange",function(){var e;"installed"===n.state&&navigator.serviceWorker.controller&&((e=document.createElement("div")).className="export-notification update-notification",e.innerHTML='\n    <div class="notification-content">\n      <span class="notification-icon">🔄</span>\n      <div class="notification-text">\n        <strong>Обновление доступно!</strong>\n        <p>Новая версия приложения готова к установке</p>\n        <button id="update-sw-btn" class="update-button">Обновить сейчас</button>\n      </div>\n    </div>\n  ',document.body.appendChild(e),setTimeout(function(){return e.classList.add("show")},10),e.querySelector("#update-sw-btn").addEventListener("click",function(){navigator.serviceWorker.ready.then(function(n){n.waiting&&n.waiting.postMessage({type:"SKIP_WAITING"})})}),setTimeout(function(){e.classList.remove("show"),setTimeout(function(){return e.remove()},300)},1e4))})}),n.n=3;break;case 2:n.p=2,t=n.v,console.error("❌ Ошибка регистрации Workbox Service Worker:",t);case 3:return n.a(2)}},n,null,[[0,2]])}))),navigator.serviceWorker.addEventListener("message",function(n){n.data&&"CACHE_UPDATED"===n.data.type&&console.log("📦 Кэш обновлён:",n.data.payload)}),navigator.serviceWorker.addEventListener("controllerchange",function(){ln||(window.location.reload(),ln=!0)})),window.addEventListener("beforeinstallprompt",function(n){console.log("PWA готово к установке"),n.preventDefault(),dn=n,function(){var n=document.getElementById("install-pwa-btn");if(!n){(n=document.createElement("button")).id="install-pwa-btn",n.className="install-pwa-button",n.innerHTML="📱 Установить приложение",n.title="Установить Архив Потраченного Времени как приложение";var e=document.getElementById("main-nav");e&&e.appendChild(n)}n.style.display="inline-flex",n.addEventListener("click",vn(hn().m(function n(){var e,t,r;return hn().w(function(n){for(;;)switch(n.p=n.n){case 0:if(dn){n.n=1;break}return n.a(2);case 1:return n.p=1,dn.prompt(),n.n=2,dn.userChoice;case 2:e=n.v,t=e.outcome,console.log("Пользователь ".concat("accepted"===t?"согласился":"отказался"," установить PWA")),dn=null,yn(),n.n=4;break;case 3:n.p=3,r=n.v,console.error("Ошибка установки PWA:",r);case 4:return n.a(2)}},n,null,[[1,3]])})))}()}),window.addEventListener("appinstalled",function(){var n;console.log("PWA успешно установлено"),dn=null,yn(),(n=document.createElement("div")).className="export-notification success",n.innerHTML='\n    <div class="notification-content">\n      <span class="notification-icon">✅</span>\n      <div class="notification-text">\n        <strong>Приложение установлено!</strong>\n        <p>Архив Потраченного Времени теперь доступен с главного экрана.</p>\n      </div>\n    </div>\n  ',document.body.appendChild(n),setTimeout(function(){return n.classList.add("show")},10),setTimeout(function(){n.classList.remove("show"),setTimeout(function(){return n.remove()},300)},5e3)}),document.addEventListener("DOMContentLoaded",function(){console.log("Архив Потраченного Времени запускается...");var n=new fn;!function(n){var e=document.getElementById("new-note-form"),t=document.getElementById("note-content"),r=document.getElementById("note-tags"),o=document.getElementById("save-note-btn");function a(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Сохранить и страдать дальше";o.disabled=!n,o.textContent=e,t.disabled=!n,r.disabled=!n}e?(e.addEventListener("submit",function(){var e=vn(hn().m(function e(o){var i,c,s,u,l;return hn().w(function(e){for(;;)switch(e.p=e.n){case 0:if(o.preventDefault(),i=t.value.trim(),c=r.value.trim(),i){e.n=1;break}return alert("Эй, мудила! Пустые записи никому не нужны. Напиши хоть что-нибудь осмысленное."),t.focus(),e.a(2);case 1:return s=[],c&&(s=c.split(",").map(function(n){return n.trim()}).filter(function(n){return n.length>0}).map(function(n){return n.startsWith("#")?n:"#".concat(n)})),e.p=2,a(!1,"Сохраняю твои страдания..."),e.n=3,J.addNote(i,s);case 3:return u=e.v,console.log("Запись сохранена с ID: ".concat(u)),t.value="",r.value="",a(!0,"Сохранено!"),setTimeout(function(){a(!0,"Сохранить и страдать дальше")},2e3),t.focus(),e.n=4,n.updateCurrentView();case 4:e.n=6;break;case 5:e.p=5,l=e.v,console.error("Ошибка при сохранении записи:",l),alert("Что-то пошло не так. Твои страдания не сохранились. Проверь консоль."),a(!0);case 6:return e.a(2)}},e,null,[[2,5]])}));return function(n){return e.apply(this,arguments)}}()),t.focus()):console.error("Форма добавления записей не найдена!")}(n),n.switchView("today"),console.log("Приложение готово к использованию")})})()})();